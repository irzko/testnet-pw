LavaPack.loadBundle([[39,{"../../../shared/constants/network":4674,"../constants/contracts":5,"./util":90,"@ethersproject/contracts":452,"@ethersproject/providers":491,"@metamask/obs-store":1632,"eth-query":3128,loglevel:3987,pify:4115,"single-call-balance-checker-abi":4494},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=p(e("eth-query")),s=e("@metamask/obs-store"),o=p(e("loglevel")),i=p(e("pify")),a=e("@ethersproject/providers"),c=e("@ethersproject/contracts"),l=p(e("single-call-balance-checker-abi")),u=e("../../../shared/constants/network"),d=e("../constants/contracts"),h=e("./util");function p(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e={}){const t={accounts:{},currentBlockGasLimit:""};this.store=new s.ObservableStore({...t,...e.initState}),this.resetState=()=>{this.store.updateState(t)},this._provider=e.provider,this._query=(0,i.default)(new n.default(this._provider)),this._blockTracker=e.blockTracker,this._currentBlockNumber=this._blockTracker.getCurrentBlock(),this._blockTracker.once("latest",(e=>{this._currentBlockNumber=e})),this._updateForBlock=this._updateForBlock.bind(this),this.getCurrentChainId=e.getCurrentChainId,this.getNetworkIdentifier=e.getNetworkIdentifier,this.preferencesController=e.preferencesController,this.onboardingController=e.onboardingController,e.onAccountRemoved((e=>this.removeAccount([e]))),this.onboardingController.store.subscribe((0,h.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;!r&&n&&this._updateAccounts()}),this.onboardingController.store.getState())),this.preferencesController.store.subscribe((0,h.previousValueComparator)((async(e,t)=>{const{selectedAddress:r}=e,{selectedAddress:n,useMultiAccountBalanceChecker:s}=t;r===n||s||this._updateAccounts()}),this.onboardingController.store.getState())),this.ethersProvider=new a.Web3Provider(this._provider)}start(){this._blockTracker.removeListener("latest",this._updateForBlock),this._blockTracker.addListener("latest",this._updateForBlock),this._updateAccounts()}stop(){this._blockTracker.removeListener("latest",this._updateForBlock)}syncWithAddresses(e){const{accounts:t}=this.store.getState(),r=Object.keys(t),n=[];e.forEach((e=>{r.includes(e)||n.push(e)}));const s=[];r.forEach((t=>{e.includes(t)||s.push(t)})),this.addAccounts(n),this.removeAccount(s)}addAccounts(e){const{accounts:t}=this.store.getState();e.forEach((e=>{t[e]={}})),this.store.updateState({accounts:t}),this._currentBlockNumber&&this._updateAccounts()}removeAccount(e){const{accounts:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({accounts:t})}clearAccounts(){this.store.updateState({accounts:{}})}async _updateForBlock(e){this._currentBlockNumber=e;const t=await this._query.getBlockByNumber(e,!1);if(!t)return;const r=t.gasLimit;this.store.updateState({currentBlockGasLimit:r});try{await this._updateAccounts()}catch(e){o.default.error(e)}}async _updateAccounts(){const{completedOnboarding:e}=this.onboardingController.store.getState();if(!e)return;const{useMultiAccountBalanceChecker:t}=this.preferencesController.store.getState();let r=[];if(t){const{accounts:e}=this.store.getState();r=Object.keys(e)}else{r=[this.preferencesController.getSelectedAddress()]}const n=this.getCurrentChainId(),s=this.getNetworkIdentifier();if(s===u.LOCALHOST_RPC_URL||"http://127.0.0.1:8545"===s)await Promise.all(r.map(this._updateAccount.bind(this)));else switch(n){case u.CHAIN_IDS.MAINNET:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS);break;case u.CHAIN_IDS.GOERLI:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_GOERLI);break;case u.CHAIN_IDS.SEPOLIA:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA);break;case u.CHAIN_IDS.BSC:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_BSC);break;case u.CHAIN_IDS.OPTIMISM:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM);break;case u.CHAIN_IDS.POLYGON:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_POLYGON);break;case u.CHAIN_IDS.AVALANCHE:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE);break;case u.CHAIN_IDS.FANTOM:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_FANTOM);break;case u.CHAIN_IDS.ARBITRUM:await this._updateAccountsViaBalanceChecker(r,d.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM);break;default:await Promise.all(r.map(this._updateAccount.bind(this)))}}async _updateAccount(e){const{useMultiAccountBalanceChecker:t}=this.preferencesController.store.getState();let r="0x0";try{r=await this._query.getBalance(e)}catch(e){var n;if("eth_getBalance"!==(null===(n=e.data)||void 0===n||null===(n=n.request)||void 0===n?void 0:n.method))throw e}const s={address:e,balance:r},{accounts:o}=this.store.getState();if(!o[e])return;let i=o;t||(i={},Object.keys(o).forEach((t=>{e!==t&&(i[t]={address:t,balance:null})}))),i[e]=s,this.store.updateState({accounts:i})}async _updateAccountsViaBalanceChecker(e,t){const{accounts:r}=this.store.getState(),n={};Object.keys(r).forEach((t=>{e.includes(t)||(n[t]={address:t,balance:null})})),this.ethersProvider=new a.Web3Provider(this._provider);const s=await new c.Contract(t,l.default,this.ethersProvider),i=["0x0000000000000000000000000000000000000000"];try{const t=await s.balances(e,i);e.forEach(((e,r)=>{const s=t[r]?t[r].toHexString():"0x0";n[e]={address:e,balance:s}})),this.store.updateState({accounts:n})}catch(t){o.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.all(e.map(this._updateAccount.bind(this)))}}}}}},{package:"$root$",file:"app/scripts/lib/account-tracker.js"}],[3947,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=/\s/;t.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}}}},{package:"lodash",file:"node_modules/lodash/_trimmedEndIndex.js"}],[3954,{"./_baseInRange":3848,"./toFinite":3983,"./toNumber":3985},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseInRange"),s=e("./toFinite"),o=e("./toNumber");t.exports=function(e,t,r){return t=s(t),r===undefined?(r=t,t=0):r=s(r),e=o(e),n(e,t,r)}}}},{package:"lodash",file:"node_modules/lodash/inRange.js"}],[3960,{"./_baseKeys":3858,"./_getTag":3899,"./_isPrototype":3914,"./isArguments":3955,"./isArray":3956,"./isArrayLike":3957,"./isBuffer":3959,"./isTypedArray":3972},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseKeys"),s=e("./_getTag"),o=e("./isArguments"),i=e("./isArray"),a=e("./isArrayLike"),c=e("./isBuffer"),l=e("./_isPrototype"),u=e("./isTypedArray"),d=Object.prototype.hasOwnProperty;t.exports=function(e){if(null==e)return!0;if(a(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||u(e)||o(e)))return!e.length;var t=s(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!n(e).length;for(var r in e)if(d.call(e,r))return!1;return!0}}}},{package:"lodash",file:"node_modules/lodash/isEmpty.js"}],[3963,{"./toInteger":3984},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toInteger");t.exports=function(e){return"number"==typeof e&&e==n(e)}}}},{package:"lodash",file:"node_modules/lodash/isInteger.js"}],[3976,{"./_baseAssignValue":3838,"./_baseForOwn":3843,"./_baseIteratee":3857},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseAssignValue"),s=e("./_baseForOwn"),o=e("./_baseIteratee");t.exports=function(e,t){var r={};return t=o(t,3),s(e,(function(e,s,o){n(r,s,t(e,s,o))})),r}}}},{package:"lodash",file:"node_modules/lodash/mapValues.js"}],[3983,{"./toNumber":3985},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toNumber"),s=1/0;t.exports=function(e){return e?(e=n(e))===s||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}}}},{package:"lodash",file:"node_modules/lodash/toFinite.js"}],[3984,{"./toFinite":3983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./toFinite");t.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}}}},{package:"lodash",file:"node_modules/lodash/toInteger.js"}],[3985,{"./_baseTrim":3867,"./isObject":3967,"./isSymbol":3971},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./_baseTrim"),s=e("./isObject"),o=e("./isSymbol"),i=0/0,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;t.exports=function(e){if("number"==typeof e)return e;if(o(e))return i;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=c.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):a.test(e)?i:+e}}}},{package:"lodash",file:"node_modules/lodash/toNumber.js"}],[3988,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=s;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function s(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function o(e){return!0===(e&&e.__isLong__)}s.prototype.__isLong__,Object.defineProperty(s.prototype,"__isLong__",{value:!0}),s.isLong=o;var i={},a={};function c(e,t){var r,n,s;return t?(s=0<=(e>>>=0)&&e<256)&&(n=a[e])?n:(r=u(e,(0|e)<0?-1:0,!0),s&&(a[e]=r),r):(s=-128<=(e|=0)&&e<128)&&(n=i[e])?n:(r=u(e,e<0?-1:0,!1),s&&(i[e]=r),r)}function l(e,t){if(isNaN(e))return t?w:b;if(t){if(e<0)return w;if(e>=g)return S}else{if(e<=-m)return A;if(e+1>=m)return _}return e<0?l(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,r){return new s(e,t,r)}s.fromInt=c,s.fromNumber=l,s.fromBits=u;var d=Math.pow;function h(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return b;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return h(e.substring(1),t,r).neg();for(var s=l(d(r,8)),o=b,i=0;i<e.length;i+=8){var a=Math.min(8,e.length-i),c=parseInt(e.substring(i,i+a),r);if(a<8){var u=l(d(r,a));o=o.mul(u).add(l(c))}else o=(o=o.mul(s)).add(l(c))}return o.unsigned=t,o}function p(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?h(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}s.fromString=h,s.fromValue=p;var f=4294967296,g=f*f,m=g/2,y=c(1<<24),b=c(0);s.ZERO=b;var w=c(0,!0);s.UZERO=w;var v=c(1);s.ONE=v;var k=c(1,!0);s.UONE=k;var C=c(-1);s.NEG_ONE=C;var _=u(-1,2147483647,!1);s.MAX_VALUE=_;var S=u(-1,-1,!0);s.MAX_UNSIGNED_VALUE=S;var A=u(0,-2147483648,!1);s.MIN_VALUE=A;var T=s.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},T.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(A)){var t=l(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=l(d(e,6),this.unsigned),o=this,i="";;){var a=o.div(s),c=(o.sub(a.mul(s)).toInt()>>>0).toString(e);if((o=a).isZero())return c+i;for(;c.length<6;)c="0"+c;i=""+c+i}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1==(1&this.low)},T.isEven=function(){return 0==(1&this.low)},T.equals=function(e){return o(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(o(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(v)},T.neg=T.negate,T.add=function(e){o(e)||(e=p(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,s=65535&this.low,i=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=0,d=0,h=0,f=0;return h+=(f+=s+(65535&e.low))>>>16,d+=(h+=n+c)>>>16,l+=(d+=r+a)>>>16,l+=t+i,u((h&=65535)<<16|(f&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},T.subtract=function(e){return o(e)||(e=p(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return b;if(o(e)||(e=p(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return b;if(this.eq(A))return e.isOdd()?A:b;if(e.eq(A))return this.isOdd()?A:b;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return l(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,s=this.low>>>16,i=65535&this.low,a=e.high>>>16,c=65535&e.high,d=e.low>>>16,h=65535&e.low,f=0,g=0,m=0,w=0;return m+=(w+=i*h)>>>16,g+=(m+=s*h)>>>16,m&=65535,g+=(m+=i*d)>>>16,f+=(g+=r*h)>>>16,g&=65535,f+=(g+=s*d)>>>16,g&=65535,f+=(g+=i*c)>>>16,f+=t*h+r*d+s*c+i*a,u((m&=65535)<<16|(w&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(o(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,r,s;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?w:b;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return w;if(e.gt(this.shru(1)))return k;s=w}else{if(this.eq(A))return e.eq(v)||e.eq(C)?A:e.eq(A)?v:(t=this.shr(1).div(e).shl(1)).eq(b)?e.isNegative()?v:C:(r=this.sub(e.mul(t)),s=t.add(r.div(e)));if(e.eq(A))return this.unsigned?w:b;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=b}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),a=i<=48?1:d(2,i-48),c=l(t),h=c.mul(e);h.isNegative()||h.gt(r);)h=(c=l(t-=a,this.unsigned)).mul(e);c.isZero()&&(c=v),s=s.add(c),r=r.sub(h)}return s},T.div=T.divide,T.modulo=function(e){return o(e)||(e=p(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return u(~this.low,~this.high,this.unsigned)},T.and=function(e){return o(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return o(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return o(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(o(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},s.fromBytes=function(e,t,r){return r?s.fromBytesLE(e,t):s.fromBytesBE(e,t)},s.fromBytesLE=function(e,t){return new s(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},s.fromBytesBE=function(e,t){return new s(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>long",file:"node_modules/long/src/long.js"}],[40,{"../../../shared/modules/string-utils":4713},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("../../../shared/modules/string-utils");r.default=class{constructor(e={}){const{preferencesController:t,addressBookController:r,networkController:n,trackMetaMetricsEvent:s}=e;this.preferencesController=t,this.addressBookController=r,this.networkController=n,this._trackMetaMetricsEvent=s}async restoreUserData(e){const t=this.preferencesController.store.getState(),{preferences:r,addressBook:n,network:s}=JSON.parse(e);r&&(r.identities=t.identities,r.lostIdentities=t.lostIdentities,r.selectedAddress=t.selectedAddress,this.preferencesController.store.updateState(r)),n&&this.addressBookController.update(n,!0),s&&this.networkController.loadBackup(s),(r||n||s)&&this._trackMetaMetricsEvent({event:"User Data Imported",category:"Backup"})}async backupUserData(){const e={preferences:{...this.preferencesController.store.getState()},addressBook:{...this.addressBookController.state},network:{networkConfigurations:this.networkController.state.networkConfigurations}};delete e.preferences.identities,delete e.preferences.lostIdentities,delete e.preferences.selectedAddress;const t=JSON.stringify(e),r=new Date,s=e=>(0,n.prependZero)(e,2);return{fileName:`MetaMaskUserData.${r.getFullYear()}_${s(r.getMonth()+1)}_${s(r.getDay())}_${s(r.getHours())}_${s(r.getMinutes())}_${s(r.getDay())}.json`,data:t}}}}}},{package:"$root$",file:"app/scripts/lib/backup.js"}],[4031,{"./util":4035},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encodeText:n}=e("./util");t.exports=class{constructor(e,t,r,s){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=s,this.codec=r(s)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/base.js"}],[4032,{"./base.js":4031,"./rfc4648":4034,"./util":4035,"@multiformats/base-x":1984},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@multiformats/base-x"),s=e("./base.js"),{rfc4648:o}=e("./rfc4648"),{decodeText:i,encodeText:a}=e("./util"),c=[["identity","\0",()=>({encode:i,decode:a}),""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],l=c.reduce(((e,t)=>(e[t[0]]=new s(t[0],t[1],t[2],t[3]),e)),{}),u=c.reduce(((e,t)=>(e[t[1]]=l[t[0]],e)),{});t.exports={names:l,codes:u}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/constants.js"}],[4033,{"./constants":4032,"./util":4035},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./constants"),{encodeText:s,decodeText:o,concat:i}=e("./util");function a(e){if(Object.prototype.hasOwnProperty.call(n.names,e))return n.names[e];if(Object.prototype.hasOwnProperty.call(n.codes,e))return n.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:r,codeBuf:n}=a(e);return function(e,t){const r=a(e);r.decode(o(t))}(r,t),i([n,t],n.length+t.length)}).encode=function(e,t){const r=a(e),n=s(r.encode(t));return i([r.codeBuf,n],r.codeBuf.length+n.length)},r.decode=function(e){e instanceof Uint8Array&&(e=o(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=o(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},r.encoding=a,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=o(e)),a(e[0])};const c=Object.freeze(n.names),l=Object.freeze(n.codes);r.names=c,r.codes=l}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/index.js"}],[4034,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let o="",i=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],i+=8;i>r;)i-=r,o+=t[s&a>>i];if(i&&(o+=t[s&a<<r-i]),n)for(;o.length*r&7;)o+="=";return o})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let i=0,a=0,c=0;for(let t=0;t<s;++t){const s=n[e[t]];if(s===undefined)throw new SyntaxError("Invalid character "+e[t]);a=a<<r|s,i+=r,i>=8&&(i-=8,o[c++]=255&a>>i)}if(i>=r||255&a<<8-i)throw new SyntaxError("Unexpected end of data");return o})(r,t,e)})}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/rfc4648.js"}],[4035,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=new TextDecoder,s=new TextEncoder;t.exports={decodeText:e=>n.decode(e),encodeText:e=>s.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}}},{package:"@ensdomains/content-hash>cids>multibase",file:"node_modules/multibase/src/util.js"}],[4036,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var o,i=0,a=0,c=r=r||0,l=t.length;do{if(c>=l||a>49)throw e.bytes=0,new RangeError("Could not decode varint");o=t[c++],i+=a<28?(o&s)<<a:(o&s)*Math.pow(2,a),a+=7}while(o>=n);return e.bytes=c-r,i};var n=128,s=127}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/decode.js"}],[4037,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,i){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");r=r||[];var a=i=i||0;for(;t>=o;)r[i++]=255&t|n,t/=128;for(;t&s;)r[i++]=255&t|n,t>>>=7;return r[i]=0|t,e.bytes=i-a+1,r};var n=128,s=-128,o=Math.pow(2,31)}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/encode.js"}],[4038,{"./decode.js":4036,"./encode.js":4037,"./length.js":4039},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/index.js"}],[4039,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),s=Math.pow(2,14),o=Math.pow(2,21),i=Math.pow(2,28),a=Math.pow(2,35),c=Math.pow(2,42),l=Math.pow(2,49),u=Math.pow(2,56),d=Math.pow(2,63);t.exports=function(e){return e<n?1:e<s?2:e<o?3:e<i?4:e<a?5:e<c?6:e<l?7:e<u?8:e<d?9:10}}}},{package:"@ensdomains/content-hash>cids>multicodec>varint",file:"node_modules/multicodec/node_modules/varint/length.js"}],[4040,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});t.exports={baseTable:n}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/generated-table.js"}],[4041,{"./maps":4042,"./util":4043,"uint8arrays/concat":4569,varint:4038},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("varint"),s=e("uint8arrays/concat"),o=e("./util"),{nameToVarint:i,constantToCode:a,nameToCode:c,codeToName:l}=e("./maps");function u(e){const t=n.decode(e),r=l[t];if(r===undefined)throw new Error(`Code "${t}" not found`);return r}function d(e){return l[e]}function h(e){const t=c[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function p(e){return n.decode(e)}function f(e){const t=i[e];if(t===undefined)throw new Error(`Codec "${e}" not found`);return t}function g(e){return o.varintEncode(e)}t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=o.varintUint8ArrayEncode(e);else{if(!i[e])throw new Error("multicodec not recognized");r=i[e]}return s([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getNameFromData:u,getNameFromCode:d,getCodeFromName:h,getCodeFromData:p,getVarintFromName:f,getVarintFromCode:g,getCodec:function(e){return u(e)},getName:function(e){return d(e)},getNumber:function(e){return h(e)},getCode:function(e){return p(e)},getCodeVarint:function(e){return f(e)},getVarint:function(e){return Array.from(g(e))},...a,nameToVarint:i,nameToCode:c,codeToName:l}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/index.js"}],[4042,{"./generated-table":4040,"./util":4043},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./generated-table"),s=e("./util").varintEncode,o={},i={},a={};for(const e in n){const t=e,r=n[t];o[t]=s(r);i[t.toUpperCase().replace(/-/g,"_")]=r,a[r]||(a[r]=t)}Object.freeze(o),Object.freeze(i),Object.freeze(a);const c=Object.freeze(n);t.exports={nameToVarint:o,constantToCode:i,nameToCode:c,codeToName:a}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/maps.js"}],[4043,{"uint8arrays/from-string":4571,"uint8arrays/to-string":4572,varint:4038},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("varint"),s=e("uint8arrays/to-string"),o=e("uint8arrays/from-string");function i(e){return parseInt(s(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return o(t,"base16")},uint8ArrayToNumber:i,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(i(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"@ensdomains/content-hash>cids>multicodec",file:"node_modules/multicodec/src/util.js"}],[4061,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){for(var n=self.crypto||self.msCrypto,s="-_",o=36;o--;)s+=o.toString(36);for(o=36;o---10;)s+=o.toString(36).toUpperCase();t.exports=function(e){var t="",r=n.getRandomValues(new Uint8Array(e||21));for(o=e||21;o--;)t+=s[63&r[o]];return t}}}},{package:"nanoid",file:"node_modules/nanoid/index.browser.js"}],[4066,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();t.exports=r=n.fetch,n.fetch&&(r.default=n.fetch.bind(n)),r.Headers=n.Headers,r.Request=n.Request,r.Response=n.Response}}},{package:"node-fetch",file:"node_modules/node-fetch/browser.js"}],[4069,{assert:2812,"await-semaphore":2679,"ethjs-query":3227},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("ethjs-query"),s=e("assert"),o=e("await-semaphore").Mutex;t.exports=class{constructor({provider:e,blockTracker:t,getPendingTransactions:r,getConfirmedTransactions:s}){this.provider=e,this.blockTracker=t,this.ethQuery=new n(e),this.getPendingTransactions=r,this.getConfirmedTransactions=s,this.lockMap={}}async getGlobalLock(){const e=this._lookupMutex("global");return{releaseLock:await e.acquire()}}async getNonceLock(e){await this._globalMutexFree();const t=await this._takeMutex(e);try{const r={},n=await this._getNetworkNextNonce(e),o=this._getHighestLocallyConfirmed(e),i=n.nonce,a=Math.max(i,o),c=this.getPendingTransactions(e),l=this._getHighestContinuousFrom(c,a)||0;r.params={highestLocallyConfirmed:o,highestSuggested:a,nextNetworkNonce:i},r.local=l,r.network=n;const u=Math.max(n.nonce,l.nonce);return s(Number.isInteger(u),`nonce-tracker - nextNonce is not an integer - got: (${typeof u}) "${u}"`),{nextNonce:u,nonceDetails:r,releaseLock:t}}catch(e){throw t(),e}}async _globalMutexFree(){const e=this._lookupMutex("global");(await e.acquire())()}async _takeMutex(e){const t=this._lookupMutex(e);return await t.acquire()}_lookupMutex(e){let t=this.lockMap[e];return t||(t=new o,this.lockMap[e]=t),t}async _getNetworkNextNonce(e){const t=await this.blockTracker.getLatestBlock(),r=(await this.ethQuery.getTransactionCount(e,t)).toNumber();s(Number.isInteger(r),`nonce-tracker - baseCount is not an integer - got: (${typeof r}) "${r}"`);return{name:"network",nonce:r,details:{blockNumber:t,baseCount:r}}}_getHighestLocallyConfirmed(e){const t=this.getConfirmedTransactions(e),r=this._getHighestNonce(t);return Number.isInteger(r)?r+1:0}_getHighestNonce(e){const t=e.map((e=>{const t=e.txParams.nonce;return s(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));return Math.max.apply(null,t)}_getHighestContinuousFrom(e,t){const r=e.map((e=>{const t=e.txParams.nonce;return s(typeof t,"string","nonces should be hex strings"),parseInt(t,16)}));let n=t;for(;r.includes(n);)n++;return{name:"local",nonce:n,details:{startPoint:t,highest:n}}}}}}},{package:"nonce-tracker",file:"node_modules/nonce-tracker/index.js"}],[41,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let r=e.message;r=r===undefined?"":String(r),""===t?e.stack=e.message:""===r?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"$root$",file:"app/scripts/lib/cleanErrorStack.js"}],[4145,{"./src/index-light":4151},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./src/index-light")}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/light.js"}],[4146,{"./enum":4149,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=r,s=e("./enum"),o=e("./util");function i(e,t,r,n){if(t.resolvedType)if(t.resolvedType instanceof s){e("switch(d%s){",n);for(var o=t.resolvedType.values,i=Object.keys(o),a=0;a<i.length;++a)t.repeated&&o[i[a]]===t.typeDefault&&e("default:"),e("case%j:",i[a])("case %i:",o[i[a]])("m%s=%j",n,o[i[a]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function a(e,t,r,n){if(t.resolvedType)t.resolvedType instanceof s?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",n,r,n,n):e("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,o?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}n.fromObject=function(e){var t=e.fieldsArray,r=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var a=t[n].resolve(),c=o.safeProp(a.name);a.map?(r("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),i(r,a,n,c+"[ks[i]]")("}")("}")):a.repeated?(r("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),i(r,a,n,c+"[i]")("}")("}")):(a.resolvedType instanceof s||r("if(d%s!=null){",c),i(r,a,n,c),a.resolvedType instanceof s||r("}"))}return r("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var r=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],i=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?n:t[l].map?i:c).push(t[l]);if(n.length){for(r("if(o.arrays||o.defaults){"),l=0;l<n.length;++l)r("d%s=[]",o.safeProp(n[l].name));r("}")}if(i.length){for(r("if(o.objects||o.defaults){"),l=0;l<i.length;++l)r("d%s={}",o.safeProp(i[l].name));r("}")}if(c.length){for(r("if(o.defaults){"),l=0;l<c.length;++l){var u=c[l],d=o.safeProp(u.name);if(u.resolvedType instanceof s)r("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var h="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else r("d%s=%j",d,u.typeDefault)}r("}")}var p=!1;for(l=0;l<t.length;++l){u=t[l];var f=e._fieldsArray.indexOf(u);d=o.safeProp(u.name);u.map?(p||(p=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),a(r,u,f,d+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),a(r,u,f,d+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),a(r,u,f,d),u.partOf&&r("if(o.oneofs)")("d%s=%j",o.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/converter.js"}],[4147,{"./enum":4149,"./types":4167,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break");t("switch(t>>>3){");for(var r=0;r<e.fieldsArray.length;++r){var a=e._fieldsArray[r].resolve(),c=a.resolvedType instanceof n?"int32":a.type,l="m"+o.safeProp(a.name);t("case %i:",a.id),a.map?(t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos"),s.defaults[a.keyType]!==undefined?t("k=%j",s.defaults[a.keyType]):t("k=null"),s.defaults[c]!==undefined?t("value=%j",s.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:"),s.basic[c]===undefined?t("value=types[%i].decode(r,r.uint32())",r):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),s.long[a.keyType]!==undefined?t('%s[typeof k==="object"?util.longToHash(k):k]=value',l):t("%s[k]=value",l)):a.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),s.packed[c]!==undefined&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),s.basic[c]===undefined?t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,r):t("%s.push(r.%s())",l,c)):s.basic[c]===undefined?t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,r):t("%s=r.%s()",l,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var u=e._fieldsArray[r];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",i(u))}return t("return m")};var n=e("./enum"),s=e("./types"),o=e("./util");function i(e){return"missing required '"+e.name+"'"}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/decoder.js"}],[4148,{"./enum":4149,"./types":4167,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){for(var t,r=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<a.length;++c){var l=a[c].resolve(),u=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof n?"int32":l.type,h=s.basic[d];t="m"+o.safeProp(l.name),l.map?(r("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|s.mapKey[l.keyType],l.keyType),h===undefined?r("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):r(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),r("}")("}")):l.repeated?(r("if(%s!=null&&%s.length){",t,t),l.packed&&s.packed[d]!==undefined?r("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(r("for(var i=0;i<%s.length;++i)",t),h===undefined?i(r,l,u,t+"[i]"):r("w.uint32(%i).%s(%s[i])",(l.id<<3|h)>>>0,d,t)),r("}")):(l.optional&&r("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),h===undefined?i(r,l,u,t):r("w.uint32(%i).%s(%s)",(l.id<<3|h)>>>0,d,t))}return r("return w")};var n=e("./enum"),s=e("./types"),o=e("./util");function i(e,t,r,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(t.id<<3|2)>>>0)}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/encoder.js"}],[4149,{"./namespace":4156,"./object":4157,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./object");((i.prototype=Object.create(n.prototype)).constructor=i).className="Enum";var s=e("./namespace"),o=e("./util");function i(e,t,r,s,o){if(n.call(this,e,r),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=s,this.comments=o||{},this.reserved=undefined,t)for(var i=Object.keys(t),a=0;a<i.length;++a)"number"==typeof t[i[a]]&&(this.valuesById[this.values[i[a]]=t[i[a]]]=i[a])}i.fromJSON=function(e,t){var r=new i(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r},i.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",t?this.comment:undefined,"comments",t?this.comments:undefined])},i.prototype.add=function(e,t,r){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=r||null,this},i.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},i.prototype.isReservedId=function(e){return s.isReservedId(this.reserved,e)},i.prototype.isReservedName=function(e){return s.isReservedName(this.reserved,e)}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/enum.js"}],[4150,{"./enum":4149,"./object":4157,"./types":4167,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=l;var n=e("./object");((l.prototype=Object.create(n.prototype)).constructor=l).className="Field";var s,o=e("./enum"),i=e("./types"),a=e("./util"),c=/^required|optional|repeated$/;function l(e,t,r,s,o,l,u){if(a.isObject(s)?(u=o,l=s,s=o=undefined):a.isObject(o)&&(u=l,l=o,o=undefined),n.call(this,e,l),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(r))throw TypeError("type must be a string");if(s!==undefined&&!c.test(s=s.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(o!==undefined&&!a.isString(o))throw TypeError("extend must be a string");"proto3_optional"===s&&(s="optional"),this.rule=s&&"optional"!==s?s:undefined,this.type=r,this.id=t,this.extend=o||undefined,this.required="required"===s,this.optional=!this.required,this.repeated="repeated"===s,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&i.long[r]!==undefined,this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}l.fromJSON=function(e,t){return new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),l.prototype.setOption=function(e,t,r){return"packed"===e&&(this._packed=null),n.prototype.setOption.call(this,e,t,r)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["rule","optional"!==this.rule&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},l.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=i.defaults[this.type])===undefined&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof s?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(this.options.packed===undefined||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=undefined)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof s&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},l.d=function(e,t,r,n){return"function"==typeof t?t=a.decorateType(t).name:t&&"object"==typeof t&&(t=a.decorateEnum(t).name),function(s,o){a.decorateType(s.constructor).add(new l(o,e,t,r,{default:n}))}},l._configure=function(e){s=e}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/field.js"}],[4151,{"./converter":4146,"./decoder":4147,"./encoder":4148,"./enum":4149,"./field":4150,"./index-minimal":4152,"./mapfield":4153,"./message":4154,"./method":4155,"./namespace":4156,"./object":4157,"./oneof":4158,"./root":4161,"./service":4165,"./type":4166,"./types":4167,"./util":4168,"./verifier":4171,"./wrappers":4172},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=t.exports=e("./index-minimal");n.build="light",n.load=function(e,t,r){return"function"==typeof t?(r=t,t=new n.Root):t||(t=new n.Root),t.load(e,r)},n.loadSync=function(e,t){return t||(t=new n.Root),t.loadSync(e)},n.encoder=e("./encoder"),n.decoder=e("./decoder"),n.verifier=e("./verifier"),n.converter=e("./converter"),n.ReflectionObject=e("./object"),n.Namespace=e("./namespace"),n.Root=e("./root"),n.Enum=e("./enum"),n.Type=e("./type"),n.Field=e("./field"),n.OneOf=e("./oneof"),n.MapField=e("./mapfield"),n.Service=e("./service"),n.Method=e("./method"),n.Message=e("./message"),n.wrappers=e("./wrappers"),n.types=e("./types"),n.util=e("./util"),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/index-light.js"}],[4152,{"./reader":4159,"./reader_buffer":4160,"./roots":4162,"./rpc":4163,"./util/minimal":4170,"./writer":4173,"./writer_buffer":4174},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=r;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=e("./writer"),n.BufferWriter=e("./writer_buffer"),n.Reader=e("./reader"),n.BufferReader=e("./reader_buffer"),n.util=e("./util/minimal"),n.rpc=e("./rpc"),n.roots=e("./roots"),n.configure=s,s()}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/index-minimal.js"}],[4153,{"./field":4150,"./types":4167,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./field");((i.prototype=Object.create(n.prototype)).constructor=i).className="MapField";var s=e("./types"),o=e("./util");function i(e,t,r,s,i,a){if(n.call(this,e,t,s,undefined,undefined,i,a),!o.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}i.fromJSON=function(e,t){return new i(e,t.id,t.keyType,t.type,t.options,t.comment)},i.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},i.prototype.resolve=function(){if(this.resolved)return this;if(s.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},i.d=function(e,t,r){return"function"==typeof r?r=o.decorateType(r).name:r&&"object"==typeof r&&(r=o.decorateEnum(r).name),function(n,s){o.decorateType(n.constructor).add(new i(s,e,t,r))}}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/mapfield.js"}],[4154,{"./util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=s;var n=e("./util/minimal");function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}s.create=function(e){return this.$type.create(e)},s.encode=function(e,t){return this.$type.encode(e,t)},s.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},s.decode=function(e){return this.$type.decode(e)},s.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},s.verify=function(e){return this.$type.verify(e)},s.fromObject=function(e){return this.$type.fromObject(e)},s.toObject=function(e,t){return this.$type.toObject(e,t)},s.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/message.js"}],[4155,{"./object":4157,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=o;var n=e("./object");((o.prototype=Object.create(n.prototype)).constructor=o).className="Method";var s=e("./util");function o(e,t,r,o,i,a,c,l,u){if(s.isObject(i)?(c=i,i=a=undefined):s.isObject(a)&&(c=a,a=undefined),t!==undefined&&!s.isString(t))throw TypeError("type must be a string");if(!s.isString(r))throw TypeError("requestType must be a string");if(!s.isString(o))throw TypeError("responseType must be a string");n.call(this,e,c),this.type=t||"rpc",this.requestType=r,this.requestStream=!!i||undefined,this.responseType=o,this.responseStream=!!a||undefined,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=u}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["type","rpc"!==this.type&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:undefined,"parsedOptions",this.parsedOptions])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/method.js"}],[4156,{"./field":4150,"./object":4157,"./oneof":4158,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=d;var n=e("./object");((d.prototype=Object.create(n.prototype)).constructor=d).className="Namespace";var s,o,i,a=e("./field"),c=e("./oneof"),l=e("./util");function u(e,t){if(!e||!e.length)return undefined;for(var r={},n=0;n<e.length;++n)r[e[n].name]=e[n].toJSON(t);return r}function d(e,t){n.call(this,e,t),this.nested=undefined,this._nestedArray=null}function h(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var r=0;r<e.length;++r)if("string"!=typeof e[r]&&e[r][0]<=t&&e[r][1]>t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),d.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,r=Object.keys(e),n=0;n<r.length;++n)t=e[r[n]],this.add((t.fields!==undefined?s.fromJSON:t.values!==undefined?i.fromJSON:t.methods!==undefined?o.fromJSON:t.id!==undefined?a.fromJSON:d.fromJSON)(r[n],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof i)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof a&&e.extend!==undefined||e instanceof s||e instanceof i||e instanceof o||e instanceof d||e instanceof c))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof s||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var r=t.nestedArray,n=0;n<r.length;++n)e.add(r[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),h(this)},d.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=undefined),e.onRemove(this),h(this)},d.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var r=this;e.length>0;){var n=e.shift();if(r.nested&&r.nested[n]){if(!((r=r.nested[n])instanceof d))throw Error("path conflicts with non-namespace objects")}else r.add(r=new d(n))}return t&&r.addJSON(t),r},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,r){if("boolean"==typeof t?(r=t,t=undefined):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof d&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof d&&(n=this._nestedArray[s].lookup(e,t,!0)))return n;return null===this.parent||r?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[s,i]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,r){s=e,o=t,i=r}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/namespace.js"}],[4157,{"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=o,o.className="ReflectionObject";var n,s=e("./util");function o(e,t){if(!s.isString(e))throw TypeError("name must be a string");if(t&&!s.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},o.prototype.getOption=function(e){return this.options?this.options[e]:undefined},o.prototype.setOption=function(e,t,r){return r&&this.options&&this.options[e]!==undefined||((this.options||(this.options={}))[e]=t),this},o.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(r){var o=n.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(o){var i=o[e];s.setProperty(i,r,t)}else(o={})[e]=s.setProperty({},r,t),n.push(o)}else{var a={};a[e]=t,n.push(a)}return this},o.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){n=e}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/object.js"}],[4158,{"./field":4150,"./object":4157,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./object");((i.prototype=Object.create(n.prototype)).constructor=i).className="OneOf";var s=e("./field"),o=e("./util");function i(e,t,r,s){if(Array.isArray(t)||(r=t,t=undefined),n.call(this,e,r),t!==undefined&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=s}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}i.fromJSON=function(e,t){return new i(e,t.oneof,t.options,t.comment)},i.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:undefined])},i.prototype.add=function(e){if(!(e instanceof s))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},i.prototype.remove=function(e){if(!(e instanceof s))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},i.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var r=e.get(this.oneof[t]);r&&!r.partOf&&(r.partOf=this,this.fieldsArray.push(r))}a(this)},i.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},i.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,r){o.decorateType(t.constructor).add(new i(r,e)),Object.defineProperty(t,r,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/oneof.js"}],[4159,{"./util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=c;var n,s=e("./util/minimal"),o=s.LongBits,i=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new n(e):u(e)})(e)}:u};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return i.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=d(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/reader.js"}],[4160,{"./reader":4159,"./util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=o;var n=e("./reader");(o.prototype=Object.create(n.prototype)).constructor=o;var s=e("./util/minimal");function o(e){n.call(this,e)}o._configure=function(){s.Buffer&&(o.prototype._slice=s.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/reader_buffer.js"}],[4161,{"./enum":4149,"./field":4150,"./namespace":4156,"./oneof":4158,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=d;var n=e("./namespace");((d.prototype=Object.create(n.prototype)).constructor=d).className="Root";var s,o,i,a=e("./field"),c=e("./enum"),l=e("./oneof"),u=e("./util");function d(e){n.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,r,n){"function"==typeof r&&(n=r,r=undefined);var s=this;if(!n)return u.asPromise(e,s,t,r);var a=n===h;function c(e,t){if(n){var r=n;if(n=null,a)throw e;r(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var r=e.substring(t);if(r in i)return r}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){o.filename=e;var n,i=o(t,s,r),d=0;if(i.imports)for(;d<i.imports.length;++d)(n=l(i.imports[d])||s.resolvePath(e,i.imports[d]))&&p(n);if(i.weakImports)for(d=0;d<i.weakImports.length;++d)(n=l(i.weakImports[d])||s.resolvePath(e,i.weakImports[d]))&&p(n,!0)}else s.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}a||f||c(null,s)}function p(e,t){if(!(s.files.indexOf(e)>-1))if(s.files.push(e),e in i)a?d(e,i[e]):(++f,setTimeout((function(){--f,d(e,i[e])})));else if(a){var r;try{r=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}d(e,r)}else++f,s.fetch(e,(function(r,o){--f,n&&(r?t?f||c(null,s):c(r):d(e,o))}))}var f=0;u.isString(t)&&(t=[t]);for(var g,m=0;m<t.length;++m)(g=s.resolvePath("",t[m]))&&p(g);return a?s:(f||c(null,s),undefined)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return n.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function f(e,t){var r=t.parent.lookup(t.extend);if(r){var n=new a(t.fullName,t.id,t.type,t.rule,undefined,t.options);return n.declaringField=t,t.extensionField=n,r.add(n),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof a)e.extend===undefined||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof c)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof s)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);p.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof a){if(e.extend!==undefined)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof n){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);p.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,r){s=e,o=t,i=r}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/root.js"}],[4162,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/roots.js"}],[4163,{"./rpc/service":4164},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.Service=e("./rpc/service")}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/rpc.js"}],[4164,{"../util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=s;var n=e("../util/minimal");function s(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,r,s,o,i){if(!o)throw TypeError("request must be specified");var a=this;if(!i)return n.asPromise(e,a,t,r,s,o);if(!a.rpcImpl)return setTimeout((function(){i(Error("already ended"))}),0),undefined;try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),i(e);if(null===r)return a.end(!0),undefined;if(!(r instanceof s))try{r=s[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),i(e)}return a.emit("data",r,t),i(null,r)}))}catch(e){return a.emit("error",e,t),setTimeout((function(){i(e)}),0),undefined}},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/rpc/service.js"}],[4165,{"./method":4155,"./namespace":4156,"./rpc":4163,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=a;var n=e("./namespace");((a.prototype=Object.create(n.prototype)).constructor=a).className="Service";var s=e("./method"),o=e("./util"),i=e("./rpc");function a(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var r=new a(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),o=0;o<n.length;++o)r.add(s.fromJSON(n[o],t.methods[n[o]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r},a.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||undefined,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||undefined,"comment",r?this.comment:undefined])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof s?(this.methods[e.name]=e,e.parent=this,c(this)):n.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof s){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return n.prototype.remove.call(this,e)},a.prototype.create=function(e,t,r){for(var n,s=new i.Service(e,t,r),a=0;a<this.methodsArray.length;++a){var c=o.lcFirst((n=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");s[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return s}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/service.js"}],[4166,{"./converter":4146,"./decoder":4147,"./encoder":4148,"./enum":4149,"./field":4150,"./mapfield":4153,"./message":4154,"./namespace":4156,"./oneof":4158,"./reader":4159,"./service":4165,"./util":4168,"./verifier":4171,"./wrappers":4172,"./writer":4173},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=b;var n=e("./namespace");((b.prototype=Object.create(n.prototype)).constructor=b).className="Type";var s=e("./enum"),o=e("./oneof"),i=e("./field"),a=e("./mapfield"),c=e("./service"),l=e("./message"),u=e("./reader"),d=e("./writer"),h=e("./util"),p=e("./encoder"),f=e("./decoder"),g=e("./verifier"),m=e("./converter"),y=e("./wrappers");function b(e,t){n.call(this,e,t),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function w(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(b.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=b.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,l,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:h.oneOfGetter(this._oneofsArray[r].oneof),set:h.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,n)}}}),b.generateConstructor=function(e){for(var t,r=h.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?r("this%s={}",h.safeProp(t.name)):t.repeated&&r("this%s=[]",h.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},b.fromJSON=function(e,t){var r=new b(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var l=Object.keys(t.fields),u=0;u<l.length;++u)r.add((void 0!==t.fields[l[u]].keyType?a.fromJSON:i.fromJSON)(l[u],t.fields[l[u]]));if(t.oneofs)for(l=Object.keys(t.oneofs),u=0;u<l.length;++u)r.add(o.fromJSON(l[u],t.oneofs[l[u]]));if(t.nested)for(l=Object.keys(t.nested),u=0;u<l.length;++u){var d=t.nested[l[u]];r.add((d.id!==undefined?i.fromJSON:d.fields!==undefined?b.fromJSON:d.values!==undefined?s.fromJSON:d.methods!==undefined?c.fromJSON:n.fromJSON)(l[u],d))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r},b.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return h.toObject(["options",t&&t.options||undefined,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined,"comment",r?this.comment:undefined])},b.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return n.prototype.resolveAll.call(this)},b.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},b.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof i&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),w(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),w(this)):n.prototype.add.call(this,e)},b.prototype.remove=function(e){if(e instanceof i&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),w(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),w(this)}return n.prototype.remove.call(this,e)},b.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},b.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},b.prototype.create=function(e){return new this.ctor(e)},b.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=p(this)({Writer:d,types:t,util:h}),this.decode=f(this)({Reader:u,types:t,util:h}),this.verify=g(this)({types:t,util:h}),this.fromObject=m.fromObject(this)({types:t,util:h}),this.toObject=m.toObject(this)({types:t,util:h});var n=y[e];if(n){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(s),s.toObject=this.toObject,this.toObject=n.toObject.bind(s)}return this},b.prototype.encode=function(e,t){return this.setup().encode(e,t)},b.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},b.prototype.decode=function(e,t){return this.setup().decode(e,t)},b.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},b.prototype.verify=function(e){return this.setup().verify(e)},b.prototype.fromObject=function(e){return this.setup().fromObject(e)},b.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},b.d=function(e){return function(t){h.decorateType(t,e)}}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/type.js"}],[4167,{"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=r,s=e("./util"),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function i(e,t){var r=0,n={};for(t|=0;r<e.length;)n[o[r+t]]=e[r++];return n}n.basic=i([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=i([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",s.emptyArray,null]),n.long=i([0,0,0,1,1],7),n.mapKey=i([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=i([1,5,0,0,0,5,5,0,0,0,1,1,0])}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/types.js"}],[4168,{"./enum":4149,"./root":4161,"./roots":4162,"./type":4166,"./util/minimal":4170,"@protobufjs/codegen":2026,"@protobufjs/fetch":2028,"@protobufjs/path":2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o=t.exports=e("./util/minimal"),i=e("./roots");o.codegen=e("@protobufjs/codegen"),o.fetch=e("@protobufjs/fetch"),o.path=e("@protobufjs/path"),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),n=0;n<t.length;)r[n]=e[t[n++]];return r}return[]},o.toObject=function(e){for(var t={},r=0;r<e.length;){var n=e[r++],s=e[r++];s!==undefined&&(t[n]=s)}return t};var a=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(a,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(t,r){if(t.$type)return r&&t.$type.name!==r&&(o.decorateRoot.remove(t.$type),t.$type.name=r,o.decorateRoot.add(t.$type)),t.$type;n||(n=e("./type"));var s=new n(r||t.name);return o.decorateRoot.add(s),s.ctor=t,Object.defineProperty(t,"$type",{value:s,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:s,enumerable:!1}),s};var u=0;o.decorateEnum=function(t){if(t.$type)return t.$type;s||(s=e("./enum"));var r=new s("Enum"+u++,t);return o.decorateRoot.add(r),Object.defineProperty(t,"$type",{value:r,enumerable:!1}),r},o.setProperty=function(e,t,r){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,r,n){var s=r.shift();if("__proto__"===s||"prototype"===s)return t;if(r.length>0)t[s]=e(t[s]||{},r,n);else{var o=t[s];o&&(n=[].concat(o).concat(n)),t[s]=n}return t}(e,t=t.split("."),r)},Object.defineProperty(o,"decorateRoot",{get:function(){return i.decorated||(i.decorated=new(e("./root")))}})}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/util.js"}],[4169,{"../util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=s;var n=e("../util/minimal");function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=s.zero=new s(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var i=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new s(r,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):o},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===i?o:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/util/longbits.js"}],[4170,{"./longbits":4169,"@protobufjs/aspromise":2024,"@protobufjs/base64":2025,"@protobufjs/eventemitter":2027,"@protobufjs/float":2029,"@protobufjs/inquire":2030,"@protobufjs/pool":2032,"@protobufjs/utf8":2033},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=r;function s(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)e[n[s]]!==undefined&&r||(e[n[s]]=t[n[s]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&s(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=e("@protobufjs/aspromise"),n.base64=e("@protobufjs/base64"),n.EventEmitter=e("@protobufjs/eventemitter"),n.float=e("@protobufjs/float"),n.inquire=e("@protobufjs/inquire"),n.utf8=e("@protobufjs/utf8"),n.pool=e("@protobufjs/pool"),n.LongBits=e("./longbits"),n.isNode=Boolean("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),n.global=n.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&this[e[r]]!==undefined&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/util/minimal.js"}],[4171,{"./enum":4149,"./util":4168},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){var t=s.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,n={};r.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var l=e._fieldsArray[c].resolve(),u="m"+s.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,l.name),l.map)t("if(!util.isObject(%s))",u)("return%j",o(l,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),a(t,l,"k[i]"),i(t,l,c,u+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",u)("return%j",o(l,"array"))("for(var i=0;i<%s.length;++i){",u),i(t,l,c,u+"[i]")("}");else{if(l.partOf){var d=s.safeProp(l.partOf.name);1===n[l.partOf.name]&&t("if(p%s===1)",d)("return%j",l.partOf.name+": multiple values"),n[l.partOf.name]=1,t("p%s=1",d)}i(t,l,c,u)}l.optional&&t("}")}return t("return null")};var n=e("./enum"),s=e("./util");function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function i(e,t,r,s){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",s)("default:")("return%j",o(t,"enum value"));for(var i=Object.keys(t.resolvedType.values),a=0;a<i.length;++a)e("case %i:",t.resolvedType.values[i[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,s)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",s)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",s,s,s,s)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',s)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',s)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",s)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',s,s,s)("return%j",o(t,"buffer"))}return e}function a(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",o(t,"boolean key"))}return e}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/verifier.js"}],[4172,{"./message":4154},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=r,s=e("./message");n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),r=this.lookup(t);if(r){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===n.indexOf("/")&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var r="",n="";if(t&&t.json&&e.type_url&&e.value){n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),r=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(n);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof s){var i=e.$type.toObject(e,t);return""===r&&(r="type.googleapis.com/"),n=r+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),i["@type"]=n,i}return this.toObject(e,t)}}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/wrappers.js"}],[4173,{"./util/minimal":4170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=d;var n,s=e("./util/minimal"),o=s.LongBits,i=s.base64,a=s.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=undefined,this.val=r}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var h=function(){return s.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function p(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=undefined,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(d.alloc=s.pool(d.alloc,s.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var y=s.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(s.isString(e)){var r=d.alloc(t=i.length(e));i.decode(e,r,0),e=r}return this.uint32(t)._push(y,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=h(),n._configure()}}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/writer.js"}],[4174,{"./util/minimal":4170,"./writer":4173},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=o;var n=e("./writer");(o.prototype=Object.create(n.prototype)).constructor=o;var s=e("./util/minimal");function o(){n.call(this)}function i(e,t,r){e.length<40?s.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=s._Buffer_allocUnsafe,o.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},o.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(i,t,e),this},o._configure()}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-web>@trezor/connect>@trezor/transport>protobufjs",file:"node_modules/protobufjs/src/writer_buffer.js"}],[42,{loglevel:3987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){const e=[];return function(t,r,n,o){return e.indexOf(t.id)>=0?(s.default.info(`RPC request with id ${t.id} already seen.`),o()):(e.push(t.id),n())}};var n,s=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/lib/createDupeReqFilterMiddleware.js"}],[43,{loglevel:3987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){n((n=>{r.error&&s.default.debug("Error in RPC response:\n",r),t.isMetamaskInternal||(s.default.info(`RPC (${e.origin}): ${t.method} -> ${r.error?"error":"success"}`),n())}))}};var n,s=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[44,{"../../../shared/modules/mv3.utils":4706,"eth-rpc-errors":3132},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../shared/modules/mv3.utils");r.default=(e,t,r,o)=>async i=>{if(t._writableState.ended)return;if(!e[i.method])return void t.write({jsonrpc:"2.0",error:n.ethErrors.rpc.methodNotFound({message:`${i.method} not found`}),id:i.id});let a,c;try{a=await e[i.method](...i.params)}catch(e){c=e}finally{s.isManifestV3&&r&&"getState"!==i.method&&o.set(r.getState())}t._writableState.ended?c&&console.error(c):c?t.write({jsonrpc:"2.0",error:(0,n.serializeError)(c,{shouldIncludeStack:!0}),id:i.id}):t.write({jsonrpc:"2.0",result:a,id:i.id})}}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[4415,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(r=t.exports=function(e){return String(e).replace(r.expr,"")}).expr=/\/+$/}}},{package:"remove-trailing-slash",file:"node_modules/remove-trailing-slash/index.js"}],[4426,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{hasOwnProperty:n}=Object.prototype,s=f();s.configure=f,s.stringify=s,s.default=s,r.stringify=s,r.configure=f,t.exports=s;const o=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;function i(e){return e.length<5e3&&!o.test(e)?`"${e}"`:JSON.stringify(e)}function a(e){if(e.length>200)return e.sort();for(let t=1;t<e.length;t++){const r=e[t];let n=t;for(;0!==n&&e[n-1]>r;)e[n]=e[n-1],n--;e[n]=r}return e}const c=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function l(e){return c.call(e)!==undefined&&0!==e.length}function u(e,t,r){e.length<r&&(r=e.length);const n=","===t?"":" ";let s=`"0":${n}${e[0]}`;for(let o=1;o<r;o++)s+=`${t}"${o}":${n}${e[o]}`;return s}function d(e,t){let r;if(n.call(e,t)&&(r=e[t],"boolean"!=typeof r))throw new TypeError(`The "${t}" argument must be of type boolean`);return r===undefined||r}function h(e,t){let r;if(n.call(e,t)){if(r=e[t],"number"!=typeof r)throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return r===undefined?Infinity:r}function p(e){return 1===e?"1 item":`${e} items`}function f(e){const t=function(e){if(n.call(e,"strict")){const t=e.strict;if("boolean"!=typeof t)throw new TypeError('The "strict" argument must be of type boolean');if(t)return e=>{let t="Object can not safely be stringified. Received type "+typeof e;throw"function"!=typeof e&&(t+=` (${e.toString()})`),new Error(t)}}}(e={...e});t&&(e.bigint===undefined&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));const r=function(e){if(n.call(e,"circularValue")){const t=e.circularValue;if("string"==typeof t)return`"${t}"`;if(null==t)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(e),s=d(e,"bigint"),o=d(e,"deterministic"),c=h(e,"maximumDepth"),f=h(e,"maximumBreadth");function g(e,n,u,d,h,m){let y=n[e];switch("object"==typeof y&&null!==y&&"function"==typeof y.toJSON&&(y=y.toJSON(e)),y=d.call(n,e,y),typeof y){case"string":return i(y);case"object":{if(null===y)return"null";if(-1!==u.indexOf(y))return r;let e="",t=",";const n=m;if(Array.isArray(y)){if(0===y.length)return"[]";if(c<u.length+1)return'"[Array]"';u.push(y),""!==h&&(e+=`\n${m+=h}`,t=`,\n${m}`);const r=Math.min(y.length,f);let s=0;for(;s<r-1;s++){const r=g(String(s),y,u,d,h,m);e+=r!==undefined?r:"null",e+=t}const o=g(String(s),y,u,d,h,m);if(e+=o!==undefined?o:"null",y.length-1>f){e+=`${t}"... ${p(y.length-f-1)} not stringified"`}return""!==h&&(e+=`\n${n}`),u.pop(),`[${e}]`}let s=Object.keys(y);const b=s.length;if(0===b)return"{}";if(c<u.length+1)return'"[Object]"';let w="",v="";""!==h&&(t=`,\n${m+=h}`,w=" ");const k=Math.min(b,f);o&&!l(y)&&(s=a(s)),u.push(y);for(let r=0;r<k;r++){const n=s[r],o=g(n,y,u,d,h,m);o!==undefined&&(e+=`${v}${i(n)}:${w}${o}`,v=t)}if(b>f){e+=`${v}"...":${w}"${p(b-f)} not stringified"`,v=t}return""!==h&&v.length>1&&(e=`\n${m}${e}\n${n}`),u.pop(),`{${e}}`}case"number":return isFinite(y)?String(y):t?t(y):"null";case"boolean":return!0===y?"true":"false";case"undefined":return undefined;case"bigint":if(s)return String(y);default:return t?t(y):undefined}}function m(e,n,o,a,l,u){switch("object"==typeof n&&null!==n&&"function"==typeof n.toJSON&&(n=n.toJSON(e)),typeof n){case"string":return i(n);case"object":{if(null===n)return"null";if(-1!==o.indexOf(n))return r;const e=u;let t="",s=",";if(Array.isArray(n)){if(0===n.length)return"[]";if(c<o.length+1)return'"[Array]"';o.push(n),""!==l&&(t+=`\n${u+=l}`,s=`,\n${u}`);const r=Math.min(n.length,f);let i=0;for(;i<r-1;i++){const e=m(String(i),n[i],o,a,l,u);t+=e!==undefined?e:"null",t+=s}const d=m(String(i),n[i],o,a,l,u);if(t+=d!==undefined?d:"null",n.length-1>f){t+=`${s}"... ${p(n.length-f-1)} not stringified"`}return""!==l&&(t+=`\n${e}`),o.pop(),`[${t}]`}o.push(n);let d="";""!==l&&(s=`,\n${u+=l}`,d=" ");let h="";for(const e of a){const r=m(e,n[e],o,a,l,u);r!==undefined&&(t+=`${h}${i(e)}:${d}${r}`,h=s)}return""!==l&&h.length>1&&(t=`\n${u}${t}\n${e}`),o.pop(),`{${t}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return undefined;case"bigint":if(s)return String(n);default:return t?t(n):undefined}}function y(e,n,d,h,g){switch(typeof n){case"string":return i(n);case"object":{if(null===n)return"null";if("function"==typeof n.toJSON){if("object"!=typeof(n=n.toJSON(e)))return y(e,n,d,h,g);if(null===n)return"null"}if(-1!==d.indexOf(n))return r;const t=g;if(Array.isArray(n)){if(0===n.length)return"[]";if(c<d.length+1)return'"[Array]"';d.push(n);let e=`\n${g+=h}`;const r=`,\n${g}`,s=Math.min(n.length,f);let o=0;for(;o<s-1;o++){const t=y(String(o),n[o],d,h,g);e+=t!==undefined?t:"null",e+=r}const i=y(String(o),n[o],d,h,g);if(e+=i!==undefined?i:"null",n.length-1>f){e+=`${r}"... ${p(n.length-f-1)} not stringified"`}return e+=`\n${t}`,d.pop(),`[${e}]`}let s=Object.keys(n);const m=s.length;if(0===m)return"{}";if(c<d.length+1)return'"[Object]"';const b=`,\n${g+=h}`;let w="",v="",k=Math.min(m,f);l(n)&&(w+=u(n,b,f),s=s.slice(n.length),k-=n.length,v=b),o&&(s=a(s)),d.push(n);for(let e=0;e<k;e++){const t=s[e],r=y(t,n[t],d,h,g);r!==undefined&&(w+=`${v}${i(t)}: ${r}`,v=b)}if(m>f){w+=`${v}"...": "${p(m-f)} not stringified"`,v=b}return""!==v&&(w=`\n${g}${w}\n${t}`),d.pop(),`{${w}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return undefined;case"bigint":if(s)return String(n);default:return t?t(n):undefined}}function b(e,n,d){switch(typeof n){case"string":return i(n);case"object":{if(null===n)return"null";if("function"==typeof n.toJSON){if("object"!=typeof(n=n.toJSON(e)))return b(e,n,d);if(null===n)return"null"}if(-1!==d.indexOf(n))return r;let t="";if(Array.isArray(n)){if(0===n.length)return"[]";if(c<d.length+1)return'"[Array]"';d.push(n);const e=Math.min(n.length,f);let r=0;for(;r<e-1;r++){const e=b(String(r),n[r],d);t+=e!==undefined?e:"null",t+=","}const s=b(String(r),n[r],d);if(t+=s!==undefined?s:"null",n.length-1>f){t+=`,"... ${p(n.length-f-1)} not stringified"`}return d.pop(),`[${t}]`}let s=Object.keys(n);const h=s.length;if(0===h)return"{}";if(c<d.length+1)return'"[Object]"';let g="",m=Math.min(h,f);l(n)&&(t+=u(n,",",f),s=s.slice(n.length),m-=n.length,g=","),o&&(s=a(s)),d.push(n);for(let e=0;e<m;e++){const r=s[e],o=b(r,n[r],d);o!==undefined&&(t+=`${g}${i(r)}:${o}`,g=",")}if(h>f){t+=`${g}"...":"${p(h-f)} not stringified"`}return d.pop(),`{${t}}`}case"number":return isFinite(n)?String(n):t?t(n):"null";case"boolean":return!0===n?"true":"false";case"undefined":return undefined;case"bigint":if(s)return String(n);default:return t?t(n):undefined}}return function(e,t,r){if(arguments.length>1){let n="";if("number"==typeof r?n=" ".repeat(Math.min(r,10)):"string"==typeof r&&(n=r.slice(0,10)),null!=t){if("function"==typeof t)return g("",{"":e},[],t,n,"");if(Array.isArray(t))return m("",e,[],function(e){const t=new Set;for(const r of e)"string"!=typeof r&&"number"!=typeof r||t.add(String(r));return t}(t),n,"")}if(0!==n.length)return y("",e,[],n,"")}return b("",e,[])}}}}},{package:"@metamask/eth-json-rpc-middleware>safe-stable-stringify",file:"node_modules/safe-stable-stringify/index.js"}],[45,{"./middleware/pending":61,"@metamask/eth-json-rpc-middleware":1215,"json-rpc-engine":3772},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({version:e,getAccounts:t,processTransaction:r,processEthSignMessage:i,processTypedMessage:a,processTypedMessageV3:c,processTypedMessageV4:l,processPersonalMessage:u,processDecryptMessage:d,processEncryptionPublicKey:h,getPendingNonce:p,getPendingTransactionByHash:f}){return(0,n.mergeMiddleware)([(0,n.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,s.createWalletMiddleware)({getAccounts:t,processTransaction:r,processEthSignMessage:i,processTypedMessage:a,processTypedMessageV3:c,processTypedMessageV4:l,processPersonalMessage:u,processDecryptMessage:d,processEncryptionPublicKey:h}),(0,o.createPendingNonceMiddleware)({getPendingNonce:p}),(0,o.createPendingTxMiddleware)({getPendingTransactionByHash:f})])};var n=e("json-rpc-engine"),s=e("@metamask/eth-json-rpc-middleware"),o=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[4557,{_process:4118,stream:4497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("stream");function s(e,t,s){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,i=!1,a=[],c=!1,l=new n;function u(){for(;a.length&&!l.paused;){var e=a.shift();if(null===e)return l.emit("end");l.emit("data",e)}}return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(s&&!1===s.autoDestroy),l.write=function(t){return e.call(this,t),!l.paused},l.queue=l.push=function(e){return c||(null===e&&(c=!0),a.push(e),u()),l},l.on("end",(function(){l.readable=!1,!l.writable&&l.autoDestroy&&r.nextTick((function(){l.destroy()}))})),l.end=function(e){if(!o)return o=!0,arguments.length&&l.write(e),l.writable=!1,t.call(l),!l.readable&&l.autoDestroy&&l.destroy(),l},l.destroy=function(){if(!i)return i=!0,o=!0,a.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),u(),l.paused||l.emit("drain"),l},l}t.exports=s,s.through=s}).call(this)}).call(this,e("_process"))}}},{package:"debounce-stream>through",file:"node_modules/through/index.js"}],[4562,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"base32-encode>to-data-view",file:"node_modules/to-data-view/index.js"}],[4566,{buffer:2769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){var r,n;r=this,n=function(){var t={};function r(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return t.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,r=unescape(encodeURIComponent(e)),n=new Uint8Array(r.length);for(t=0;t<r.length;t++)n[t]=r.charCodeAt(t);return n},t.encodeUTF8=function(e){var t,r=[];for(t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(r.join("")))},"undefined"==typeof atob?void 0!==e.from?(t.encodeBase64=function(t){return e.from(t).toString("base64")},t.decodeBase64=function(t){return r(t),new Uint8Array(Array.prototype.slice.call(e.from(t,"base64"),0))}):(t.encodeBase64=function(t){return new e(t).toString("base64")},t.decodeBase64=function(t){return r(t),new Uint8Array(Array.prototype.slice.call(new e(t,"base64"),0))}):(t.encodeBase64=function(e){var t,r=[],n=e.length;for(t=0;t<n;t++)r.push(String.fromCharCode(e[t]));return btoa(r.join(""))},t.decodeBase64=function(e){r(e);var t,n=atob(e),s=new Uint8Array(n.length);for(t=0;t<n.length;t++)s[t]=n.charCodeAt(t);return s}),t},void 0!==t&&t.exports?t.exports=n():(r.nacl||(r.nacl={}),r.nacl.util=n())}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-sig-util>tweetnacl-util",file:"node_modules/tweetnacl-util/nacl-util.js"}],[4567,{crypto:2769},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){!function(t){var r=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var i=r(),a=r([1]),c=r([56129,1]),l=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function g(e,t,r,n,s){var o,i=0;for(o=0;o<s;o++)i|=e[t+o]^r[n+o];return(1&i-1>>>8)-1}function m(e,t,r,n){return g(e,t,r,n,16)}function y(e,t,r,n){return g(e,t,r,n,32)}function b(e,t,r,n){!function(e,t,r,n){for(var s,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,l=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,k=o,C=i,_=a,S=c,A=l,T=u,E=d,M=h,P=p,N=f,O=g,R=m,I=y,j=b,x=w,L=v,D=0;D<20;D+=2)k^=(s=(I^=(s=(P^=(s=(A^=(s=k+I|0)<<7|s>>>25)+k|0)<<9|s>>>23)+A|0)<<13|s>>>19)+P|0)<<18|s>>>14,T^=(s=(C^=(s=(j^=(s=(N^=(s=T+C|0)<<7|s>>>25)+T|0)<<9|s>>>23)+N|0)<<13|s>>>19)+j|0)<<18|s>>>14,O^=(s=(E^=(s=(_^=(s=(x^=(s=O+E|0)<<7|s>>>25)+O|0)<<9|s>>>23)+x|0)<<13|s>>>19)+_|0)<<18|s>>>14,L^=(s=(R^=(s=(M^=(s=(S^=(s=L+R|0)<<7|s>>>25)+L|0)<<9|s>>>23)+S|0)<<13|s>>>19)+M|0)<<18|s>>>14,k^=(s=(S^=(s=(_^=(s=(C^=(s=k+S|0)<<7|s>>>25)+k|0)<<9|s>>>23)+C|0)<<13|s>>>19)+_|0)<<18|s>>>14,T^=(s=(A^=(s=(M^=(s=(E^=(s=T+A|0)<<7|s>>>25)+T|0)<<9|s>>>23)+E|0)<<13|s>>>19)+M|0)<<18|s>>>14,O^=(s=(N^=(s=(P^=(s=(R^=(s=O+N|0)<<7|s>>>25)+O|0)<<9|s>>>23)+R|0)<<13|s>>>19)+P|0)<<18|s>>>14,L^=(s=(x^=(s=(j^=(s=(I^=(s=L+x|0)<<7|s>>>25)+L|0)<<9|s>>>23)+I|0)<<13|s>>>19)+j|0)<<18|s>>>14;k=k+o|0,C=C+i|0,_=_+a|0,S=S+c|0,A=A+l|0,T=T+u|0,E=E+d|0,M=M+h|0,P=P+p|0,N=N+f|0,O=O+g|0,R=R+m|0,I=I+y|0,j=j+b|0,x=x+w|0,L=L+v|0,e[0]=k>>>0&255,e[1]=k>>>8&255,e[2]=k>>>16&255,e[3]=k>>>24&255,e[4]=C>>>0&255,e[5]=C>>>8&255,e[6]=C>>>16&255,e[7]=C>>>24&255,e[8]=_>>>0&255,e[9]=_>>>8&255,e[10]=_>>>16&255,e[11]=_>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=A>>>0&255,e[17]=A>>>8&255,e[18]=A>>>16&255,e[19]=A>>>24&255,e[20]=T>>>0&255,e[21]=T>>>8&255,e[22]=T>>>16&255,e[23]=T>>>24&255,e[24]=E>>>0&255,e[25]=E>>>8&255,e[26]=E>>>16&255,e[27]=E>>>24&255,e[28]=M>>>0&255,e[29]=M>>>8&255,e[30]=M>>>16&255,e[31]=M>>>24&255,e[32]=P>>>0&255,e[33]=P>>>8&255,e[34]=P>>>16&255,e[35]=P>>>24&255,e[36]=N>>>0&255,e[37]=N>>>8&255,e[38]=N>>>16&255,e[39]=N>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=R>>>0&255,e[45]=R>>>8&255,e[46]=R>>>16&255,e[47]=R>>>24&255,e[48]=I>>>0&255,e[49]=I>>>8&255,e[50]=I>>>16&255,e[51]=I>>>24&255,e[52]=j>>>0&255,e[53]=j>>>8&255,e[54]=j>>>16&255,e[55]=j>>>24&255,e[56]=x>>>0&255,e[57]=x>>>8&255,e[58]=x>>>16&255,e[59]=x>>>24&255,e[60]=L>>>0&255,e[61]=L>>>8&255,e[62]=L>>>16&255,e[63]=L>>>24&255}(e,t,r,n)}function w(e,t,r,n){!function(e,t,r,n){for(var s,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,l=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,y=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,k=0;k<20;k+=2)o^=(s=(y^=(s=(p^=(s=(l^=(s=o+y|0)<<7|s>>>25)+o|0)<<9|s>>>23)+l|0)<<13|s>>>19)+p|0)<<18|s>>>14,u^=(s=(i^=(s=(b^=(s=(f^=(s=u+i|0)<<7|s>>>25)+u|0)<<9|s>>>23)+f|0)<<13|s>>>19)+b|0)<<18|s>>>14,g^=(s=(d^=(s=(a^=(s=(w^=(s=g+d|0)<<7|s>>>25)+g|0)<<9|s>>>23)+w|0)<<13|s>>>19)+a|0)<<18|s>>>14,v^=(s=(m^=(s=(h^=(s=(c^=(s=v+m|0)<<7|s>>>25)+v|0)<<9|s>>>23)+c|0)<<13|s>>>19)+h|0)<<18|s>>>14,o^=(s=(c^=(s=(a^=(s=(i^=(s=o+c|0)<<7|s>>>25)+o|0)<<9|s>>>23)+i|0)<<13|s>>>19)+a|0)<<18|s>>>14,u^=(s=(l^=(s=(h^=(s=(d^=(s=u+l|0)<<7|s>>>25)+u|0)<<9|s>>>23)+d|0)<<13|s>>>19)+h|0)<<18|s>>>14,g^=(s=(f^=(s=(p^=(s=(m^=(s=g+f|0)<<7|s>>>25)+g|0)<<9|s>>>23)+m|0)<<13|s>>>19)+p|0)<<18|s>>>14,v^=(s=(w^=(s=(b^=(s=(y^=(s=v+w|0)<<7|s>>>25)+v|0)<<9|s>>>23)+y|0)<<13|s>>>19)+b|0)<<18|s>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=v>>>0&255,e[13]=v>>>8&255,e[14]=v>>>16&255,e[15]=v>>>24&255,e[16]=d>>>0&255,e[17]=d>>>8&255,e[18]=d>>>16&255,e[19]=d>>>24&255,e[20]=h>>>0&255,e[21]=h>>>8&255,e[22]=h>>>16&255,e[23]=h>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=f>>>0&255,e[29]=f>>>8&255,e[30]=f>>>16&255,e[31]=f>>>24&255}(e,t,r,n)}var v=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function k(e,t,r,n,s,o,i){var a,c,l=new Uint8Array(16),u=new Uint8Array(64);for(c=0;c<16;c++)l[c]=0;for(c=0;c<8;c++)l[c]=o[c];for(;s>=64;){for(b(u,l,i,v),c=0;c<64;c++)e[t+c]=r[n+c]^u[c];for(a=1,c=8;c<16;c++)a=a+(255&l[c])|0,l[c]=255&a,a>>>=8;s-=64,t+=64,n+=64}if(s>0)for(b(u,l,i,v),c=0;c<s;c++)e[t+c]=r[n+c]^u[c];return 0}function C(e,t,r,n,s){var o,i,a=new Uint8Array(16),c=new Uint8Array(64);for(i=0;i<16;i++)a[i]=0;for(i=0;i<8;i++)a[i]=n[i];for(;r>=64;){for(b(c,a,s,v),i=0;i<64;i++)e[t+i]=c[i];for(o=1,i=8;i<16;i++)o=o+(255&a[i])|0,a[i]=255&o,o>>>=8;r-=64,t+=64}if(r>0)for(b(c,a,s,v),i=0;i<r;i++)e[t+i]=c[i];return 0}function _(e,t,r,n,s){var o=new Uint8Array(32);w(o,n,s,v);for(var i=new Uint8Array(8),a=0;a<8;a++)i[a]=n[a+16];return C(e,t,r,i,o)}function S(e,t,r,n,s,o,i){var a=new Uint8Array(32);w(a,o,i,v);for(var c=new Uint8Array(8),l=0;l<8;l++)c[l]=o[l+16];return k(e,t,r,n,s,c,a)}var A=function(e){var t,r,n,s,o,i,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),s=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|s<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(s>>>4|o<<12),this.r[5]=o>>>1&8190,i=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|i<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(i>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function T(e,t,r,n,s,o){var i=new A(o);return i.update(r,n,s),i.finish(e,t),0}function E(e,t,r,n,s,o){var i=new Uint8Array(16);return T(i,0,r,n,s,o),m(e,t,i,0)}function M(e,t,r,n,s){var o;if(r<32)return-1;for(S(e,0,t,0,r,n,s),T(e,16,e,32,r-32,e),o=0;o<16;o++)e[o]=0;return 0}function P(e,t,r,n,s){var o,i=new Uint8Array(32);if(r<32)return-1;if(_(i,0,32,n,s),0!==E(t,16,t,32,r-32,i))return-1;for(S(e,0,t,0,r,n,s),o=0;o<32;o++)e[o]=0;return 0}function N(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function R(e,t,r){for(var n,s=~(r-1),o=0;o<16;o++)n=s&(e[o]^t[o]),e[o]^=n,t[o]^=n}function I(e,t){var n,s,o,i=r(),a=r();for(n=0;n<16;n++)a[n]=t[n];for(O(a),O(a),O(a),s=0;s<2;s++){for(i[0]=a[0]-65517,n=1;n<15;n++)i[n]=a[n]-65535-(i[n-1]>>16&1),i[n-1]&=65535;i[15]=a[15]-32767-(i[14]>>16&1),o=i[15]>>16&1,i[14]&=65535,R(a,i,1-o)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function j(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return I(r,e),I(n,t),y(r,0,n,0)}function x(e){var t=new Uint8Array(32);return I(t,e),1&t[0]}function L(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function U(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function B(e,t,r){var n,s,o=0,i=0,a=0,c=0,l=0,u=0,d=0,h=0,p=0,f=0,g=0,m=0,y=0,b=0,w=0,v=0,k=0,C=0,_=0,S=0,A=0,T=0,E=0,M=0,P=0,N=0,O=0,R=0,I=0,j=0,x=0,L=r[0],D=r[1],U=r[2],B=r[3],$=r[4],F=r[5],q=r[6],K=r[7],z=r[8],G=r[9],H=r[10],V=r[11],W=r[12],Y=r[13],J=r[14],Q=r[15];o+=(n=t[0])*L,i+=n*D,a+=n*U,c+=n*B,l+=n*$,u+=n*F,d+=n*q,h+=n*K,p+=n*z,f+=n*G,g+=n*H,m+=n*V,y+=n*W,b+=n*Y,w+=n*J,v+=n*Q,i+=(n=t[1])*L,a+=n*D,c+=n*U,l+=n*B,u+=n*$,d+=n*F,h+=n*q,p+=n*K,f+=n*z,g+=n*G,m+=n*H,y+=n*V,b+=n*W,w+=n*Y,v+=n*J,k+=n*Q,a+=(n=t[2])*L,c+=n*D,l+=n*U,u+=n*B,d+=n*$,h+=n*F,p+=n*q,f+=n*K,g+=n*z,m+=n*G,y+=n*H,b+=n*V,w+=n*W,v+=n*Y,k+=n*J,C+=n*Q,c+=(n=t[3])*L,l+=n*D,u+=n*U,d+=n*B,h+=n*$,p+=n*F,f+=n*q,g+=n*K,m+=n*z,y+=n*G,b+=n*H,w+=n*V,v+=n*W,k+=n*Y,C+=n*J,_+=n*Q,l+=(n=t[4])*L,u+=n*D,d+=n*U,h+=n*B,p+=n*$,f+=n*F,g+=n*q,m+=n*K,y+=n*z,b+=n*G,w+=n*H,v+=n*V,k+=n*W,C+=n*Y,_+=n*J,S+=n*Q,u+=(n=t[5])*L,d+=n*D,h+=n*U,p+=n*B,f+=n*$,g+=n*F,m+=n*q,y+=n*K,b+=n*z,w+=n*G,v+=n*H,k+=n*V,C+=n*W,_+=n*Y,S+=n*J,A+=n*Q,d+=(n=t[6])*L,h+=n*D,p+=n*U,f+=n*B,g+=n*$,m+=n*F,y+=n*q,b+=n*K,w+=n*z,v+=n*G,k+=n*H,C+=n*V,_+=n*W,S+=n*Y,A+=n*J,T+=n*Q,h+=(n=t[7])*L,p+=n*D,f+=n*U,g+=n*B,m+=n*$,y+=n*F,b+=n*q,w+=n*K,v+=n*z,k+=n*G,C+=n*H,_+=n*V,S+=n*W,A+=n*Y,T+=n*J,E+=n*Q,p+=(n=t[8])*L,f+=n*D,g+=n*U,m+=n*B,y+=n*$,b+=n*F,w+=n*q,v+=n*K,k+=n*z,C+=n*G,_+=n*H,S+=n*V,A+=n*W,T+=n*Y,E+=n*J,M+=n*Q,f+=(n=t[9])*L,g+=n*D,m+=n*U,y+=n*B,b+=n*$,w+=n*F,v+=n*q,k+=n*K,C+=n*z,_+=n*G,S+=n*H,A+=n*V,T+=n*W,E+=n*Y,M+=n*J,P+=n*Q,g+=(n=t[10])*L,m+=n*D,y+=n*U,b+=n*B,w+=n*$,v+=n*F,k+=n*q,C+=n*K,_+=n*z,S+=n*G,A+=n*H,T+=n*V,E+=n*W,M+=n*Y,P+=n*J,N+=n*Q,m+=(n=t[11])*L,y+=n*D,b+=n*U,w+=n*B,v+=n*$,k+=n*F,C+=n*q,_+=n*K,S+=n*z,A+=n*G,T+=n*H,E+=n*V,M+=n*W,P+=n*Y,N+=n*J,O+=n*Q,y+=(n=t[12])*L,b+=n*D,w+=n*U,v+=n*B,k+=n*$,C+=n*F,_+=n*q,S+=n*K,A+=n*z,T+=n*G,E+=n*H,M+=n*V,P+=n*W,N+=n*Y,O+=n*J,R+=n*Q,b+=(n=t[13])*L,w+=n*D,v+=n*U,k+=n*B,C+=n*$,_+=n*F,S+=n*q,A+=n*K,T+=n*z,E+=n*G,M+=n*H,P+=n*V,N+=n*W,O+=n*Y,R+=n*J,I+=n*Q,w+=(n=t[14])*L,v+=n*D,k+=n*U,C+=n*B,_+=n*$,S+=n*F,A+=n*q,T+=n*K,E+=n*z,M+=n*G,P+=n*H,N+=n*V,O+=n*W,R+=n*Y,I+=n*J,j+=n*Q,v+=(n=t[15])*L,i+=38*(C+=n*U),a+=38*(_+=n*B),c+=38*(S+=n*$),l+=38*(A+=n*F),u+=38*(T+=n*q),d+=38*(E+=n*K),h+=38*(M+=n*z),p+=38*(P+=n*G),f+=38*(N+=n*H),g+=38*(O+=n*V),m+=38*(R+=n*W),y+=38*(I+=n*Y),b+=38*(j+=n*J),w+=38*(x+=n*Q),o=(n=(o+=38*(k+=n*D))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),i=(n=i+s+65535)-65536*(s=Math.floor(n/65536)),a=(n=a+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),w=(n=w+s+65535)-65536*(s=Math.floor(n/65536)),v=(n=v+s+65535)-65536*(s=Math.floor(n/65536)),o=(n=(o+=s-1+37*(s-1))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),i=(n=i+s+65535)-65536*(s=Math.floor(n/65536)),a=(n=a+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),w=(n=w+s+65535)-65536*(s=Math.floor(n/65536)),v=(n=v+s+65535)-65536*(s=Math.floor(n/65536)),o+=s-1+37*(s-1),e[0]=o,e[1]=i,e[2]=a,e[3]=c,e[4]=l,e[5]=u,e[6]=d,e[7]=h,e[8]=p,e[9]=f,e[10]=g,e[11]=m,e[12]=y,e[13]=b,e[14]=w,e[15]=v}function $(e,t){B(e,t,t)}function F(e,t){var n,s=r();for(n=0;n<16;n++)s[n]=t[n];for(n=253;n>=0;n--)$(s,s),2!==n&&4!==n&&B(s,s,t);for(n=0;n<16;n++)e[n]=s[n]}function q(e,t){var n,s=r();for(n=0;n<16;n++)s[n]=t[n];for(n=250;n>=0;n--)$(s,s),1!==n&&B(s,s,t);for(n=0;n<16;n++)e[n]=s[n]}function K(e,t,n){var s,o,i=new Uint8Array(32),a=new Float64Array(80),l=r(),u=r(),d=r(),h=r(),p=r(),f=r();for(o=0;o<31;o++)i[o]=t[o];for(i[31]=127&t[31]|64,i[0]&=248,L(a,n),o=0;o<16;o++)u[o]=a[o],h[o]=l[o]=d[o]=0;for(l[0]=h[0]=1,o=254;o>=0;--o)R(l,u,s=i[o>>>3]>>>(7&o)&1),R(d,h,s),D(p,l,d),U(l,l,d),D(d,u,h),U(u,u,h),$(h,p),$(f,l),B(l,d,l),B(d,u,p),D(p,l,d),U(l,l,d),$(u,l),U(d,h,f),B(l,d,c),D(l,l,h),B(d,d,l),B(l,h,f),B(h,u,a),$(u,p),R(l,u,s),R(d,h,s);for(o=0;o<16;o++)a[o+16]=l[o],a[o+32]=d[o],a[o+48]=u[o],a[o+64]=h[o];var g=a.subarray(32),m=a.subarray(16);return F(g,g),B(m,m,g),I(e,m),0}function z(e,t){return K(e,t,o)}function G(e,t){return n(t,32),z(e,t)}function H(e,t,r){var n=new Uint8Array(32);return K(n,r,t),w(e,s,n,v)}A.prototype.blocks=function(e,t,r){for(var n,s,o,i,a,c,l,u,d,h,p,f,g,m,y,b,w,v,k,C=this.fin?0:2048,_=this.h[0],S=this.h[1],A=this.h[2],T=this.h[3],E=this.h[4],M=this.h[5],P=this.h[6],N=this.h[7],O=this.h[8],R=this.h[9],I=this.r[0],j=this.r[1],x=this.r[2],L=this.r[3],D=this.r[4],U=this.r[5],B=this.r[6],$=this.r[7],F=this.r[8],q=this.r[9];r>=16;)h=d=0,h+=(_+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*I,h+=(S+=8191&(n>>>13|(s=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*q),h+=(A+=8191&(s>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*F),h+=(T+=8191&(o>>>7|(i=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*$),d=(h+=(E+=8191&(i>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*B))>>>13,h&=8191,h+=(M+=a>>>1&8191)*(5*U),h+=(P+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),h+=(N+=8191&(c>>>11|(l=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*L),h+=(O+=8191&(l>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*x),p=d+=(h+=(R+=u>>>5|C)*(5*j))>>>13,p+=_*j,p+=S*I,p+=A*(5*q),p+=T*(5*F),d=(p+=E*(5*$))>>>13,p&=8191,p+=M*(5*B),p+=P*(5*U),p+=N*(5*D),p+=O*(5*L),d+=(p+=R*(5*x))>>>13,p&=8191,f=d,f+=_*x,f+=S*j,f+=A*I,f+=T*(5*q),d=(f+=E*(5*F))>>>13,f&=8191,f+=M*(5*$),f+=P*(5*B),f+=N*(5*U),f+=O*(5*D),g=d+=(f+=R*(5*L))>>>13,g+=_*L,g+=S*x,g+=A*j,g+=T*I,d=(g+=E*(5*q))>>>13,g&=8191,g+=M*(5*F),g+=P*(5*$),g+=N*(5*B),g+=O*(5*U),m=d+=(g+=R*(5*D))>>>13,m+=_*D,m+=S*L,m+=A*x,m+=T*j,d=(m+=E*I)>>>13,m&=8191,m+=M*(5*q),m+=P*(5*F),m+=N*(5*$),m+=O*(5*B),y=d+=(m+=R*(5*U))>>>13,y+=_*U,y+=S*D,y+=A*L,y+=T*x,d=(y+=E*j)>>>13,y&=8191,y+=M*I,y+=P*(5*q),y+=N*(5*F),y+=O*(5*$),b=d+=(y+=R*(5*B))>>>13,b+=_*B,b+=S*U,b+=A*D,b+=T*L,d=(b+=E*x)>>>13,b&=8191,b+=M*j,b+=P*I,b+=N*(5*q),b+=O*(5*F),w=d+=(b+=R*(5*$))>>>13,w+=_*$,w+=S*B,w+=A*U,w+=T*D,d=(w+=E*L)>>>13,w&=8191,w+=M*x,w+=P*j,w+=N*I,w+=O*(5*q),v=d+=(w+=R*(5*F))>>>13,v+=_*F,v+=S*$,v+=A*B,v+=T*U,d=(v+=E*D)>>>13,v&=8191,v+=M*L,v+=P*x,v+=N*j,v+=O*I,k=d+=(v+=R*(5*q))>>>13,k+=_*q,k+=S*F,k+=A*$,k+=T*B,d=(k+=E*U)>>>13,k&=8191,k+=M*D,k+=P*L,k+=N*x,k+=O*j,_=h=8191&(d=(d=((d+=(k+=R*I)>>>13)<<2)+d|0)+(h&=8191)|0),S=p+=d>>>=13,A=f&=8191,T=g&=8191,E=m&=8191,M=y&=8191,P=b&=8191,N=w&=8191,O=v&=8191,R=k&=8191,t+=16,r-=16;this.h[0]=_,this.h[1]=S,this.h[2]=A,this.h[3]=T,this.h[4]=E,this.h[5]=M,this.h[6]=P,this.h[7]=N,this.h[8]=O,this.h[9]=R},A.prototype.finish=function(e,t){var r,n,s,o,i=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=r,r=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,i[0]=this.h[0]+5,r=i[0]>>>13,i[0]&=8191,o=1;o<10;o++)i[o]=this.h[o]+r,r=i[o]>>>13,i[o]&=8191;for(i[9]-=8192,n=(1^r)-1,o=0;o<10;o++)i[o]&=n;for(n=~n,o=0;o<10;o++)this.h[o]=this.h[o]&n|i[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),s=this.h[0]+this.pad[0],this.h[0]=65535&s,o=1;o<8;o++)s=(this.h[o]+this.pad[o]|0)+(s>>>16)|0,this.h[o]=65535&s;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},A.prototype.update=function(e,t,r){var n,s;if(this.leftover){for((s=16-this.leftover)>r&&(s=r),n=0;n<s;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=s,t+=s,this.leftover+=s,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(s=r-r%16,this.blocks(e,t,s),t+=s,r-=s),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var V=M,W=P;var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function J(e,t,r,n){for(var s,o,i,a,c,l,u,d,h,p,f,g,m,y,b,w,v,k,C,_,S,A,T,E,M,P,N=new Int32Array(16),O=new Int32Array(16),R=e[0],I=e[1],j=e[2],x=e[3],L=e[4],D=e[5],U=e[6],B=e[7],$=t[0],F=t[1],q=t[2],K=t[3],z=t[4],G=t[5],H=t[6],V=t[7],W=0;n>=128;){for(C=0;C<16;C++)_=8*C+W,N[C]=r[_+0]<<24|r[_+1]<<16|r[_+2]<<8|r[_+3],O[C]=r[_+4]<<24|r[_+5]<<16|r[_+6]<<8|r[_+7];for(C=0;C<80;C++)if(s=R,o=I,i=j,a=x,c=L,l=D,u=U,B,h=$,p=F,f=q,g=K,m=z,y=G,b=H,V,T=65535&(A=V),E=A>>>16,M=65535&(S=B),P=S>>>16,T+=65535&(A=(z>>>14|L<<18)^(z>>>18|L<<14)^(L>>>9|z<<23)),E+=A>>>16,M+=65535&(S=(L>>>14|z<<18)^(L>>>18|z<<14)^(z>>>9|L<<23)),P+=S>>>16,T+=65535&(A=z&G^~z&H),E+=A>>>16,M+=65535&(S=L&D^~L&U),P+=S>>>16,S=Y[2*C],T+=65535&(A=Y[2*C+1]),E+=A>>>16,M+=65535&S,P+=S>>>16,S=N[C%16],E+=(A=O[C%16])>>>16,M+=65535&S,P+=S>>>16,M+=(E+=(T+=65535&A)>>>16)>>>16,T=65535&(A=k=65535&T|E<<16),E=A>>>16,M=65535&(S=v=65535&M|(P+=M>>>16)<<16),P=S>>>16,T+=65535&(A=($>>>28|R<<4)^(R>>>2|$<<30)^(R>>>7|$<<25)),E+=A>>>16,M+=65535&(S=(R>>>28|$<<4)^($>>>2|R<<30)^($>>>7|R<<25)),P+=S>>>16,E+=(A=$&F^$&q^F&q)>>>16,M+=65535&(S=R&I^R&j^I&j),P+=S>>>16,d=65535&(M+=(E+=(T+=65535&A)>>>16)>>>16)|(P+=M>>>16)<<16,w=65535&T|E<<16,T=65535&(A=g),E=A>>>16,M=65535&(S=a),P=S>>>16,E+=(A=k)>>>16,M+=65535&(S=v),P+=S>>>16,I=s,j=o,x=i,L=a=65535&(M+=(E+=(T+=65535&A)>>>16)>>>16)|(P+=M>>>16)<<16,D=c,U=l,B=u,R=d,F=h,q=p,K=f,z=g=65535&T|E<<16,G=m,H=y,V=b,$=w,C%16==15)for(_=0;_<16;_++)S=N[_],T=65535&(A=O[_]),E=A>>>16,M=65535&S,P=S>>>16,S=N[(_+9)%16],T+=65535&(A=O[(_+9)%16]),E+=A>>>16,M+=65535&S,P+=S>>>16,v=N[(_+1)%16],T+=65535&(A=((k=O[(_+1)%16])>>>1|v<<31)^(k>>>8|v<<24)^(k>>>7|v<<25)),E+=A>>>16,M+=65535&(S=(v>>>1|k<<31)^(v>>>8|k<<24)^v>>>7),P+=S>>>16,v=N[(_+14)%16],E+=(A=((k=O[(_+14)%16])>>>19|v<<13)^(v>>>29|k<<3)^(k>>>6|v<<26))>>>16,M+=65535&(S=(v>>>19|k<<13)^(k>>>29|v<<3)^v>>>6),P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,N[_]=65535&M|P<<16,O[_]=65535&T|E<<16;T=65535&(A=$),E=A>>>16,M=65535&(S=R),P=S>>>16,S=e[0],E+=(A=t[0])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[0]=R=65535&M|P<<16,t[0]=$=65535&T|E<<16,T=65535&(A=F),E=A>>>16,M=65535&(S=I),P=S>>>16,S=e[1],E+=(A=t[1])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[1]=I=65535&M|P<<16,t[1]=F=65535&T|E<<16,T=65535&(A=q),E=A>>>16,M=65535&(S=j),P=S>>>16,S=e[2],E+=(A=t[2])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[2]=j=65535&M|P<<16,t[2]=q=65535&T|E<<16,T=65535&(A=K),E=A>>>16,M=65535&(S=x),P=S>>>16,S=e[3],E+=(A=t[3])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[3]=x=65535&M|P<<16,t[3]=K=65535&T|E<<16,T=65535&(A=z),E=A>>>16,M=65535&(S=L),P=S>>>16,S=e[4],E+=(A=t[4])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[4]=L=65535&M|P<<16,t[4]=z=65535&T|E<<16,T=65535&(A=G),E=A>>>16,M=65535&(S=D),P=S>>>16,S=e[5],E+=(A=t[5])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[5]=D=65535&M|P<<16,t[5]=G=65535&T|E<<16,T=65535&(A=H),E=A>>>16,M=65535&(S=U),P=S>>>16,S=e[6],E+=(A=t[6])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[6]=U=65535&M|P<<16,t[6]=H=65535&T|E<<16,T=65535&(A=V),E=A>>>16,M=65535&(S=B),P=S>>>16,S=e[7],E+=(A=t[7])>>>16,M+=65535&S,P+=S>>>16,P+=(M+=(E+=(T+=65535&A)>>>16)>>>16)>>>16,e[7]=B=65535&M|P<<16,t[7]=V=65535&T|E<<16,W+=128,n-=128}return n}function Q(e,t,r){var n,s=new Int32Array(8),o=new Int32Array(8),i=new Uint8Array(256),a=r;for(s[0]=1779033703,s[1]=3144134277,s[2]=1013904242,s[3]=2773480762,s[4]=1359893119,s[5]=2600822924,s[6]=528734635,s[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,J(s,o,t,r),r%=128,n=0;n<r;n++)i[n]=t[a-r+n];for(i[r]=128,i[(r=256-128*(r<112?1:0))-9]=0,f(i,r-8,a/536870912|0,a<<3),J(s,o,i,r),n=0;n<8;n++)f(e,8*n,s[n],o[n]);return 0}function Z(e,t){var n=r(),s=r(),o=r(),i=r(),a=r(),c=r(),l=r(),d=r(),h=r();U(n,e[1],e[0]),U(h,t[1],t[0]),B(n,n,h),D(s,e[0],e[1]),D(h,t[0],t[1]),B(s,s,h),B(o,e[3],t[3]),B(o,o,u),B(i,e[2],t[2]),D(i,i,i),U(a,s,n),U(c,i,o),D(l,i,o),D(d,s,n),B(e[0],a,c),B(e[1],d,l),B(e[2],l,c),B(e[3],a,d)}function X(e,t,r){var n;for(n=0;n<4;n++)R(e[n],t[n],r)}function ee(e,t){var n=r(),s=r(),o=r();F(o,t[2]),B(n,t[0],o),B(s,t[1],o),I(e,s),e[31]^=x(n)<<7}function te(e,t,r){var n,s;for(N(e[0],i),N(e[1],a),N(e[2],a),N(e[3],i),s=255;s>=0;--s)X(e,t,n=r[s/8|0]>>(7&s)&1),Z(t,e),Z(e,e),X(e,t,n)}function re(e,t){var n=[r(),r(),r(),r()];N(n[0],d),N(n[1],h),N(n[2],a),B(n[3],d,h),te(e,n,t)}function ne(e,t,s){var o,i=new Uint8Array(64),a=[r(),r(),r(),r()];for(s||n(t,32),Q(i,t,32),i[0]&=248,i[31]&=127,i[31]|=64,re(a,i),ee(e,a),o=0;o<32;o++)t[o+32]=e[o];return 0}var se=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function oe(e,t){var r,n,s,o;for(n=63;n>=32;--n){for(r=0,s=n-32,o=n-12;s<o;++s)t[s]+=r-16*t[n]*se[s-(n-32)],r=Math.floor((t[s]+128)/256),t[s]-=256*r;t[s]+=r,t[n]=0}for(r=0,s=0;s<32;s++)t[s]+=r-(t[31]>>4)*se[s],r=t[s]>>8,t[s]&=255;for(s=0;s<32;s++)t[s]-=r*se[s];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function ie(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;oe(e,r)}function ae(e,t,n,s){var o,i,a=new Uint8Array(64),c=new Uint8Array(64),l=new Uint8Array(64),u=new Float64Array(64),d=[r(),r(),r(),r()];Q(a,s,32),a[0]&=248,a[31]&=127,a[31]|=64;var h=n+64;for(o=0;o<n;o++)e[64+o]=t[o];for(o=0;o<32;o++)e[32+o]=a[32+o];for(Q(l,e.subarray(32),n+32),ie(l),re(d,l),ee(e,d),o=32;o<64;o++)e[o]=s[o];for(Q(c,e,n+64),ie(c),o=0;o<64;o++)u[o]=0;for(o=0;o<32;o++)u[o]=l[o];for(o=0;o<32;o++)for(i=0;i<32;i++)u[o+i]+=c[o]*a[i];return oe(e.subarray(32),u),h}function ce(e,t,n,s){var o,c=new Uint8Array(32),u=new Uint8Array(64),d=[r(),r(),r(),r()],h=[r(),r(),r(),r()];if(n<64)return-1;if(function(e,t){var n=r(),s=r(),o=r(),c=r(),u=r(),d=r(),h=r();return N(e[2],a),L(e[1],t),$(o,e[1]),B(c,o,l),U(o,o,e[2]),D(c,e[2],c),$(u,c),$(d,u),B(h,d,u),B(n,h,o),B(n,n,c),q(n,n),B(n,n,o),B(n,n,c),B(n,n,c),B(e[0],n,c),$(s,e[0]),B(s,s,c),j(s,o)&&B(e[0],e[0],p),$(s,e[0]),B(s,s,c),j(s,o)?-1:(x(e[0])===t[31]>>7&&U(e[0],i,e[0]),B(e[3],e[0],e[1]),0)}(h,s))return-1;for(o=0;o<n;o++)e[o]=t[o];for(o=0;o<32;o++)e[o+32]=s[o];if(Q(u,e,n),ie(u),te(d,h,u),re(h,t.subarray(32)),Z(d,h),ee(c,d),n-=64,y(t,0,c,0)){for(o=0;o<n;o++)e[o]=0;return-1}for(o=0;o<n;o++)e[o]=t[o+64];return n}var le=16,ue=64,de=32,he=64;function pe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function fe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ge(e){for(var t=0;t<e.length;t++)e[t]=0}t.lowlevel={crypto_core_hsalsa20:w,crypto_stream_xor:S,crypto_stream:_,crypto_stream_salsa20_xor:k,crypto_stream_salsa20:C,crypto_onetimeauth:T,crypto_onetimeauth_verify:E,crypto_verify_16:m,crypto_verify_32:y,crypto_secretbox:M,crypto_secretbox_open:P,crypto_scalarmult:K,crypto_scalarmult_base:z,crypto_box_beforenm:H,crypto_box_afternm:V,crypto_box:function(e,t,r,n,s,o){var i=new Uint8Array(32);return H(i,s,o),V(e,t,r,n,i)},crypto_box_open:function(e,t,r,n,s,o){var i=new Uint8Array(32);return H(i,s,o),W(e,t,r,n,i)},crypto_box_keypair:G,crypto_hash:Q,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:le,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ue,crypto_sign_PUBLICKEYBYTES:de,crypto_sign_SECRETKEYBYTES:he,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:r,D:l,L:se,pack25519:I,unpack25519:L,M:B,A:D,S:$,Z:U,pow2523:q,add:Z,set25519:N,modL:oe,scalarmult:te,scalarbase:re},t.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},t.secretbox=function(e,t,r){fe(e,t,r),pe(r,t);for(var n=new Uint8Array(32+e.length),s=new Uint8Array(n.length),o=0;o<e.length;o++)n[o+32]=e[o];return M(s,n,n.length,t,r),s.subarray(le)},t.secretbox.open=function(e,t,r){fe(e,t,r),pe(r,t);for(var n=new Uint8Array(le+e.length),s=new Uint8Array(n.length),o=0;o<e.length;o++)n[o+le]=e[o];return n.length<32||0!==P(s,n,n.length,t,r)?null:s.subarray(32)},t.secretbox.keyLength=32,t.secretbox.nonceLength=24,t.secretbox.overheadLength=le,t.scalarMult=function(e,t){if(fe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return K(r,e,t),r},t.scalarMult.base=function(e){if(fe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return z(t,e),t},t.scalarMult.scalarLength=32,t.scalarMult.groupElementLength=32,t.box=function(e,r,n,s){var o=t.box.before(n,s);return t.secretbox(e,r,o)},t.box.before=function(e,t){fe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return H(r,e,t),r},t.box.after=t.secretbox,t.box.open=function(e,r,n,s){var o=t.box.before(n,s);return t.secretbox.open(e,r,o)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return G(e,t),{publicKey:e,secretKey:t}},t.box.keyPair.fromSecretKey=function(e){if(fe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return z(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},t.box.publicKeyLength=32,t.box.secretKeyLength=32,t.box.sharedKeyLength=32,t.box.nonceLength=24,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(e,t){if(fe(e,t),t.length!==he)throw new Error("bad secret key size");var r=new Uint8Array(ue+e.length);return ae(r,e,e.length,t),r},t.sign.open=function(e,t){if(fe(e,t),t.length!==de)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var s=new Uint8Array(n),o=0;o<s.length;o++)s[o]=r[o];return s},t.sign.detached=function(e,r){for(var n=t.sign(e,r),s=new Uint8Array(ue),o=0;o<s.length;o++)s[o]=n[o];return s},t.sign.detached.verify=function(e,t,r){if(fe(e,t,r),t.length!==ue)throw new Error("bad signature size");if(r.length!==de)throw new Error("bad public key size");var n,s=new Uint8Array(ue+e.length),o=new Uint8Array(ue+e.length);for(n=0;n<ue;n++)s[n]=t[n];for(n=0;n<e.length;n++)s[n+ue]=e[n];return ce(o,s,s.length,r)>=0},t.sign.keyPair=function(){var e=new Uint8Array(de),t=new Uint8Array(he);return ne(e,t),{publicKey:e,secretKey:t}},t.sign.keyPair.fromSecretKey=function(e){if(fe(e),e.length!==he)throw new Error("bad secret key size");for(var t=new Uint8Array(de),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},t.sign.keyPair.fromSeed=function(e){if(fe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(de),r=new Uint8Array(he),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},t.sign.publicKeyLength=de,t.sign.secretKeyLength=he,t.sign.seedLength=32,t.sign.signatureLength=ue,t.hash=function(e){fe(e);var t=new Uint8Array(64);return Q(t,e,e.length),t},t.hash.hashLength=64,t.verify=function(e,t){return fe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===g(e,0,t,0,e.length))},t.setPRNG=function(e){n=e},function(){var r="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){t.setPRNG((function(e,t){var n,s=new Uint8Array(t);for(n=0;n<t;n+=65536)r.getRandomValues(s.subarray(n,n+Math.min(t-n,65536)));for(n=0;n<t;n++)e[n]=s[n];ge(s)}))}else void 0!==e&&(r=e("crypto"))&&r.randomBytes&&t.setPRNG((function(e,t){var n,s=r.randomBytes(t);for(n=0;n<t;n++)e[n]=s[n];ge(s)}))}()}(void 0!==t&&t.exports?t.exports:self.nacl=self.nacl||{})}}},{package:"eth-sig-util>tweetnacl",file:"node_modules/tweetnacl/nacl-fast.js"}],[4569,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/concat.js"}],[4570,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/equals.js"}],[4571,{multibase:4033},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),s=new TextEncoder;t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.encode(e):"ascii"===t?function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e):n(t).decode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/from-string.js"}],[4572,{multibase:4033},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),s=new TextDecoder("utf8");t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?s.decode(e):"ascii"===t?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):n(t).encode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays",file:"node_modules/uint8arrays/to-string.js"}],[46,{loglevel:3987,"webextension-polyfill":4649},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({location:e,registerOnboarding:t}){return async function(r,o,i,a){try{if("wallet_registerOnboarding"!==r.method)return void i();r.tabId&&r.tabId!==s.default.tabs.TAB_ID_NONE?await t(e,r.tabId):n.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),o.result=!0,a()}catch(e){a(e)}}};var n=o(e("loglevel")),s=o(e("webextension-polyfill"));function o(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$",file:"app/scripts/lib/createOnboardingMiddleware.js"}],[4641,{util:4610},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){r.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:e("util").TextEncoder,r.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:e("util").TextDecoder}}},{package:"@ensdomains/content-hash>multihashes>web-encoding",file:"node_modules/web-encoding/src/lib.js"}],[4663,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM=r.AUTO_LOCK_TIMEOUT_ALARM=void 0;r.AUTO_LOCK_TIMEOUT_ALARM="AUTO_LOCK_TIMEOUT_ALARM",r.METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM="METAMETRICS_FINALIZE_EVENT_FRAGMENT_ALARM"}}},{package:"$root$",file:"shared/constants/alarms.js"}],[4672,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LOG_EVENT=void 0;r.LOG_EVENT={VERSION_UPDATE:"Extension version update"}}}},{package:"$root$",file:"shared/constants/logs.ts"}],[4678,{"./time":4684},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=void 0;var n=e("./time");r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=10*n.SECOND,r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=180,r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=2}}},{package:"$root$",file:"shared/constants/smartTransactions.js"}],[4683,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ACTION_QUEUE_METRICS_E2E_TEST=void 0;r.ACTION_QUEUE_METRICS_E2E_TEST="action_queue_metrics_e2e_test"}}},{package:"$root$",file:"shared/constants/test-flags.js"}],[47,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){t.origin=e.origin,n()}}}}},{package:"$root$",file:"app/scripts/lib/createOriginMiddleware.js"}],[48,{"../../../shared/constants/app":4665,"../../../shared/constants/metametrics":4673,"../../../shared/constants/security-provider":4677,"../../../shared/constants/time":4684,"../../../shared/constants/transaction":4686,"./snap-keyring/metrics":86,"@metamask/controller-utils":1144,"eth-rpc-errors":3132,"ethereumjs-util":3178},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({trackEvent:e,getMetricsState:t,rateLimitSeconds:r=300,securityProviderRequest:n,getSelectedAddress:y,getAccountType:b,getDeviceModel:w,snapAndHardwareMessenger:v}){return async function(k,C,_){const{origin:S,method:A}=k,T=f[A]??p.RATE_LIMITED,E=T===p.RATE_LIMITED&&void 0!==m[A],M=!0===t().participateInMetaMetrics,P=g[A],N={},O=S!==a.ORIGIN_METAMASK&&T!==p.BLOCKED&&!1===E&&!0===M;if(O){const t=P?P.REQUESTED:c.MetaMetricsEventName.ProviderMethodCalled;if(t===c.MetaMetricsEventName.SignatureRequested){var R,I,j,x;let e,t;var L,D,U,B;if(N.signature_type=A,(0,i.isValidAddress)(null==k||null===(R=k.params)||void 0===R?void 0:R[1]))e=null==k||null===(L=k.params)||void 0===L?void 0:L[0],t=null==k||null===(D=k.params)||void 0===D?void 0:D[1];else e=null==k||null===(U=k.params)||void 0===U?void 0:U[1],t=null==k||null===(B=k.params)||void 0===B?void 0:B[0];const r=null==k||null===(I=k.params)||void 0===I?void 0:I[2];N.security_alert_response=(null===(j=k.securityAlertResponse)||void 0===j?void 0:j.result_type)??d.BlockaidResultType.NotApplicable,N.security_alert_reason=(null===(x=k.securityAlertResponse)||void 0===x?void 0:x.reason)??d.BlockaidReason.notApplicable;const o=await(0,h.default)(y,b,w,v);Object.assign(N,o);const l={msgParams:{...r,from:t,data:e,origin:S},status:u.TransactionStatus.unapproved,type:k.method};try{const t=await n(l,k.method);if(1===(null==t?void 0:t.flagAsDangerous)?N.ui_customizations=[c.MetaMetricsEventUiCustomization.FlaggedAsMalicious]:2===(null==t?void 0:t.flagAsDangerous)&&(N.ui_customizations=[c.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown]),A===a.MESSAGE_TYPE.PERSONAL_SIGN){const{isSIWEMessage:t}=(0,s.detectSIWE)({data:e});t&&(N.ui_customizations=(N.ui_customizations||[]).concat(c.MetaMetricsEventUiCustomization.Siwe))}}catch(e){console.warn(`createRPCMethodTrackingMiddleware: Error calling securityProviderRequest - ${e}`)}}else N.method=A;e({event:t,category:c.MetaMetricsEventCategory.InpageProvider,referrer:{url:S},properties:N}),m[A]=setTimeout((()=>{delete m[A]}),l.SECOND*r)}_((async t=>{var r,n,s,i;if(!1===O||void 0===P)return t();let l;return A===a.MESSAGE_TYPE.ETH_SIGN&&(null===(r=C.error)||void 0===r?void 0:r.code)===o.errorCodes.rpc.methodNotFound?(l=P.FAILED,N.error=C.error):(null===(n=C.error)||void 0===n?void 0:n.code)===o.errorCodes.provider.userRejectedRequest?l=P.REJECTED:(null===(s=C.error)||void 0===s?void 0:s.code)===o.errorCodes.rpc.internal&&"Request rejected by user or snap."===(null===(i=C.error)||void 0===i?void 0:i.message)?(l=P.REJECTED,N.status=C.error.message):l=P.APPROVED,e({event:l,category:c.MetaMetricsEventCategory.InpageProvider,referrer:{url:S},properties:N}),t()}))}};var n,s=e("@metamask/controller-utils"),o=e("eth-rpc-errors"),i=e("ethereumjs-util"),a=e("../../../shared/constants/app"),c=e("../../../shared/constants/metametrics"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/transaction"),d=e("../../../shared/constants/security-provider"),h=(n=e("./snap-keyring/metrics"))&&n.__esModule?n:{default:n};const p={RATE_LIMITED:"rate_limited",BLOCKED:"blocked",NON_RATE_LIMITED:"non_rate_limited"},f={[a.MESSAGE_TYPE.ETH_SIGN]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.PERSONAL_SIGN]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_DECRYPT]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:p.NON_RATE_LIMITED,[a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:p.RATE_LIMITED,[a.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:p.RATE_LIMITED,[a.MESSAGE_TYPE.SEND_METADATA]:p.BLOCKED,[a.MESSAGE_TYPE.GET_PROVIDER_STATE]:p.BLOCKED},g={[a.MESSAGE_TYPE.ETH_SIGN]:{APPROVED:c.MetaMetricsEventName.SignatureApproved,FAILED:c.MetaMetricsEventName.SignatureFailed,REJECTED:c.MetaMetricsEventName.SignatureRejected,REQUESTED:c.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:c.MetaMetricsEventName.SignatureApproved,REJECTED:c.MetaMetricsEventName.SignatureRejected,REQUESTED:c.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:c.MetaMetricsEventName.SignatureApproved,REJECTED:c.MetaMetricsEventName.SignatureRejected,REQUESTED:c.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:c.MetaMetricsEventName.SignatureApproved,REJECTED:c.MetaMetricsEventName.SignatureRejected,REQUESTED:c.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:c.MetaMetricsEventName.SignatureApproved,REJECTED:c.MetaMetricsEventName.SignatureRejected,REQUESTED:c.MetaMetricsEventName.SignatureRequested},[a.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:c.MetaMetricsEventName.DecryptionApproved,REJECTED:c.MetaMetricsEventName.DecryptionRejected,REQUESTED:c.MetaMetricsEventName.DecryptionRequested},[a.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:c.MetaMetricsEventName.EncryptionPublicKeyApproved,REJECTED:c.MetaMetricsEventName.EncryptionPublicKeyRejected,REQUESTED:c.MetaMetricsEventName.EncryptionPublicKeyRequested},[a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:c.MetaMetricsEventName.PermissionsApproved,REJECTED:c.MetaMetricsEventName.PermissionsRejected,REQUESTED:c.MetaMetricsEventName.PermissionsRequested},[a.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:c.MetaMetricsEventName.PermissionsApproved,REJECTED:c.MetaMetricsEventName.PermissionsRejected,REQUESTED:c.MetaMetricsEventName.PermissionsRequested}},m={}}}},{package:"$root$",file:"app/scripts/lib/createRPCMethodTrackingMiddleware.js"}],[49,{"promise-to-callback":4119,"readable-stream":4389},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return new i(e,t)};var n,s=e("readable-stream"),o=(n=e("promise-to-callback"))&&n.__esModule?n:{default:n};class i extends s.Writable{constructor(e,t){super({objectMode:!0,...t}),this._asyncWriteFn=e}_write(e,t,r){(0,o.default)(this._asyncWriteFn(e,t))(r)}}}}},{package:"$root$",file:"app/scripts/lib/createStreamSink.js"}],[5,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA=r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON=r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM=r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI=r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM=r.SINGLE_CALL_BALANCES_ADDRESS_BSC=r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE=r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39",r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI="0x9788C4E93f9002a7ad8e72633b11E8d1ecd51f9b",r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA="",r.SINGLE_CALL_BALANCES_ADDRESS_BSC="0x2352c63A83f9Fd126af8676146721Fa00924d7e4",r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM="0xB1c568e9C3E6bdaf755A60c7418C269eb11524FC",r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON="0x2352c63A83f9Fd126af8676146721Fa00924d7e4",r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE="0xD023D153a0DFa485130ECFdE2FAA7e612EF94818",r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM="0x07f697424ABe762bB808c109860c04eA488ff92B",r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM="0x151E24A486D7258dd7C33Fb67E4bB01919B7B32c"}}},{package:"$root$",file:"app/scripts/constants/contracts.ts"}],[50,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){t.tabId=e.tabId,n()}}}}},{package:"$root$",file:"app/scripts/lib/createTabIdMiddleware.js"}],[51,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/registry.js"}],[52,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[53,{"./contracts/registry":51,"./contracts/resolver":52,"@ensdomains/content-hash":324,"@metamask/ethjs-query":1393,"eth-ens-namehash":3088,"ethjs-contract":3221},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=async function({provider:e,name:t}){const r=new s.default(e),l=n.default.hash(t),d=new o.default(r),h=Number.parseInt(await r.net_version(),10),p=function(e){switch(e){case 1:case 3:case 4:case 5:case 6:return"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";default:return null}}(h);if(!p)throw new Error(`EnsIpfsResolver - no known ens-ipfs registry for chainId "${h}"`);const f=d(a.default).at(p),g=(await f.resolver(l))[0];if(u(g))throw new Error(`EnsIpfsResolver - no resolver found for name "${t}"`);const m=d(c.default).at(g),y=await m.supportsInterface("0xbc1c58d1"),b=await m.supportsInterface("0xd8389dc5");if(y[0]){const e=(await m.contenthash(l))[0];let t=i.default.decode(e);const r=i.default.getCodec(e);return"ipfs-ns"!==r&&"ipns-ns"!==r||(t=i.default.helpers.cidV0ToV1Base32(t)),{type:r,hash:t}}if(b[0]){const e=(await m.content(l))[0];if(u(e))throw new Error(`EnsIpfsResolver - no content ID found for name "${t}"`);return{type:"swarm-ns",hash:e.slice(2)}}throw new Error(`EnsIpfsResolver - the resolver for name "${t}" is not standard, it should either supports contenthash() or content()`)};var n=l(e("eth-ens-namehash")),s=l(e("@metamask/ethjs-query")),o=l(e("ethjs-contract")),i=l(e("@ensdomains/content-hash")),a=l(e("./contracts/registry")),c=l(e("./contracts/resolver"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return[undefined,null,"0x","0x0","0x0000000000000000000000000000000000000000000000000000000000000000"].includes(e)}}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/resolver.js"}],[54,{"../../../../shared/modules/fetch-with-timeout":4702,"./resolver":53,"base32-encode":2688,"base64-js":2689,"webextension-polyfill":4649},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({provider:e,getCurrentChainId:t,getIpfsGateway:r,getUseAddressBarEnsResolution:i}){const c=u.map((e=>`*://*.${e}/*`));return o.default.webRequest.onErrorOccurred.addListener(d,{urls:c,types:["main_frame"]}),{remove(){o.default.webRequest.onErrorOccurred.removeListener(d)}};async function d(c){const{tabId:d,url:h}=c;if(-1===d||"0x1"!==t())return;const{hostname:p,pathname:f,search:g,hash:m}=new URL(h),y=p.split("."),b=y[y.length-1];u.includes(b)&&async function({tabId:t,name:c,pathname:u,search:d,fragment:h}){const p=r(),f=i(),g=`https://app.ens.domains/name/${c}`;f&&p&&o.default.tabs.update(t,{url:"loading.html"});let m=g;0;try{const{type:t,hash:r}=await(0,a.default)({provider:e,name:c});if("ipfs-ns"===t||"ipns-ns"===t){if(""===p)return void(m=null);const e=`https://${r}.${t.slice(0,4)}.${p}${u}${d||""}${h||""}`;try{200===(await l(e,{method:"HEAD"})).status&&(m=e)}catch(e){console.warn(e)}}else if("swarm-ns"===t)m=`https://swarm-gateways.net/bzz:/${r}${u}${d||""}${h||""}`;else if("onion"===t||"onion3"===t)m=`http://${r}.onion${u}${d||""}${h||""}`;else if("zeronet"===t)m=`http://127.0.0.1:43110/${r}${u}${d||""}${h||""}`;else if("skynet-ns"===t){const e=r.padEnd(r.length+4-r.length%4,"="),t=s.default.toByteArray(e),o={padding:!1};m=`https://${(0,n.default)(t,"RFC4648-HEX",o).toLowerCase()}.siasky.net${u}${d||""}${h||""}`}}catch(e){console.warn(e)}finally{m&&(f||!f&&m!==g)&&o.default.tabs.update(t,{url:m})}}({tabId:d,name:p,pathname:f,search:g,fragment:m})}};var n=c(e("base32-encode")),s=c(e("base64-js")),o=c(e("webextension-polyfill")),i=c(e("../../../../shared/modules/fetch-with-timeout")),a=c(e("./resolver"));function c(e){return e&&e.__esModule?e:{default:e}}const l=(0,i.default)(),u=["eth"]}}},{package:"$root$",file:"app/scripts/lib/ens-ipfs/setup.js"}],[541,{"@ethereumjs/tx":395,"@ethereumjs/util":407,"@keystonehq/bc-ur-registry-eth":547,buffer:2818,hdkey:3726,rlp:544,uuid:4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s=n(e("hdkey")),o=e("@ethereumjs/util"),i=n(e("rlp")),a=e("@ethereumjs/tx"),c=e("@keystonehq/bc-ur-registry-eth"),l=e("uuid");const u="QR Hardware Wallet Device",d="m",h="0/*";var p,f;!function(e){e.hd="hd",e.pubkey="pubkey"}(p||(p={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(f||(f={}));class g{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type=u,this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),o=s.getRequestId(),i=s.getSignature();if(o){if(l.stringify(o)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId")}return{r:i.slice(0,32),s:i.slice(32,64),v:i.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n=`m/${e.getOrigin().getPath()}`,s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),o=(null==(r=e.getChildren())?void 0:r.getPath())||h,i=e.getName();if(e.getNote()===f.standard?this.keyringAccount=f.standard:e.getNote()===f.ledger_legacy&&(this.keyringAccount=f.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const a=e.getBip32Key();this.xfp=s,this.xpub=a,this.hdPath=n,this.childrenPath=o,i!==undefined&&""!==i&&(this.name=i),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const i=e.getOutputDescriptors();if(!i||0===i.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(i.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r=`M/${t.getOrigin().getPath()}`,n="0x"+o.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===f.ledger_live&&(this.keyringAccount=f.ledger_live),this.paths[o.toChecksumAddress(n)]===undefined&&(s=!0),this.paths[o.toChecksumAddress(n)]=r}}catch(e){throw new Error(`KeystoneError#invalid_data: ${e}`)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push({address:t,balance:null,index:e}),this.indexes[o.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===p.hd){this.checkKeyring(),this.hdk||(this.hdk=s.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),i="0x"+o.publicToAddress(n.publicKey,!0).toString("hex");return o.toChecksumAddress(i)}{const e=Object.keys(this.paths)[t];if(e)return o.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=p.hd,this.keyringAccount=f.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath=h,this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===c.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=p.hd,this.__readCryptoHDKey(e)):(this.keyringMode=p.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||p.hd,this.keyringAccount=e.keyringAccount||f.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||h)}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex(d,e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===p.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?c.DataType.transaction:c.DataType.typedTransaction;let s;s=0===r.type?t.from(i.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const o=await this._pathFromAddress(e),u=Number(r.common.chainId()),d=l.v4(),h=c.EthSignRequest.constructETHRequest(s,n,o,this.xfp,d,u),{r:p,s:f,v:g}=await this.requestSignature(d,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return a.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:p,s:f,v:g},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=o.stripHexPrefix(r),s=await this._pathFromAddress(e),i=l.v4(),a=c.EthSignRequest.constructETHRequest(t.from(n,"hex"),c.DataType.personalMessage,s,this.xfp,i,undefined,e),{r:u,s:d,v:h}=await this.requestSignature(i,a,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([u,d,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=l.v4(),o=c.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),c.DataType.typedData,n,this.xfp,s,undefined,e),{r:i,s:a,v:u}=await this.requestSignature(s,o,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([i,a,u]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===p.hd){const t=o.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex(d,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=o.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}g.type=u,r.BaseKeyring=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.development.js"}],[542,{"@ethereumjs/tx":395,"@ethereumjs/util":407,"@keystonehq/bc-ur-registry-eth":547,buffer:2818,hdkey:3726,rlp:544,uuid:4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(r,"__esModule",{value:!0});var s,o,i=n(e("hdkey")),a=e("@ethereumjs/util"),c=n(e("rlp")),l=e("@ethereumjs/tx"),u=e("@keystonehq/bc-ur-registry-eth"),d=e("uuid");!function(e){e.hd="hd",e.pubkey="pubkey"}(s||(s={})),function(e){e.standard="account.standard",e.ledger_live="account.ledger_live",e.ledger_legacy="account.ledger_legacy"}(o||(o={}));class h{constructor(e){this.version=1,this.getInteraction=()=>{throw new Error("KeystoneError#invalid_extends: method getInteraction not implemented, please extend BaseKeyring by overwriting this method.")},this.type="QR Hardware Wallet Device",this.requestSignature=async(e,t,r,n)=>{const s=await this.getInteraction().requestSignature(t,r,n),o=s.getRequestId(),i=s.getSignature();if(o&&d.stringify(o)!==e)throw new Error("KeystoneError#invalid_data: read signature error: mismatched requestId");return{r:i.slice(0,32),s:i.slice(32,64),v:i.slice(64)}},this.__readCryptoHDKey=e=>{var t,r;const n="m/"+e.getOrigin().getPath(),s=null==(t=e.getOrigin().getSourceFingerprint())?void 0:t.toString("hex"),i=(null==(r=e.getChildren())?void 0:r.getPath())||"0/*",a=e.getName();if(e.getNote()===o.standard?this.keyringAccount=o.standard:e.getNote()===o.ledger_legacy&&(this.keyringAccount=o.ledger_legacy),!s)throw new Error("KeystoneError#invalid_data: invalid crypto-hdkey, cannot get source fingerprint");const c=e.getBip32Key();this.xfp=s,this.xpub=c,this.hdPath=n,this.childrenPath=i,void 0!==a&&""!==a&&(this.name=a),this.initialized=!0},this.__readCryptoAccount=e=>{var t,r;const n=null==(t=e.getMasterFingerprint())?void 0:t.toString("hex");if(!n)throw new Error("KeystoneError#invalid_data: invalid crypto-account, cannot get master fingerprint");this.xfp=n,this.initialized=!0;let s=!1;const i=e.getOutputDescriptors();if(!i||0===i.length)throw new Error("KeystoneError#invalid_data: invalid crypto-account, no crypto output found");if(i.length%5!=0)throw new Error("KeystoneError#invalid_data: only support 5x pubkey accounts for now");return null==(r=e.getOutputDescriptors())||r.forEach((e=>{try{const t=e.getHDKey();if(t){const e=t.getKey(),r="M/"+t.getOrigin().getPath(),n="0x"+a.publicToAddress(e,!0).toString("hex");this.name=t.getName(),t.getNote()===o.ledger_live&&(this.keyringAccount=o.ledger_live),void 0===this.paths[a.toChecksumAddress(n)]&&(s=!0),this.paths[a.toChecksumAddress(n)]=r}}catch(e){throw new Error("KeystoneError#invalid_data: "+e)}})),s},this.getName=()=>this.name,this.setAccountToUnlock=e=>{this.unlockedAccount=parseInt(e,10)},this.__getNormalPage=async e=>{this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e}),this.indexes[a.toChecksumAddress(t)]=e}return n},this.__getLedgerLivePage=async e=>{const t=(this.page+e-1)*this.perPage,r=t+this.perPage,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push({address:t,balance:null,index:e})}return this.page+=e,n},this.__addressFromIndex=async(e,t)=>{if(this.keyringMode===s.hd){this.checkKeyring(),this.hdk||(this.hdk=i.fromExtendedKey(this.xpub));const r=this.childrenPath.replace("*",String(t)).replace(/\*/g,"0"),n=this.hdk.derive(`${e}/${r}`),s="0x"+a.publicToAddress(n.publicKey,!0).toString("hex");return a.toChecksumAddress(s)}{const e=Object.keys(this.paths)[t];if(e)return a.toChecksumAddress(e);throw new Error("KeystoneError#pubkey_account.no_expected_account")}},this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.unlockedAccount=0,this.name="QR Hardware",this.keyringMode=s.hd,this.keyringAccount=o.standard,this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.childrenPath="0/*",this.indexes={},this.paths={},this.deserialize(e)}async readKeyring(){const e=await this.getInteraction().readCryptoHDKeyOrCryptoAccount();this.syncKeyring(e)}syncKeyring(e){e.getRegistryType().getType()===u.extend.RegistryTypes.CRYPTO_HDKEY.getType()?(this.keyringMode=s.hd,this.__readCryptoHDKey(e)):(this.keyringMode=s.pubkey,this.__readCryptoAccount(e))}checkKeyring(){if(!this.xfp||!this.xpub||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}serialize(){return Promise.resolve({initialized:this.initialized,accounts:this.accounts,currentAccount:this.currentAccount,page:this.page,perPage:this.perPage,keyringAccount:this.keyringAccount,keyringMode:this.keyringMode,name:this.name,version:this.version,xfp:this.xfp,xpub:this.xpub,hdPath:this.hdPath,childrenPath:this.childrenPath,indexes:this.indexes,paths:this.paths})}deserialize(e){e&&(this.accounts=e.accounts,this.currentAccount=e.currentAccount,this.page=e.page,this.perPage=e.perPage,this.name=e.name,this.initialized=e.initialized,this.keyringMode=e.keyringMode||s.hd,this.keyringAccount=e.keyringAccount||o.standard,this.xfp=e.xfp,this.xpub=e.xpub,this.hdPath=e.hdPath,this.indexes=e.indexes,this.paths=e.paths,this.childrenPath=e.childrenPath||"0/*")}setCurrentAccount(e){this.currentAccount=e}getCurrentAccount(){return this.currentAccount}getCurrentAddress(){return this.accounts[this.currentAccount]}async addAccounts(e=1){const t=this.unlockedAccount,r=t+e,n=[];for(let e=t;e<r;e++){const t=await this.__addressFromIndex("m",e);n.push(t),this.page=0,this.unlockedAccount++}return this.accounts=this.accounts.concat(n),this.accounts}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}async __getPage(e){return this.initialized||await this.readKeyring(),this.keyringMode===s.hd?this.__getNormalPage(e):this.__getLedgerLivePage(e)}getAccounts(){return Promise.resolve(this.accounts)}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){const n=0===r.type?u.DataType.transaction:u.DataType.typedTransaction;let s;s=0===r.type?t.from(c.encode(r.getMessageToSign(!1))):r.getMessageToSign(!1);const o=await this._pathFromAddress(e),i=Number(r.common.chainId()),a=d.v4(),h=u.EthSignRequest.constructETHRequest(s,n,o,this.xfp,a,i),{r:p,s:f,v:g}=await this.requestSignature(a,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature');return l.TransactionFactory.fromTxData({...r.toJSON(),type:r.type,r:p,s:f,v:g},{common:r.common})}signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,r){const n=a.stripHexPrefix(r),s=await this._pathFromAddress(e),o=d.v4(),i=u.EthSignRequest.constructETHRequest(t.from(n,"hex"),u.DataType.personalMessage,s,this.xfp,o,void 0,e),{r:c,s:l,v:h}=await this.requestSignature(o,i,"Scan with your Keystone",'After your Keystone has signed this message, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([c,l,h]).toString("hex")}async signTypedData(e,r){const n=await this._pathFromAddress(e),s=d.v4(),o=u.EthSignRequest.constructETHRequest(t.from(JSON.stringify(r),"utf-8"),u.DataType.typedData,n,this.xfp,s,void 0,e),{r:i,s:a,v:c}=await this.requestSignature(s,o,"Scan with your Keystone",'After your Keystone has signed this data, click on "Scan Keystone" to receive the signature');return"0x"+t.concat([i,a,c]).toString("hex")}async _pathFromAddress(e){if(this.keyringMode===s.hd){const t=a.toChecksumAddress(e);let r=this.indexes[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===await this.__addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${this.childrenPath.replace("*",r.toString()).replace(/\*/g,"0")}`}{const t=a.toChecksumAddress(e),r=this.paths[t];if(void 0===r)throw new Error("Unknown address");return r}}}h.type="QR Hardware Wallet Device",r.BaseKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/base-eth-keyring.cjs.production.min.js"}],[543,{"./base-eth-keyring.cjs.development.js":541,"./base-eth-keyring.cjs.production.min.js":542},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./base-eth-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring",file:"node_modules/@keystonehq/base-eth-keyring/dist/index.js"}],[544,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(n(e[r]));const r=p(...t);return p(i(r.length,192),r)}const t=y(e);return 1===t.length&&t[0]<128?t:p(i(t.length,128),t)}function s(e,t,r){if(r>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,r)}function o(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return d(u(e))}function i(e,t){if(e<56)return Uint8Array.from([e+t]);const r=g(e),n=g(t+55+r.length/2);return Uint8Array.from(h(n+r))}function a(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const r=c(y(e));if(t)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function c(e){let t,r,n,i,a;const l=[],u=e[0];if(u<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(u<=183){if(t=u-127,n=128===u?Uint8Array.from([]):s(e,1,t),2===t&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:e.slice(t)}}if(u<=191){if(r=u-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=o(s(e,1,r)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=s(e,r,t+r),{data:n,remainder:e.slice(t+r)}}if(u<=247){for(t=u-191,i=s(e,1,t);i.length;)a=c(i),l.push(a.data),i=a.remainder;return{data:l,remainder:e.slice(t)}}{if(r=u-246,t=o(s(e,1,r)),t<56)throw new Error("invalid RLP: encoded list too short");const n=r+t;if(n>e.length)throw new Error("invalid RLP: total length is larger than the data");for(i=s(e,r,n);i.length;)a=c(i),l.push(a.data),i=a.remainder;return{data:l,remainder:e.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=a;const l=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function u(e){let t="";for(let r=0;r<e.length;r++)t+=l[e[r]];return t}function d(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r;t[r]=d(e.slice(n,n+2))}return t}function p(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}function f(e){return(new TextEncoder).encode(e)}function g(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function m(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function y(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return m(e)?h((t="string"!=typeof(r=e)?r:m(r)?r.slice(2):r).length%2?`0${t}`:t):f(e);var t,r;if("number"==typeof e||"bigint"==typeof e)return e?h(g(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}r.utils={bytesToHex:u,concatBytes:p,hexToBytes:h,utf8ToBytes:f};const b={encode:n,decode:a};r.default=b}}},{package:"@keystonehq/metamask-airgapped-keyring>@keystonehq/base-eth-keyring>rlp",file:"node_modules/@keystonehq/base-eth-keyring/node_modules/rlp/dist/index.js"}],[57,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return s((0,n.cloneDeep)(e),(e=>null===e?"null":typeof e))};var n=e("lodash");function s(e={},t){return Object.entries(e).forEach((([r,n])=>{e[r]="object"==typeof n&&null!==n?s(n,t):t(n)})),e}}}},{package:"$root$",file:"app/scripts/lib/getObjStructure.js"}],[571,{"./metamask-airgapped-keyring.cjs.development.js":572,"./metamask-airgapped-keyring.cjs.production.min.js":573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/index.js"}],[572,{"@ethereumjs/tx":395,"@keystonehq/base-eth-keyring":543,"@keystonehq/bc-ur-registry-eth":547,"@metamask/obs-store":578,buffer:2818,events:3237,rlp:4423,uuid:4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),o=e("events"),i=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),l=e("@ethereumjs/tx"),u=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class d extends o.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(`${e}-signed`),this.removeAllListeners(`${e}-canceled`)},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,o)=>{const i=e.toUR(),l=e.getRequestId(),u=c.stringify(l),d={requestId:u,payload:{type:i.type,cbor:i.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(`${u}-signed`,(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(`${u}-canceled`,(()=>{this.resetState(),o(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},d.instance)return d.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),d.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new d,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let n;n=0===t.type?u.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),o=t.common.chainId(),i=c.v4(),d=a.EthSignRequest.constructETHRequest(n,r,s,this.xfp,i,o,e),{r:h,s:p,v:f}=await this.requestSignature(i,d,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();g.v=f,g.s=p,g.r=h,g.type=t.type;return l.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[573,{"@ethereumjs/tx":395,"@keystonehq/base-eth-keyring":543,"@keystonehq/bc-ur-registry-eth":547,"@metamask/obs-store":578,buffer:2818,events:3237,rlp:4423,uuid:4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/base-eth-keyring"),o=e("events"),i=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),c=e("uuid"),l=e("@ethereumjs/tx"),u=(n=e("rlp"))&&"object"==typeof n&&"default"in n?n.default:n;class d extends o.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(e+"-signed"),this.removeAllListeners(e+"-canceled")},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,o)=>{const i=e.toUR(),l=e.getRequestId(),u=c.stringify(l),d={requestId:u,payload:{type:i.type,cbor:i.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(u+"-signed",(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(u+"-canceled",(()=>{this.resetState(),o(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},d.instance)return d.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),d.instance=this}}class h extends s.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new d,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,h.instance)return h.instance.deserialize(e),h.instance;h.instance=this}async signTransaction(e,t){const r=0===t.type?a.DataType.transaction:a.DataType.typedTransaction;let n;n=0===t.type?u.encode(t.getMessageToSign(!1)):t.getMessageToSign(!1);const s=await this._pathFromAddress(e),o=t.common.chainId(),i=c.v4(),d=a.EthSignRequest.constructETHRequest(n,r,s,this.xfp,i,o,e),{r:h,s:p,v:f}=await this.requestSignature(i,d,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),g=t.toJSON();return g.v=f,g.s=p,g.r=h,g.type=t.type,l.TransactionFactory.fromTxData(g,{common:t.common})}}h.type=s.BaseKeyring.type,r.MetaMaskKeyring=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"node_modules/@keystonehq/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[574,{"./ObservableStore":576},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}r.ComposedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[575,{"./ObservableStore":576},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MergedStore=void 0;const n=e("./ObservableStore");class s extends n.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}r.MergedStore=s}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/MergedStore.js"}],[576,{"@metamask/safe-event-emitter":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObservableStore=void 0;const s=n(e("@metamask/safe-event-emitter"));class o extends s.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}r.ObservableStore=o}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[577,{stream:4497},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class s extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new s(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/asStream.js"}],[578,{"./ComposedStore":574,"./MergedStore":575,"./ObservableStore":576,"./asStream":577,"./transform":579},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./asStream"),r),s(e("./ComposedStore"),r),s(e("./MergedStore"),r),s(e("./ObservableStore"),r),s(e("./transform"),r)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/index.js"}],[579,{through2:580},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/@metamask/obs-store/dist/transform.js"}],[58,{"@metamask/keyring-api":1447,"@metamask/permission-controller":1640},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isProtocolAllowed=c,r.keyringSnapPermissionsBuilder=function(e){return t=>{if("metamask"===t)return o;const r=e.getSubjectMetadata(t);return(null==r?void 0:r.subjectType)===n.SubjectType.Website&&c(t)?i:[]}};var n=e("@metamask/permission-controller"),s=e("@metamask/keyring-api");const o=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.SubmitRequest,s.KeyringRpcMethod.RejectRequest],i=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.CreateAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.UpdateAccount,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ExportAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.ApproveRequest,s.KeyringRpcMethod.RejectRequest],a=["https:"];function c(e){try{const t=new URL(e);return a.includes(t.protocol)}catch(e){return!1}}}}},{package:"$root$",file:"app/scripts/lib/keyring-snaps-permissions.ts"}],[580,{_process:4118,"readable-stream":4389,util:4610,xtend:4653},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,s=e("util").inherits,o=e("xtend");function i(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}s(i,n),i.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new i(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=o(e,t),i.call(this,this.options)}return s(n,i),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new i(o({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2",file:"node_modules/@keystonehq/metamask-airgapped-keyring/node_modules/through2/through2.js"}],[6,{"../../../shared/constants/alerts":4664,"@metamask/obs-store":1632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),s=e("../../../shared/constants/alerts");const o={alertEnabledness:s.TOGGLEABLE_ALERT_TYPES.reduce(((e,t)=>(e[t]=!0,e)),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}};r.default=class{constructor(e={}){const{initState:t={},preferencesStore:r}=e,s={...o,alertEnabledness:{...o.alertEnabledness,...t.alertEnabledness}};this.store=new n.ObservableStore(s),this.selectedAddress=r.getState().selectedAddress,r.subscribe((({selectedAddress:e})=>{this.store.getState().unconnectedAccountAlertShownOrigins&&this.selectedAddress!==e&&(this.selectedAddress=e,this.store.updateState({unconnectedAccountAlertShownOrigins:{}}))}))}setAlertEnabledness(e,t){let{alertEnabledness:r}=this.store.getState();r={...r},r[e]=t,this.store.updateState({alertEnabledness:r})}setUnconnectedAccountAlertShown(e){let{unconnectedAccountAlertShownOrigins:t}=this.store.getState();t={...t},t[e]=!0,this.store.updateState({unconnectedAccountAlertShownOrigins:t})}getWeb3ShimUsageState(e){return this.store.getState().web3ShimUsageOrigins[e]}setWeb3ShimUsageRecorded(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.recorded)}setWeb3ShimUsageAlertDismissed(e){this._setWeb3ShimUsageState(e,s.Web3ShimUsageAlertStates.dismissed)}_setWeb3ShimUsageState(e,t){let{web3ShimUsageOrigins:r}=this.store.getState();r={...r},r[e]=t,this.store.updateState({web3ShimUsageOrigins:r})}}}}},{package:"$root$",file:"app/scripts/controllers/alert.js"}],[61,{"../util":90,"json-rpc-engine":3772},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPendingNonceMiddleware=function({getPendingNonce:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:s,params:o}=t;if("eth_getTransactionCount"!==s)return void n();const[i,a]=o;"pending"===a?r.result=await e(i):n()}))},r.createPendingTxMiddleware=function({getPendingTransactionByHash:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const{method:o,params:i}=t;if("eth_getTransactionByHash"!==o)return void n();const[a]=i,c=e(a);c?r.result=(0,s.formatTxMetaForRpcResult)(c):n()}))};var n=e("json-rpc-engine"),s=e("../util")}}},{package:"$root$",file:"app/scripts/lib/middleware/pending.js"}],[62,{events:3237,loglevel:3987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("events")),s=o(e("loglevel"));function o(e){return e&&e.__esModule?e:{default:e}}class i extends n.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort(((e,t)=>e.version-t.version));const r=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||r&&r.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter((function(t){return t.version>e.meta.version}));for(const r of t)try{s.default.info(`Running migration ${r.version}...`);const t=await r.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==r.version)throw new Error("Migrator - Migration did not update version number correctly");e=t,s.default.info(`Migration ${r.version} complete`)}catch(t){const n=t.message;return t.message=`MetaMask Migration Error #${r.version}: ${n}`,this.emit("error",t),e}return e}generateInitialState(e){return{meta:{version:this.defaultVersion},data:e}}}r.default=i}}},{package:"$root$",file:"app/scripts/lib/migrator/index.js"}],[64,{"../platforms/extension":200,"@metamask/safe-event-emitter":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NOTIFICATION_MANAGER_EVENTS=void 0;var n=o(e("@metamask/safe-event-emitter")),s=o(e("../platforms/extension"));function o(e){return e&&e.__esModule?e:{default:e}}const i=r.NOTIFICATION_MANAGER_EVENTS={POPUP_CLOSED:"onPopupClosed"};class a extends n.default{constructor(){super(),this.platform=new s.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(e,t){this._popupId=t,this._setCurrentPopupId=e;const r=await this._getPopup(t);if(r)await this.platform.focusWindow(r.id);else{let e=0,t=0;try{const r=await this.platform.getLastFocusedWindow();t=r.top,e=Math.max(r.left+(r.width-360),0)}catch(r){const{screenX:n,screenY:s,outerWidth:o}=window;t=Math.max(s,0),e=Math.max(n+(o-360),0)}const r=await this.platform.openWindow({url:"notification.html",type:"popup",width:360,height:620,left:e,top:t});r.left!==e&&"fullscreen"!==r.state&&await this.platform.updateWindowPosition(r.id,e,t),this._setCurrentPopupId(r.id),this._popupId=r.id}}_onWindowClosed(e){e===this._popupId&&(this._setCurrentPopupId(undefined),this._popupId=undefined,this.emit(i.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find((e=>e&&"popup"===e.type&&e.id===this._popupId)):null}}r.default=a}}},{package:"$root$",file:"app/scripts/lib/notification-manager.js"}],[65,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.IndexedDBPPOMStorage=void 0;const o=async(e,t,r)=>{const n=await crypto.subtle.digest("SHA-256",t);if(Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")!==r)throw new Error(`Checksum mismatch for key ${e}`)};var i=new WeakSet;function a(e){return new Promise(((t,r)=>{const n=indexedDB.open(this.storeName,this.dbVersion);n.onerror=e=>{var t;r(new Error(`Failed to open database ${this.storeName}: ${null===(t=e.target)||void 0===t?void 0:t.error}`))},n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:["name","chainId"]})},n.onsuccess=r=>{const n=r.target.result.transaction([this.storeName],e).objectStore(this.storeName);t(n)}}))}r.IndexedDBPPOMStorage=class{constructor(e,t){n(this,i),s(this,"storeName",void 0),s(this,"dbVersion",void 0),this.storeName=e,this.dbVersion=t}async objectStoreAction(e,t,r="readonly"){return new Promise(((n,s)=>{(function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r})(this,i,a).call(this,r).then((r=>{const o=r[e](t);o.onsuccess=async e=>{n(e)},o.onerror=t=>{var r;s(new Error(`Error in indexDB operation ${e}: ${null===(r=t.target)||void 0===r?void 0:r.error}`))}})).catch((e=>{s(e)}))}))}async read(e,t){var r;const n=null===(r=(await this.objectStoreAction("get",[e.name,e.chainId])).target)||void 0===r||null===(r=r.result)||void 0===r?void 0:r.data;return await o(e,n,t),n}async write(e,t,r){await o(e,t,r),await this.objectStoreAction("put",{...e,data:t},"readwrite")}async delete(e){await this.objectStoreAction("delete",[e.name,e.chainId],"readwrite")}async dir(){var e;return null===(e=(await this.objectStoreAction("getAllKeys")).target)||void 0===e?void 0:e.result.map((([e,t])=>({name:e,chainId:t})))}}}}},{package:"$root$",file:"app/scripts/lib/ppom/indexed-db-backend.ts"}],[66,{"../../../../shared/constants/network":4674,"../../../../shared/constants/security-provider":4677},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createPPOMMiddleware=function(e,t,r){return async(a,c,l)=>{try{var u;const n=null===(u=t.store.getState())||void 0===u?void 0:u.securityAlertsEnabled,{chainId:o}=r.state.providerConfig;n&&i.includes(a.method)&&o===s.CHAIN_IDS.MAINNET&&(a.securityAlertResponse=await e.usePPOM((async e=>e.validateJsonRpc(a))))}catch(e){null==o||o.captureException(e),console.error("Error validating JSON RPC using PPOM: ",e),a.securityAlertResponse={result_type:n.BlockaidResultType.Failed,reason:n.BlockaidReason.failed,description:"Validating the confirmation failed by throwing error."}}finally{l()}}};var n=e("../../../../shared/constants/security-provider"),s=e("../../../../shared/constants/network");const{sentry:o}=global,i=Object.freeze(["eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign"])}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-middleware.ts"}],[67,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.PPOM=void 0,r.initSync=function(e){if(n!==undefined)return n;const t=T();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const r=new WebAssembly.Instance(e,t);return E(r,e)},r.main=function(){n.main()};const s=new Array(128).fill(undefined);function o(e){return s[e]}s.push(undefined,null,!0,!1);let i=s.length;function a(e){const t=o(e);return function(e){e<132||(s[e]=i,i=e)}(e),t}let c=0,l=null;function u(){return null!==l&&0!==l.byteLength||(l=new Uint8Array(n.memory.buffer)),l}const d="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},h="function"==typeof d.encodeInto?function(e,t){return d.encodeInto(e,t)}:function(e,t){const r=d.encode(e);return t.set(r),{read:e.length,written:r.length}};function p(e,t,r){if(r===undefined){const r=d.encode(e),n=t(r.length,1)>>>0;return u().subarray(n,n+r.length).set(r),c=r.length,n}let n=e.length,s=t(n,1)>>>0;const o=u();let i=0;for(;i<n;i++){const t=e.charCodeAt(i);if(t>127)break;o[s+i]=t}if(i!==n){0!==i&&(e=e.slice(i)),s=r(s,n,n=i+3*e.length,1)>>>0;const t=u().subarray(s+i,s+n);i+=h(e,t).written}return c=i,s}let f=null;function g(){return null!==f&&0!==f.byteLength||(f=new Int32Array(n.memory.buffer)),f}const m="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function y(e,t){return e>>>=0,m.decode(u().subarray(e,e+t))}function b(e){i===s.length&&s.push(s.length+1);const t=i;return i=s[t],s[t]=e,t}function w(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let r="[";t>0&&(r+=w(e[0]));for(let n=1;n<t;n++)r+=", "+w(e[n]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let n;if(!(r.length>1))return toString.call(e);if(n=r[1],"Object"==n)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:n}function v(e,t,r){n._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke(e,t,b(r))}function k(e,t){n._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__destroy(e,t)}"undefined"!=typeof TextDecoder&&m.decode();let C=null;function _(e,t){const r=t(4*e.length,4)>>>0,s=(null!==C&&0!==C.byteLength||(C=new Uint32Array(n.memory.buffer)),C);for(let t=0;t<e.length;t++)s[r/4+t]=b(e[t]);return c=e.length,r}function S(e,t){try{return e.apply(this,t)}catch(e){n.__wbindgen_exn_store(b(e))}}class A{static __wrap(e){e>>>=0;const t=Object.create(A.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();n.__wbg_ppom_free(e)}static new(e,t){const r=_(t,n.__wbindgen_malloc),s=c;return a(n.ppom_new(b(e),r,s))}validateJsonRpc(e){return a(n.ppom_validateJsonRpc(this.__wbg_ptr,b(e)))}}function T(){const e={wbg:{}};return e.wbg.__wbg_buffer_085ec1f694018c4f=function(e){return b(o(e).buffer)},e.wbg.__wbg_call_01734de55d61e11d=function(){return S((function(e,t,r){return b(o(e).call(o(t),o(r)))}),arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return S((function(e,t,r,n){return b(o(e).call(o(t),o(r),o(n)))}),arguments)},e.wbg.__wbg_from_d7c216d4616bb368=function(e){return b(Array.from(o(e)))},e.wbg.__wbg_get_44be0491f933a435=function(e,t){return b(o(e)[t>>>0])},e.wbg.__wbg_length_72e2208bbc0efc61=function(e){return o(e).length},e.wbg.__wbg_length_d813e535247d427e=function(e){return o(e).length},e.wbg.__wbg_length_fff51ee6522a1a18=function(e){return o(e).length},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var r={a:e,b:t};const s=new Promise(((e,t)=>{const s=r.a;r.a=0;try{return function(e,t,r,s){n.wasm_bindgen__convert__closures__invoke2_mut(e,t,b(r),b(s))}(s,r.b,e,t)}finally{r.a=s}}));return b(s)}finally{r.a=r.b=0}},e.wbg.__wbg_new_8125e318e6245eed=function(e){return b(new Uint8Array(o(e)))},e.wbg.__wbg_parse_670c19d4e984792e=function(){return S((function(e,t){return b(JSON.parse(y(e,t)))}),arguments)},e.wbg.__wbg_ppom_new=function(e){return b(A.__wrap(e))},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){return b(Promise.resolve(o(e)))},e.wbg.__wbg_set_5cf90238115182c3=function(e,t,r){o(e).set(o(t),r>>>0)},e.wbg.__wbg_stringify_e25465938f3f611f=function(){return S((function(e){return b(JSON.stringify(o(e)))}),arguments)},e.wbg.__wbg_then_b2267541e2a73865=function(e,t,r){return b(o(e).then(o(t),o(r)))},e.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){return b(o(e).then(o(t)))},e.wbg.__wbindgen_cb_drop=function(e){const t=a(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbindgen_closure_wrapper_wasm_bindgen__closure__Closure_T___wrap__breaks_if_inlined=function(e,t,r){const n=function(e,t,r,n){const s={a:e,b:t,cnt:1},o=(...e)=>{s.cnt++;const t=s.a;s.a=0;try{return n(t,s.b,...e)}finally{0==--s.cnt?r(t,s.b):s.a=t}};return o.original=s,o}(e,t,k,v);return b(n)},e.wbg.__wbindgen_debug_string=function(e,t){const r=p(w(o(t)),n.__wbindgen_malloc,n.__wbindgen_realloc),s=c;g()[e/4+1]=s,g()[e/4+0]=r},e.wbg.__wbindgen_error_new=function(e,t){return b(new Error(y(e,t)))},e.wbg.__wbindgen_is_undefined=function(e){return o(e)===undefined},e.wbg.__wbindgen_memory=function(){return b(n.memory)},e.wbg.__wbindgen_object_drop_ref=function(e){a(e)},e.wbg.__wbindgen_string_get=function(e,t){const r=o(t),s="string"==typeof r?r:undefined;var i,a=(i=s)===undefined||null===i?0:p(s,n.__wbindgen_malloc,n.__wbindgen_realloc),l=c;g()[e/4+1]=l,g()[e/4+0]=a},e.wbg.__wbindgen_string_new=function(e,t){return b(y(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(y(e,t))},e}function E(e,t){return n=e.exports,M.__wbindgen_wasm_module=t,f=null,C=null,l=null,n.__wbindgen_start(),n}async function M(e){if(n!==undefined)return n;const t=T();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return E(r,s)}r.PPOM=A;r.default=M}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom.js"}],[68,{"../../../../shared/constants/network":4674,"./handlers":72,"@metamask/permission-controller":1640,"@metamask/rpc-methods":1700,"eth-rpc-errors":3132,lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createMethodMiddleware=function(e){const t=d.filter((t=>!Object.hasOwnProperty.call(e,t)));if(t.length>0)throw new Error(`Missing expected hooks:\n\n${t.join("\n")}\n`);return async function(t,r,n,s){if(c.UNSUPPORTED_RPC_METHODS.has(t.method))return s(i.ethErrors.rpc.methodNotSupported());const a=u.get(t.method);if(a){const{implementation:i,hookNames:c}=a;try{return await i(t,r,n,s,(0,o.selectHooks)(e,c))}catch(e){return s(e)}}return n()}},r.createSnapMethodMiddleware=function(e,t){return async function(r,n,s,a){const c=h.get(r.method);if(c){if(/^snap_/iu.test(r.method)&&!e)return a(i.ethErrors.rpc.methodNotFound());const{implementation:l,hookNames:u}=c;try{return await l(r,n,s,a,(0,o.selectHooks)(t,u))}catch(e){return a(e)}}return s()}};var n,s=e("@metamask/permission-controller"),o=e("@metamask/rpc-methods"),i=e("eth-rpc-errors"),a=e("lodash"),c=e("../../../../shared/constants/network");const l=[...((n=e("./handlers"))&&n.__esModule?n:{default:n}).default,...s.permissionRpcMethods.handlers],u=l.reduce(((e,t)=>{for(const r of t.methodNames)e.set(r,t);return e}),new Map),d=Array.from(new Set((0,a.flatten)(l.map((({hookNames:e})=>Object.keys(e))))).values());const h=o.permittedMethods.reduce(((e,t)=>{for(const r of t.methodNames)e.set(r,t);return e}),new Map)}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[69,{"../../../../../shared/constants/app":4665,"../../../../../shared/constants/metametrics":4673,"../../../../../shared/modules/network.utils":4707,"../../util":90,"@metamask/controller-utils":1144,"eth-rpc-errors":3132,lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),o=e("lodash"),i=e("../../../../../shared/constants/app"),a=e("../../../../../shared/constants/metametrics"),c=e("../../../../../shared/modules/network.utils"),l=e("../../util");const u={methodNames:[i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,r,u,{upsertNetworkConfiguration:d,getCurrentChainId:h,getCurrentRpcUrl:p,findNetworkConfigurationBy:f,setActiveNetwork:g,requestUserApproval:m,startApprovalFlow:y,endApprovalFlow:b}){var w;if(null===(w=e.params)||void 0===w||!w[0]||"object"!=typeof e.params[0])return u(s.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:v}=e,{chainId:k,chainName:C=null,blockExplorerUrls:_=null,nativeCurrency:S=null,rpcUrls:A}=e.params[0],T=Object.keys((0,o.omit)(e.params[0],["chainId","chainName","blockExplorerUrls","iconUrls","rpcUrls","nativeCurrency"]));if(T.length>0)return u(s.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${T}`}));function E(e){const t=(0,l.getValidUrl)(e);return null!==t&&("localhost"===t.hostname||"127.0.0.1"===t.hostname||"https:"===t.protocol)}const M=Array.isArray(A)?A.find((e=>E(e))):null,P=null!==_&&Array.isArray(_)?_.find((e=>E(e))):null;if(!M)return u(s.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${A}`}));if(null!==_&&!P)return u(s.ethErrors.rpc.invalidParams({message:`Expected null or array with at least one valid string HTTPS URL 'blockExplorerUrl'. Received: ${_}`}));const N="string"==typeof k&&k.toLowerCase();if(!(0,c.isPrefixedFormattedHexString)(N))return u(s.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${k}`}));if(!(0,c.isSafeChainId)(parseInt(N,16)))return u(s.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${N}": numerical value greater than max safe value. Received:\n${k}`}));const O=f({chainId:N});if(O&&O.rpcUrl===M){t.result=null;const e=h(),r=p();if(e===N&&r===M)return u();try{await m({origin:v,type:n.ApprovalType.SwitchEthereumChain,requestData:{rpcUrl:O.rpcUrl,chainId:O.chainId,nickname:O.nickname,ticker:O.ticker}}),await g(O.id),t.result=null}catch(e){if(e.code!==s.errorCodes.provider.userRejectedRequest)return u(e)}return u()}if("string"!=typeof C||!C)return u(s.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${C}`}));const R=C.length>100?C.substring(0,100):C;if(null!==S){if("object"!=typeof S||Array.isArray(S))return u(s.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${S}`}));if(18!==S.decimals)return u(s.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${S.decimals}`}));if(!S.symbol||"string"!=typeof S.symbol)return u(s.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${S.symbol}`}))}const I=(null==S?void 0:S.symbol)||i.UNKNOWN_TICKER_SYMBOL;if(I!==i.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof I||I.length<2||I.length>6))return u(s.ethErrors.rpc.invalidParams({message:`Expected 2-6 character string 'nativeCurrency.symbol'. Received:\n${I}`}));if(O&&O.chainId===N&&O.ticker!==I)return u(s.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${I}`}));let j;const{id:x}=await y();try{await m({origin:v,type:n.ApprovalType.AddEthereumChain,requestData:{chainId:N,rpcPrefs:{blockExplorerUrl:P},chainName:R,rpcUrl:M,ticker:I}}),j=await d({chainId:N,rpcPrefs:{blockExplorerUrl:P},nickname:R,rpcUrl:M,ticker:I},{source:a.MetaMetricsNetworkEventSource.Dapp,referrer:v}),t.result=null}catch(e){return b({id:x}),u(e)}try{await m({origin:v,type:n.ApprovalType.SwitchEthereumChain,requestData:{rpcUrl:M,chainId:N,nickname:R,ticker:I,networkConfigurationId:j}})}catch(e){return u(e.code===s.errorCodes.provider.userRejectedRequest?undefined:e)}finally{b({id:x})}try{await g(j)}catch(e){return u(e)}return u()},hookNames:{upsertNetworkConfiguration:!0,getCurrentChainId:!0,getCurrentRpcUrl:!0,findNetworkConfigurationBy:!0,setActiveNetwork:!0,requestUserApproval:!0,startApprovalFlow:!0,endApprovalFlow:!0}};r.default=u}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[7,{"@metamask/obs-store":1632,events:3237},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("events"))&&n.__esModule?n:{default:n},o=e("@metamask/obs-store");function i(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}const l={currentAppVersion:"",previousAppVersion:"",previousMigrationVersion:0,currentMigrationVersion:0};var u=new WeakSet,d=new WeakSet;class h extends s.default{constructor({currentAppVersion:e="",currentMigrationVersion:t=0,state:r={}}){super(),i(this,d),i(this,u),a(this,"store",void 0),this.store=new o.ObservableStore({...l,...r}),c(this,u,p).call(this,e),c(this,d,f).call(this,t)}}function p(e){const t=this.store.getState().currentAppVersion;e!==t&&this.store.updateState({currentAppVersion:e,previousAppVersion:t})}function f(e){const t=this.store.getState().currentMigrationVersion;e!==t&&this.store.updateState({previousMigrationVersion:t,currentMigrationVersion:e})}r.default=h}}},{package:"$root$",file:"app/scripts/controllers/app-metadata.ts"}],[70,{"../../../../../shared/constants/app":4665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,r,n,{getAccounts:s}){return t.result=await s(),n()},hookNames:{getAccounts:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.js"}],[71,{"../../../../../shared/constants/app":4665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,r,n,{getProviderState:s}){return t.result={...await s(e.origin)},n()},hookNames:{getProviderState:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.js"}],[72,{"./add-ethereum-chain":69,"./eth-accounts":70,"./get-provider-state":71,"./log-web3-shim-usage":73,"./request-accounts":74,"./send-metadata":75,"./switch-ethereum-chain":76,"./watch-asset":77},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=d(e("./add-ethereum-chain")),s=d(e("./eth-accounts")),o=d(e("./get-provider-state")),i=d(e("./log-web3-shim-usage")),a=d(e("./request-accounts")),c=d(e("./send-metadata")),l=d(e("./switch-ethereum-chain")),u=d(e("./watch-asset"));function d(e){return e&&e.__esModule?e:{default:e}}const h=[n.default,s.default,o.default,i.default,a.default,c.default,l.default,u.default];r.default=h}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.js"}],[73,{"../../../../../shared/constants/app":4665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,r,n,{getWeb3ShimUsageState:s,setWeb3ShimUsageRecorded:o}){const{origin:i}=e;s(i)===undefined&&o(i);return t.result=!0,n()},hookNames:{getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.js"}],[74,{"../../../../../shared/constants/app":4665,"eth-rpc-errors":3132},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app");const o={methodNames:[s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,r,o,{origin:a,getAccounts:c,getUnlockPromise:l,hasPermission:u,requestAccountsPermission:d}){if(i.has(a))return t.error=n.ethErrors.rpc.resourceUnavailable(`Already processing ${s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),o();if(u(s.MESSAGE_TYPE.ETH_ACCOUNTS)){try{i.add(a),await l(!0),t.result=await c(),o()}catch(e){o(e)}finally{i.delete(a)}return undefined}try{await d()}catch(e){return t.error=e,o()}const h=await c();h.length>0?t.result=h:t.error=n.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return o()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0}};r.default=o;const i=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.js"}],[75,{"../../../../../shared/constants/app":4665,"eth-rpc-errors":3132},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");const s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,s,{addSubjectMetadata:o,subjectType:i}){const{origin:a,params:c}=e;if(!c||"object"!=typeof c||Array.isArray(c))return s(n.ethErrors.rpc.invalidParams({data:c}));{const{icon:e=null,name:t=null,...r}=c;o({...r,iconUrl:e,name:t,subjectType:i,origin:a})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[76,{"../../../../../shared/constants/app":4665,"../../../../../shared/constants/network":4674,"../../../../../shared/modules/network.utils":4707,"@metamask/controller-utils":1144,"eth-rpc-errors":3132,lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("lodash"),o=e("@metamask/controller-utils"),i=e("../../../../../shared/constants/app"),a=e("../../../../../shared/constants/network"),c=e("../../../../../shared/modules/network.utils");const l={methodNames:[i.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,l,{getCurrentChainId:u,findNetworkConfigurationBy:d,findNetworkClientIdByChainId:h,setNetworkClientIdForDomain:p,setProviderType:f,setActiveNetwork:g,requestUserApproval:m}){var y;if(null===(y=e.params)||void 0===y||!y[0]||"object"!=typeof e.params[0])return l(n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:b}=e,{chainId:w}=e.params[0],v=Object.keys((0,s.omit)(e.params[0],["chainId"]));if(v.length>0)return l(n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${v}`}));const k="string"==typeof w&&w.toLowerCase();if(!(0,c.isPrefixedFormattedHexString)(k))return l(n.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${w}`}));if(!(0,c.isSafeChainId)(parseInt(k,16)))return l(n.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${k}": numerical value greater than max safe value. Received:\n${w}`}));const C=function(e,t){if(Object.values(a.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(e))return{chainId:e,ticker:a.CURRENCY_SYMBOLS.ETH,nickname:a.NETWORK_TO_NAME_MAP[e],rpcUrl:a.CHAIN_ID_TO_RPC_URL_MAP[e],type:a.CHAIN_ID_TO_TYPE_MAP[e]};return t({chainId:e})}(k,d);if(C){if(u()===k)return t.result=null,l();try{const r=await m({origin:b,type:o.ApprovalType.SwitchEthereumChain,requestData:C});Object.values(a.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(k)?await f(r.type):await g(r.id);const n=h(k);p(e.origin,n),t.result=null}catch(e){return l(e)}return l()}return l(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${w}". Try adding the chain using ${i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}))},hookNames:{getCurrentChainId:!0,findNetworkConfigurationBy:!0,findNetworkClientIdByChainId:!0,setNetworkClientIdForDomain:!0,setProviderType:!0,setActiveNetwork:!0,requestUserApproval:!0}};r.default=l}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[77,{"../../../../../shared/constants/app":4665,"@metamask/controller-utils":1144,"eth-rpc-errors":3132},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),o=e("../../../../../shared/constants/app");const i={methodNames:[o.MESSAGE_TYPE.WATCH_ASSET,o.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,o,{handleWatchAssetRequest:i}){try{const{params:{options:r,type:a},origin:c,networkClientId:l}=e,{tokenId:u}=r;return[n.ERC721,n.ERC1155].includes(a)&&u!==undefined&&"string"!=typeof u?o(s.ethErrors.rpc.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof u}'`})):(await i({asset:r,type:a,origin:c,networkClientId:l}),t.result=!0,o())}catch(e){return o(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=i}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[78,{"./createMethodMiddleware":68},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[79,{"../../../shared/constants/app":4665,"../../../shared/modules/fetch-with-timeout":4702},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.securityProviderCheck=async function(e,t,r,n){let s;const a=e.msgParams||e.messageParams;if(t===o.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA)s={host_name:null==a?void 0:a.origin,rpc_method_name:t,chain_id:r,data:null==a?void 0:a.data,currentLocale:n};else if(t===o.MESSAGE_TYPE.ETH_SIGN||t===o.MESSAGE_TYPE.PERSONAL_SIGN)s={host_name:null==a?void 0:a.origin,rpc_method_name:t,chain_id:r,data:{signer_address:null==a?void 0:a.from,msg_to_sign:null==a?void 0:a.data},currentLocale:n};else{var c,l,u,d,h,p;s={host_name:e.origin,rpc_method_name:t,chain_id:r,data:{from_address:null===(c=e.txParams)||void 0===c?void 0:c.from,to_address:null===(l=e.txParams)||void 0===l?void 0:l.to,gas:null===(u=e.txParams)||void 0===u?void 0:u.gas,gasPrice:null===(d=e.txParams)||void 0===d?void 0:d.gasPrice,value:null===(h=e.txParams)||void 0===h?void 0:h.value,data:null===(p=e.txParams)||void 0===p?void 0:p.data},currentLocale:n}}const f=await i("https://proxy.metafi.codefi.network/opensea/security/v1/validate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)});return await f.json()};var n,s=(n=e("../../../shared/modules/fetch-with-timeout"))&&n.__esModule?n:{default:n},o=e("../../../shared/constants/app");const i=(0,s.default)()}}},{package:"$root$",file:"app/scripts/lib/security-provider-helpers.ts"}],[8,{"../../../shared/constants/alarms":4663,"../../../shared/constants/app":4665,"../../../shared/constants/preferences":4676,"../../../shared/constants/time":4684,"../../../shared/modules/mv3.utils":4706,"../../../ui/helpers/utils/build-types":5456,"../metamask-controller":91,"@metamask/controller-utils":1144,"@metamask/obs-store":1632,events:3237,loglevel:3987,uuid:4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=g(e("events")),s=e("@metamask/obs-store"),o=e("uuid"),i=g(e("loglevel")),a=e("@metamask/controller-utils"),c=e("../metamask-controller"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/alarms"),d=e("../../../shared/modules/mv3.utils"),h=e("../../../ui/helpers/utils/build-types"),p=e("../../../shared/constants/app"),f=e("../../../shared/constants/preferences");function g(e){return e&&e.__esModule?e:{default:e}}class m extends n.default{constructor(e={}){const{addUnlockListener:t,isUnlocked:r,initState:n,onInactiveTimeout:o,preferencesStore:i,messenger:a,extension:c}=e;super(),this.extension=c,this.onInactiveTimeout=o||(()=>undefined),this.store=new s.ObservableStore({timeoutMinutes:f.DEFAULT_AUTO_LOCK_TIME_LIMIT,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),outdatedBrowserWarningLastShown:(new Date).getTime(),nftsDetectionNoticeDismissed:!1,showTestnetMessageInDropdown:!0,showBetaHeader:(0,h.isBeta)(),showProductTour:!0,trezorModel:null,currentPopupId:undefined,hadAdvancedGasFeesSetPriorToMigration92_3:!1,...n,qrHardware:{},nftsDropdownState:{},usedNetworks:{"0x1":!0,"0x5":!0,"0x539":!0},serviceWorkerLastActiveTime:0}),this.timer=null,this.isUnlocked=r,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),i.subscribe((({preferences:e})=>{this.store.getState().timeoutMinutes!==e.autoLockTimeLimit&&this._setInactiveTimeout(e.autoLockTimeLimit)})),a.subscribe("KeyringController:qrKeyringStateChange",(e=>this.store.updateState({qrHardware:e})));const{preferences:l}=i.getState();this._setInactiveTimeout(l.autoLockTimeLimit),this.messagingSystem=a,this._approvalRequestId=null}getUnlockPromise(e){return new Promise((t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)}))}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(c.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE),t&&this._requestApproval()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(c.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}this._acceptApproval()}setDefaultHomeActiveTabName(e){this.store.updateState({defaultHomeActiveTabName:e})}setConnectedStatusPopoverHasBeenShown(){this.store.updateState({connectedStatusPopoverHasBeenShown:!0})}setRecoveryPhraseReminderHasBeenShown(){this.store.updateState({recoveryPhraseReminderHasBeenShown:!0})}setRecoveryPhraseReminderLastShown(e){this.store.updateState({recoveryPhraseReminderLastShown:e})}setTermsOfUseLastAgreed(e){this.store.updateState({termsOfUseLastAgreed:e})}setSnapsInstallPrivacyWarningShownStatus(e){this.store.updateState({snapsInstallPrivacyWarningShown:e})}setOutdatedBrowserWarningLastShown(e){this.store.updateState({outdatedBrowserWarningLastShown:e})}setLastActiveTime(){this._resetTimer()}_setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this._resetTimer()}_resetTimer(){const{timeoutMinutes:e}=this.store.getState();this.timer?clearTimeout(this.timer):d.isManifestV3&&this.extension.alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM),e&&(d.isManifestV3?(this.extension.alarms.create(u.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:e,periodInMinutes:e}),this.extension.alarms.onAlarm.addListener((e=>{e.name===u.AUTO_LOCK_TIMEOUT_ALARM&&(this.onInactiveTimeout(),this.extension.alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM))}))):this.timer=setTimeout((()=>this.onInactiveTimeout()),e*l.MINUTE))}setBrowserEnvironment(e,t){this.store.updateState({browserEnvironment:{os:e,browser:t}})}addPollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:[...r,e]})}}removePollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:r.filter((t=>t!==e))})}}clearPollingTokens(){this.store.updateState({popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[]})}setShowTestnetMessageInDropdown(e){this.store.updateState({showTestnetMessageInDropdown:e})}setShowBetaHeader(e){this.store.updateState({showBetaHeader:e})}setShowProductTour(e){this.store.updateState({showProductTour:e})}setTrezorModel(e){this.store.updateState({trezorModel:e})}updateNftDropDownState(e){this.store.updateState({nftsDropdownState:e})}setFirstTimeUsedNetwork(e){const t=this.store.getState(),{usedNetworks:r}=t;r[e]=!0,this.store.updateState({usedNetworks:r})}setCurrentPopupId(e){this.store.updateState({currentPopupId:e})}getCurrentPopupId(){return this.store.getState().currentPopupId}setServiceWorkerLastActiveTime(e){this.store.updateState({serviceWorkerLastActiveTime:e})}_requestApproval(){this._approvalRequestId=(0,o.v4)(),this.messagingSystem.call("ApprovalController:addRequest",{id:this._approvalRequestId,origin:p.ORIGIN_METAMASK,type:a.ApprovalType.Unlock},!0).catch((()=>{}))}_acceptApproval(){if(this._approvalRequestId){try{this.messagingSystem.call("ApprovalController:acceptRequest",this._approvalRequestId)}catch(e){i.default.error("Failed to unlock approval request",e)}this._approvalRequestId=null}}}r.default=m}}},{package:"$root$",file:"app/scripts/controllers/app-state.js"}],[80,{"../util":90,"@segment/loosely-validate-event":2039,buffer:2818,"is-retry-allowed":3754,lodash:3975,"remove-trailing-slash":4415,timers:4558},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=l(e("remove-trailing-slash")),o=l(e("@segment/loosely-validate-event")),i=e("lodash"),a=l(e("is-retry-allowed")),c=e("../util");function l(e){return e&&e.__esModule?e:{default:e}}const u=()=>({});r.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,o.default)(e,t)}_message(e,t,r){return this._validate(t,e),this.enqueue(e,t,r),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,r=u){if(!this.enable)return void n(r);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,c.generateRandomId)()),s.anonymousId&&!(0,i.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,i.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:r}),!this.flushed)return this.flushed=!0,void this.flush();const o=this.queue.length>=this.flushAt,a=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(o||a)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=u){if(!this.enable)return n(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return n(e),Promise.resolve();const r=this.queue.splice(0,this.flushAt),s=r.map((e=>e.callback)),o={batch:r.map((e=>e.message)),timestamp:new Date,sentAt:new Date},i={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(o),headers:i},(t=>{n((()=>{s.forEach((e=>e(t,o))),e(t,o)}))}),0)}_retryRequest(e,t,r,n){const s=100*Math.pow(2,n);setTimeout((()=>{this._sendRequest(e,t,r,n+1)}),s)}async _sendRequest(e,t,r,n){return fetch(e,t).then((async s=>{if(s.ok)r();else if(this._isErrorRetryable({response:s})&&n<=this.retryCount)this._retryRequest(e,t,r,n);else{const e=new Error(s.statusText);r(e)}})).catch((s=>{this._isErrorRetryable(s)&&n<=this.retryCount?this._retryRequest(e,t,r,n):r(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,a.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[81,{"../../../../shared/constants/time":4684,"./analytics":80},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var n,s=e("../../../../shared/constants/time"),o=(n=e("./analytics"))&&n.__esModule?n:{default:n};const i="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP",a=undefined,c=5*s.SECOND,l=(e=a)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=l;r.segment=i?new o.default(i,{host:null,flushAt:a,flushInterval:c}):l(a)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[85,{"./snap-keyring":87},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getAccountsBySnapId",{enumerable:!0,get:function(){return n.getAccountsBySnapId}}),Object.defineProperty(r,"snapKeyringBuilder",{enumerable:!0,get:function(){return n.snapKeyringBuilder}});var n=e("./snap-keyring")}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/index.ts"}],[86,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=async function(e,t,r,n){if(!n)return{};const s=e(),o=await async function(e){return await n.call("KeyringController:getKeyringForAccount",e)}(s),i=await async function(e){const t=e.toLowerCase();if(o.listAccounts){return(await o.listAccounts()).find((e=>e.address.toLowerCase()===t))}return undefined}(s),a=await n.call("SnapController:get",null==i?void 0:i.metadata.snap.id);return{account_type:await t(s),device_model:await r(s),account_hardware_type:await async function(){var e;return null!=o&&null!==(e=o.type)&&void 0!==e&&e.includes("Hardware")?o.type:undefined}(),account_snap_type:null==a?void 0:a.id,account_snap_version:null==a?void 0:a.version}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/metrics.ts"}],[87,{"../../../../shared/constants/app":4665,"../../translate":201,"./utils/isBlockedUrl":88,"@metamask/eth-snap-keyring":1298,"webextension-polyfill":4649},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.snapKeyringBuilder=r.getAccountsBySnapId=void 0;var n,s=e("@metamask/eth-snap-keyring"),o=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},i=e("../../../../shared/constants/app"),a=e("../../translate"),c=e("./utils/isBlockedUrl");r.getAccountsBySnapId=async(e,t)=>{const r=await e.getSnapKeyring();return await r.getAccountsBySnapId(t)};r.snapKeyringBuilder=(e,t,r,n,l,u)=>{const d=()=>new s.SnapKeyring(e(),{addressExists:async e=>(await r().getAccounts()).includes(e.toLowerCase()),redirectUser:async(e,r,n)=>{if(r.length>0||n.length>0){const s=await(0,c.isBlockedUrl)(r,l());await t().addAndShowApprovalRequest({origin:e,requestData:{url:r,message:n,isBlockedUrl:s},type:i.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect})&&r.length>0?o.default.tabs.create({url:r}):console.log("User refused snap account redirection to:",r)}else console.log("Error occurred when redirecting snap account. url or message must be defined")},saveState:async()=>{await r().persistAllKeyrings()},addAccount:async(e,s,o)=>{const{id:c}=t().startFlow(),l={name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:s}};try{const c=await t().addAndShowApprovalRequest({origin:s,type:i.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation});if(!c)throw await o(c),new Error("User denied account creation");try{await o(c),await r().persistAllKeyrings(),n().setSelectedAddress(e),await t().success({message:(0,a.t)("snapAccountCreated")??"Your account is ready!",header:[l]})}catch(e){throw await t().error({error:e.message,header:[l]}),new Error(`Error occurred while creating snap account: ${e.message}`)}}finally{t().endFlow({id:c})}},removeAccount:async(e,n,s)=>{const{id:o}=t().startFlow(),c={name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:n}};try{const o=await t().addAndShowApprovalRequest({origin:n,type:i.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval,requestData:{publicAddress:e}});if(!o)throw await s(o),new Error("User denied account removal");try{await u(e),await s(o),await r().persistAllKeyrings(),await t().success({message:(0,a.t)("snapAccountRemoved")??"Account removed",header:[c]})}catch(e){throw await t().error({error:e.message,header:[c]}),new Error(`Error occurred while removing snap account: ${e.message}`)}}finally{t().endFlow({id:o})}}});return d.type=s.SnapKeyring.type,d}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/snap-keyring.ts"}],[88,{"../../keyring-snaps-permissions":58},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBlockedUrl=void 0;var n=e("../../keyring-snaps-permissions");r.isBlockedUrl=async(e,t)=>{try{return!(0,n.isProtocolAllowed)(e)||(await t.maybeUpdateState(),t.test(e).result)}catch(e){return console.error("Invalid URL passed into snap-keyring:",e),!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/isBlockedUrl.ts"}],[9,{"@metamask/obs-store":1632},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store");r.default=class{constructor(e={}){const{accountTracker:t,getCurrentChainId:r}=e;this.accountTracker=t,this.getCurrentChainId=r;const s={cachedBalances:{},...e.initState};this.store=new n.ObservableStore(s),this._registerUpdates()}async updateCachedBalances({accounts:e}){const t=this.getCurrentChainId(),r=await this._generateBalancesToCache(e,t);this.store.updateState({cachedBalances:r})}_generateBalancesToCache(e,t){const{cachedBalances:r}=this.store.getState(),n={...r[t]};Object.keys(e).forEach((t=>{const r=e[t];r.balance&&(n[t]=r.balance)}));return{...r,[t]:n}}clearCachedBalances(){this.store.updateState({cachedBalances:{}})}_registerUpdates(){const e=this.updateCachedBalances.bind(this);this.accountTracker.store.subscribe(e)}}}}},{package:"$root$",file:"app/scripts/controllers/cached-balances.js"}],[91,{"../../shared/constants/app":4665,"../../shared/constants/hardware-wallets":4669,"../../shared/constants/keyring":4670,"../../shared/constants/logs":4672,"../../shared/constants/metametrics":4673,"../../shared/constants/network":4674,"../../shared/constants/permissions":4675,"../../shared/constants/swaps":4681,"../../shared/constants/test-flags":4683,"../../shared/constants/time":4684,"../../shared/constants/tokens":4685,"../../shared/constants/transaction":4686,"../../shared/lib/metamask-controller-utils":4689,"../../shared/lib/token-util.ts":4693,"../../shared/modules/conversion.utils":4700,"../../shared/modules/mv3.utils":4706,"../../shared/modules/string-utils":4713,"../../shared/modules/transaction.utils":4715,"../../shared/notifications":4717,"./controllers/alert":6,"./controllers/app-metadata":7,"./controllers/app-state":8,"./controllers/cached-balances":9,"./controllers/decrypt-message":10,"./controllers/detect-tokens":11,"./controllers/encryption-public-key":12,"./controllers/ens":14,"./controllers/metametrics":15,"./controllers/onboarding":16,"./controllers/permissions":20,"./controllers/preferences":25,"./controllers/swaps":26,"./controllers/transactions":30,"./detect-multiple-instances":36,"./lib/ComposableObservableStore":38,"./lib/account-tracker":39,"./lib/backup":40,"./lib/createDupeReqFilterMiddleware":42,"./lib/createLoggerMiddleware":43,"./lib/createMetaRPCHandler":44,"./lib/createMetamaskMiddleware":45,"./lib/createOnboardingMiddleware":46,"./lib/createOriginMiddleware":47,"./lib/createRPCMethodTrackingMiddleware":48,"./lib/createTabIdMiddleware":50,"./lib/keyring-snaps-permissions":58,"./lib/ppom/indexed-db-backend":65,"./lib/ppom/ppom":67,"./lib/ppom/ppom-middleware":66,"./lib/rpc-method-middleware":78,"./lib/security-provider-helpers":79,"./lib/segment":81,"./lib/snap-keyring":85,"./lib/stream-utils":89,"./lib/util":90,"./translate":201,"@keystonehq/metamask-airgapped-keyring":571,"@metamask/address-book-controller":1044,"@metamask/announcement-controller":1046,"@metamask/approval-controller":1049,"@metamask/assets-controllers":1068,"@metamask/base-controller":1139,"@metamask/browser-passworder":1140,"@metamask/controller-utils":1144,"@metamask/eth-json-rpc-middleware":1215,"@metamask/eth-keyring-controller":1237,"@metamask/eth-ledger-bridge-keyring":1263,"@metamask/eth-trezor-keyring":1359,"@metamask/gas-fee-controller":1402,"@metamask/keyring-controller":1492,"@metamask/logging-controller":1513,"@metamask/network-controller":1600,"@metamask/notification-controller":1622,"@metamask/obs-store":1632,"@metamask/obs-store/dist/asStream":1631,"@metamask/permission-controller":1640,"@metamask/phishing-controller":1692,"@metamask/ppom-validator":1694,"@metamask/rate-limit-controller":1699,"@metamask/scure-bip39/dist/wordlists/english":1746,"@metamask/selected-network-controller":1758,"@metamask/signature-controller":1760,"@metamask/smart-transactions-controller":1764,"@metamask/snaps-controllers":1771,"@sentry/browser":2072,"await-semaphore":2679,buffer:2818,"eth-json-rpc-filters":3095,"eth-json-rpc-filters/subscriptionManager":3097,"eth-lattice-keyring":3099,"eth-query":3128,"eth-rpc-errors":3132,events:3237,"json-rpc-engine":3772,"json-rpc-middleware-stream":3776,lodash:3975,loglevel:3987,nanoid:4061,pump:4181},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.METAMASK_CONTROLLER_EVENTS=void 0;var n=We(e("events")),s=We(e("pump")),o=e("@metamask/obs-store"),i=e("@metamask/obs-store/dist/asStream"),a=e("json-rpc-engine"),c=e("json-rpc-middleware-stream"),l=e("@metamask/eth-json-rpc-middleware"),u=e("lodash"),d=e("@metamask/eth-keyring-controller"),h=e("@metamask/keyring-controller"),p=We(e("eth-json-rpc-filters")),f=We(e("eth-json-rpc-filters/subscriptionManager")),g=e("eth-rpc-errors"),m=e("await-semaphore"),y=We(e("loglevel")),b=e("@metamask/eth-trezor-keyring"),w=We(e("@metamask/eth-ledger-bridge-keyring")),v=We(e("eth-lattice-keyring")),k=e("@keystonehq/metamask-airgapped-keyring"),C=We(e("eth-query")),_=We(e("nanoid")),S=e("@sentry/browser"),A=e("@metamask/address-book-controller"),T=e("@metamask/approval-controller"),E=e("@metamask/base-controller"),M=e("@metamask/assets-controllers"),P=e("@metamask/phishing-controller"),N=e("@metamask/announcement-controller"),O=e("@metamask/network-controller"),R=e("@metamask/gas-fee-controller"),I=e("@metamask/permission-controller"),j=We(e("@metamask/smart-transactions-controller")),x=e("@metamask/selected-network-controller"),L=e("@metamask/logging-controller"),D=e("@metamask/browser-passworder"),U=e("@metamask/rate-limit-controller"),B=e("@metamask/notification-controller"),$=e("@metamask/snaps-controllers"),F=e("@metamask/signature-controller"),q=e("@metamask/ppom-validator"),K=e("@metamask/controller-utils"),z=e("@metamask/scure-bip39/dist/wordlists/english"),G=e("../../shared/constants/transaction"),H=e("../../shared/constants/swaps"),V=e("../../shared/constants/network"),W=e("../../shared/constants/hardware-wallets"),Y=e("../../shared/constants/keyring"),J=e("../../shared/constants/permissions"),Q=e("../../shared/notifications"),Z=e("../../shared/constants/time"),X=e("../../shared/constants/app"),ee=e("../../shared/constants/metametrics"),te=e("../../shared/constants/logs"),re=e("../../shared/lib/token-util.ts"),ne=e("../../shared/modules/string-utils"),se=e("../../shared/modules/transaction.utils"),oe=e("../../shared/constants/tokens"),ie=e("../../shared/lib/metamask-controller-utils"),ae=e("../../shared/modules/mv3.utils"),ce=e("../../shared/modules/conversion.utils"),le=e("../../shared/constants/test-flags"),ue=e("./lib/keyring-snaps-permissions"),de=e("./lib/ppom/ppom-middleware"),he=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=Ve(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(e("./lib/ppom/ppom")),pe=e("./detect-multiple-instances"),fe=We(e("./lib/ComposableObservableStore")),ge=We(e("./lib/account-tracker")),me=We(e("./lib/createDupeReqFilterMiddleware")),ye=We(e("./lib/createLoggerMiddleware")),be=e("./lib/rpc-method-middleware"),we=We(e("./lib/createOriginMiddleware")),ve=We(e("./lib/createTabIdMiddleware")),ke=We(e("./lib/createOnboardingMiddleware")),Ce=e("./lib/stream-utils"),_e=We(e("./controllers/ens")),Se=We(e("./controllers/preferences")),Ae=We(e("./controllers/app-state")),Te=We(e("./controllers/cached-balances")),Ee=We(e("./controllers/alert")),Me=We(e("./controllers/onboarding")),Pe=We(e("./lib/backup")),Ne=We(e("./controllers/decrypt-message")),Oe=We(e("./controllers/transactions")),Re=We(e("./controllers/detect-tokens")),Ie=We(e("./controllers/swaps")),je=We(e("./controllers/metametrics")),xe=e("./lib/segment"),Le=We(e("./lib/createMetaRPCHandler")),De=e("./lib/util"),Ue=We(e("./lib/createMetamaskMiddleware")),Be=We(e("./controllers/encryption-public-key")),$e=We(e("./controllers/app-metadata")),Fe=e("./controllers/permissions"),qe=We(e("./lib/createRPCMethodTrackingMiddleware")),Ke=e("./lib/security-provider-helpers"),ze=e("./lib/ppom/indexed-db-backend"),Ge=e("./translate"),He=e("./lib/snap-keyring");function Ve(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Ve=function(e){return e?r:t})(e)}function We(e){return e&&e.__esModule?e:{default:e}}function Ye(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange"};class Je extends n.default{constructor(e){var t;super(),Ye(this,"_trackSnapExportUsage",(0,u.wrap)((0,u.memoize)((()=>(0,u.throttle)(((e,t)=>this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.SnapExportUsed,category:ee.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,export:t}})),60*Z.SECOND)),((e,t)=>`${e}${t}`)),((e,...t)=>e(...t)(...t)))),Ye(this,"handleWatchAssetRequest",(({asset:e,type:t,origin:r,networkClientId:n})=>{switch(t){case K.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:n});case K.ERC721:case K.ERC1155:return this.nftController.watchNft(e,t,r);default:throw new Error(`Asset type ${t} not supported`)}})),Ye(this,"removePermissionsFor",(e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}})),Ye(this,"updateCaveat",((e,t,r,n)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,r,n)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}})),Ye(this,"rejectPermissionsRequest",(e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}})),Ye(this,"acceptPermissionsRequest",(e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof I.PermissionsRequestNotFoundError))throw e}})),Ye(this,"resolvePendingApproval",(async(e,t,r)=>{try{await this.approvalController.accept(e,t,r)}catch(e){if(!(e instanceof T.ApprovalRequestNotFoundError))throw e}})),Ye(this,"rejectPendingApproval",((e,t)=>{try{this.approvalController.reject(e,new g.EthereumRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof T.ApprovalRequestNotFoundError))throw e}}));const{isFirstMetaMaskControllerSetup:r}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,u.debounce)(this.privateSendUpdate.bind(this),200*Z.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const n=e.initState||{},s=this.platform.getVersion();this.recordFirstTimeInfo(n),this.activeControllerConnections=0,this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.controllerMessenger=new E.ControllerMessenger,this.loggingController=new L.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController"}),state:n.LoggingController}),this.localStoreApiWrapper=e.localStore,this.currentMigrationVersion=e.currentMigrationVersion,this.store=new fe.default({state:n,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new m.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&("8.1.0"===s&&this.platform.openExtensionInBrowser(),this.loggingController.add({type:L.LogType.GenericLog,data:{event:te.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:s}}))})),this.appMetadataController=new $e.default({state:n.AppMetadataController,currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:s}),this.selectedNetworkController=new x.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["SelectedNetworkController:getState","SelectedNetworkController:getNetworkClientIdForDomain","SelectedNetworkController:setNetworkClientIdForDomain"],allowedEvents:["SelectedNetworkController:stateChange","NetworkController:stateChange"]})}),this.approvalController=new T.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[K.ApprovalType.EthSign,K.ApprovalType.PersonalSign,K.ApprovalType.EthSignTypedData,K.ApprovalType.Transaction,K.ApprovalType.WatchAsset,K.ApprovalType.EthGetEncryptionPublicKey,K.ApprovalType.EthDecrypt]});const o=this.controllerMessenger.getRestricted({name:"NetworkController",allowedEvents:["NetworkController:stateChange","NetworkController:networkWillChange","NetworkController:networkDidChange","NetworkController:infuraIsBlocked","NetworkController:infuraIsUnblocked"]});let i={};n.NetworkController&&(i=n.NetworkController),this.networkController=new O.NetworkController({messenger:o,state:i,infuraProjectId:e.infuraProjectId,trackMetaMetricsEvent:(...e)=>this.metaMetricsController.trackEvent(...e)}),this.networkController.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker;const a=this.controllerMessenger.getRestricted({name:"TokenListController",allowedEvents:["TokenListController:stateChange","NetworkController:stateChange"]});this.tokenListController=new M.TokenListController({chainId:this.networkController.state.providerConfig.chainId,preventPollingOnNetworkRestart:!n.TokenListController||n.TokenListController.preventPollingOnNetworkRestart,messenger:a,state:n.TokenListController}),this.preferencesController=new Se.default({initState:n.PreferencesController,initLangCode:e.initLangCode,onAccountRemoved:this.controllerMessenger.subscribe.bind(this.controllerMessenger,"KeyringController:accountRemoved"),tokenListController:this.tokenListController,provider:this.provider,networkConfigurations:this.networkController.state.networkConfigurations}),this.assetsContractController=new M.AssetsContractController({chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),onNetworkStateChange:e=>o.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{provider:this.provider},n.AssetsContractController);const c=this.controllerMessenger.getRestricted({name:"TokensController",allowedActions:["ApprovalController:addRequest"],allowedEvents:["NetworkController:stateChange"]});this.tokensController=new M.TokensController({messenger:c,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),onTokenListStateChange:e=>this.controllerMessenger.subscribe(`${this.tokenListController.name}:stateChange`,e),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),getERC20TokenName:this.assetsContractController.getERC20TokenName.bind(this.assetsContractController),config:{provider:this.provider},state:n.TokensController});const l=this.controllerMessenger.getRestricted({name:"NftController",allowedActions:[`${this.approvalController.name}:addRequest`]});this.nftController=new M.NftController({messenger:l,chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),getERC721AssetName:this.assetsContractController.getERC721AssetName.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),getERC721TokenURI:this.assetsContractController.getERC721TokenURI.bind(this.assetsContractController),getERC721OwnerOf:this.assetsContractController.getERC721OwnerOf.bind(this.assetsContractController),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC1155TokenURI:this.assetsContractController.getERC1155TokenURI.bind(this.assetsContractController),onNftAdded:({address:e,symbol:t,tokenId:r,standard:n,source:s})=>this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.NftAdded,category:ee.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:t,token_id:r,token_standard:n,asset_type:G.AssetType.NFT,source:s}})},{},n.NftController),this.nftController.setApiKey(null),this.nftDetectionController=new M.NftDetectionController({chainId:this.networkController.state.providerConfig.chainId,onNftsStateChange:e=>this.nftController.subscribe(e),onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),getOpenSeaApiKey:()=>this.nftController.openSeaApiKey,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),addNft:this.nftController.addNft.bind(this.nftController),getNftState:()=>this.nftController.state}),this.metaMetricsController=new je.default({segment:xe.segment,preferencesStore:this.preferencesController.store,onNetworkDidChange:o.subscribe.bind(o,"NetworkController:networkDidChange"),getNetworkIdentifier:()=>{const{type:e,rpcUrl:t}=this.networkController.state.providerConfig;return e===V.NETWORK_TYPES.RPC?t:e},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,version:this.platform.getVersion(),environment:"production",extension:this.extension,initState:n.MetaMetricsController,captureException:S.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const p=this.controllerMessenger.getRestricted({name:"GasFeeController"}),f=H.GAS_API_BASE_URL;this.gasFeeController=new R.GasFeeController({state:n.GasFeeController,interval:1e4,messenger:p,clientId:H.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkStateChange:e=>{o.subscribe("NetworkController:networkDidChange",(()=>e(this.networkController.state)))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${f}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${f}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>{const{chainId:e}=this.networkController.state.providerConfig;return e===V.CHAIN_IDS.BSC},getChainId:()=>this.networkController.state.providerConfig.chainId}),this.appStateController=new Ae.default({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:n.AppStateController,onInactiveTimeout:()=>this.setLocked(),preferencesStore:this.preferencesController.store,messenger:this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`],allowedEvents:["KeyringController:qrKeyringStateChange"]}),extension:this.extension});const C=this.controllerMessenger.getRestricted({name:"CurrencyRateController"});this.currencyRateController=new M.CurrencyRateController({includeUsdRate:!0,messenger:C,state:{...n.CurrencyController,nativeCurrency:this.networkController.state.providerConfig.ticker}}),this.phishingController=new P.PhishingController({},n.PhishingController),this.phishingController.maybeUpdateState(),this.ppomController=new q.PPOMController({messenger:this.controllerMessenger.getRestricted({name:"PPOMController"}),storageBackend:new ze.IndexedDBPPOMStorage("PPOMDB",1),provider:this.provider,ppomProvider:{PPOM:he.PPOM,ppomInit:he.default},state:n.PPOMController,chainId:this.networkController.state.providerConfig.chainId,onNetworkChange:o.subscribe.bind(o,"NetworkController:stateChange"),securityAlertsEnabled:this.preferencesController.store.getState().securityAlertsEnabled,onPreferencesChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),cdnBaseUrl:"static.metafi.codefi.network/api/v1/confirmations/ppom",blockaidPublicKey:"066ad3e8af5583385e312c156d238055215d5f25247c1e91055afa756cb98a88"});const _=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new N.AnnouncementController({messenger:_,allAnnouncements:Q.UI_NOTIFICATIONS,state:n.AnnouncementController}),this.tokenRatesController=new M.TokenRatesController({chainId:this.networkController.state.providerConfig.chainId,ticker:this.networkController.state.providerConfig.ticker,selectedAddress:this.preferencesController.getSelectedAddress(),onTokensStateChange:e=>this.tokensController.subscribe(e),onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store)},{},n.TokenRatesController),this.preferencesController.store.getState().useCurrencyRateCheck&&this.tokenRatesController.start(),this.preferencesController.store.subscribe((0,De.previousValueComparator)(((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:n}=t;n&&!r?(this.currencyRateController.start(),this.tokenRatesController.start()):!n&&r&&(this.currencyRateController.stop(),this.tokenRatesController.stop())}),this.preferencesController.store.getState())),this.ensController=new _e.default({provider:this.provider,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,onNetworkDidChange:o.subscribe.bind(o,"NetworkController:networkDidChange")}),this.onboardingController=new Me.default({initState:n.OnboardingController}),this.accountTracker=new ge.default({provider:this.provider,blockTracker:this.blockTracker,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getNetworkIdentifier:()=>{const{type:e,rpcUrl:t}=this.networkController.state.providerConfig;return e===V.NETWORK_TYPES.RPC?t:e},preferencesController:this.preferencesController,onboardingController:this.onboardingController,initState:ae.isManifestV3&&!1===r&&null!==(t=n.AccountTracker)&&void 0!==t&&t.accounts?{accounts:n.AccountTracker.accounts}:{accounts:{}},onAccountRemoved:this.controllerMessenger.subscribe.bind(this.controllerMessenger,"KeyringController:accountRemoved")}),this.on("controllerConnectionChanged",(e=>{const{completedOnboarding:t}=this.onboardingController.store.getState();e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()})),this.onboardingController.store.subscribe((0,De.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;!r&&n&&this.triggerNetworkrequests()}),this.onboardingController.store.getState())),this.cachedBalancesController=new Te.default({accountTracker:this.accountTracker,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,initState:n.CachedBalancesController});let D=[(0,d.keyringBuilderFactory)(k.MetaMaskKeyring)];if(this.canUseHardwareWallets()){var z;const e=null===(z=this.opts.overrides)||void 0===z?void 0:z.keyrings;D=[(null==e?void 0:e.trezor)||b.TrezorKeyring,(null==e?void 0:e.ledger)||w.default,(null==e?void 0:e.lattice)||v.default,k.MetaMaskKeyring].map((e=>(0,d.keyringBuilderFactory)(e)))}D.push((0,He.snapKeyringBuilder)((()=>this.snapController),(()=>this.approvalController),(()=>this.keyringController),(()=>this.preferencesController),(()=>this.phishingController),(e=>this.removeAccount(e))));const W=this.controllerMessenger.getRestricted({name:"KeyringController",allowedActions:["KeyringController:getState","KeyringController:signMessage","KeyringController:signPersonalMessage","KeyringController:signTypedMessage","KeyringController:decryptMessage","KeyringController:getEncryptionPublicKey","KeyringController:getKeyringsByType","KeyringController:getKeyringForAccount","KeyringController:getAccounts"],allowedEvents:["KeyringController:stateChange","KeyringController:lock","KeyringController:unlock","KeyringController:accountRemoved","KeyringController:qrKeyringStateChange"]});this.keyringController=new h.KeyringController({keyringBuilders:D,state:n.KeyringController,encryptor:e.encryptor||undefined,cacheEncryptionKey:ae.isManifestV3,messenger:W,removeIdentity:this.preferencesController.removeAddress.bind(this.preferencesController),setAccountLabel:this.preferencesController.setAccountLabel.bind(this.preferencesController),setSelectedAddress:this.preferencesController.setSelectedAddress.bind(this.preferencesController),syncIdentities:this.preferencesController.syncAddresses.bind(this.preferencesController),updateIdentities:this.preferencesController.setAddresses.bind(this.preferencesController)}),this.controllerMessenger.subscribe("KeyringController:unlock",(()=>this._onUnlock())),this.controllerMessenger.subscribe("KeyringController:lock",(()=>this._onLock())),this.controllerMessenger.subscribe("KeyringController:stateChange",(e=>{this._onKeyringControllerUpdate(e)}));const Y=()=>this.preferencesController.store.getState().identities;this.permissionController=new I.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:n.PermissionController,caveatSpecifications:(0,Fe.getCaveatSpecifications)({getIdentities:Y}),permissionSpecifications:{...(0,Fe.getPermissionSpecifications)({getIdentities:Y,getAllAccounts:this.keyringController.getAccounts.bind(this.keyringController),captureKeyringTypesWithMissingIdentities:(e={},t=[])=>{const r=t.filter((t=>!e[t])).map((e=>this.keyringController.getAccountKeyringType(e))),n=Object.keys(e||{}).length,s=Object.keys(this.accountTracker.store.getState().accounts||{}).length;(0,S.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}}),...this.getSnapPermissionSpecifications()},unrestrictedMethods:Fe.unrestrictedMethods}),this.permissionLogController=new Fe.PermissionLogController({restrictedMethods:new Set(Object.keys(J.RestrictedMethods)),initState:n.PermissionLogController}),this.subjectMetadataController=new I.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:n.SubjectMetadataController,subjectCacheLimit:100});const oe={iframeUrl:new URL("https://execution.consensys.io/3.0.0/index.html"),messenger:this.controllerMessenger.getRestricted({name:"ExecutionService"}),setupSnapProvider:this.setupSnapProvider.bind(this)};this.snapExecutionService=new $.IframeExecutionService(oe);const ce=this.controllerMessenger.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse","SnapController:snapInstalled","SnapController:snapUpdated"],allowedActions:[`${this.permissionController.name}:getEndowments`,`${this.permissionController.name}:getPermissions`,`${this.permissionController.name}:hasPermission`,`${this.permissionController.name}:hasPermissions`,`${this.permissionController.name}:requestPermissions`,`${this.permissionController.name}:revokeAllPermissions`,`${this.permissionController.name}:revokePermissions`,`${this.permissionController.name}:revokePermissionForAllSubjects`,`${this.permissionController.name}:getSubjectNames`,`${this.permissionController.name}:updateCaveat`,`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:updateRequestState`,`${this.permissionController.name}:grantPermissions`,`${this.subjectMetadataController.name}:getSubjectMetadata`,"ExecutionService:executeSnap","ExecutionService:getRpcRequestHandler","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update"]}),le=!0;this.snapController=new $.SnapController({environmentEndowmentPermissions:Object.values(J.EndowmentPermissions),excludedPermissions:{...J.ExcludedSnapPermissions,...J.ExcludedSnapEndowments},closeAllConnections:this.removeAllConnections.bind(this),state:n.SnapController,messenger:ce,featureFlags:{dappsCanUpdateSnaps:!0,allowLocalSnaps:!1,requireAllowlist:le}}),this.notificationController=new B.NotificationController({messenger:this.controllerMessenger.getRestricted({name:"NotificationController"}),state:n.NotificationController}),this.rateLimitController=new U.RateLimitController({state:n.RateLimitController,messenger:this.controllerMessenger.getRestricted({name:"RateLimitController"}),implementations:{showNativeNotification:{method:(e,t)=>{const r=this.controllerMessenger.call("SubjectMetadataController:getState").subjectMetadata[e];return this.platform._showNotification((null==r?void 0:r.name)??e,t).catch((e=>{y.default.error("Failed to create notification",e)})),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,t)=>(this.controllerMessenger.call("NotificationController:show",e,t),null),rateLimitCount:5,rateLimitTimeout:6e4}}});const ue=this.controllerMessenger.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapRemoved","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:[`${this.permissionController.name}:getPermissions`,"SnapController:handleRequest","SnapController:getAll"]});this.cronjobController=new $.CronjobController({state:n.CronjobController,messenger:ue});const de=this.controllerMessenger.getRestricted({name:"SnapsRegistry",allowedEvents:[],allowedActions:[]});this.snapsRegistry=new $.JsonSnapsRegistry({state:n.SnapsRegistry,messenger:de,refetchOnAllowlistMiss:le,failOnUnavailableRegistry:le,url:{registry:"https://acl.execution.consensys.io/latest/registry.json",signature:"https://acl.execution.consensys.io/latest/signature.json"},publicKey:"0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6"});const me=this.controllerMessenger.getRestricted({name:"DetectTokensController",allowedActions:["KeyringController:getState"],allowedEvents:["NetworkController:stateChange","KeyringController:lock","KeyringController:unlock"]});if(this.detectTokensController=new Re.default({messenger:me,preferences:this.preferencesController,tokensController:this.tokensController,assetsContractController:this.assetsContractController,network:this.networkController,tokenList:this.tokenListController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.addressBookController=new A.AddressBookController(undefined,n.AddressBookController),this.alertController=new Ee.default({initState:n.AlertController,preferencesStore:this.preferencesController.store}),this.backup=new Pe.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,networkController:this.networkController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.snapAndHardwareMetricsParams={getSelectedAddress:this.preferencesController.getSelectedAddress.bind(this.preferencesController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get"]})},this.txController=new Oe.default({initState:n.TransactionController||n.TransactionManager,getPermittedAccounts:this.getPermittedAccounts.bind(this),getProviderConfig:()=>this.networkController.state.providerConfig,getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),getNetworkId:()=>this.networkController.state.networkId,getNetworkStatus:()=>{var e;return null===(e=this.networkController.state.networksMetadata)||void 0===e||null===(e=e[this.networkController.state.selectedNetworkClientId])||void 0===e?void 0:e.status},getNetworkState:()=>this.networkController.state,hasCompletedOnboarding:()=>this.onboardingController.store.getState().completedOnboarding,onNetworkStateChange:e=>{o.subscribe("NetworkController:stateChange",(()=>e()),(({networkId:e})=>e))},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,preferencesStore:this.preferencesController.store,txHistoryLimit:60,signTransaction:this.keyringController.signTransaction.bind(this.keyringController),provider:this.provider,blockTracker:this.blockTracker,createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getExternalPendingTransactions:this.getExternalPendingTransactions.bind(this),getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),securityProviderRequest:this.securityProviderRequest.bind(this),...this.snapAndHardwareMetricsParams,messenger:this.controllerMessenger.getRestricted({name:"TransactionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]})}),this.txController.on("tx:status-update",(async(e,t)=>{if(t===G.TransactionStatus.confirmed||t===G.TransactionStatus.failed){const t=this.txController.txStateManager.getTransaction(e);let s={};if(t.chainId){const{networkConfigurations:e}=this.networkController.state,r=Object.values(e).find((e=>e.chainId===t.chainId));s=(null==r?void 0:r.rpcPrefs)??{}}try{await this.platform.showTransactionNotification(t,s)}catch(e){y.default.error("Failed to create transaction notification",e)}const{txReceipt:o}=t;if(t.type===G.TransactionType.tokenMethodTransferFrom&&t.txParams!==undefined){var r;const{data:e,to:n,from:s}=t.txParams,{chainId:o}=t,i=(0,se.parseStandardTokenTransactionData)(e),a=(0,re.getTokenIdParam)(i)??(0,ie.getTokenValueParam)(i),{allNfts:c}=this.nftController.state,l=null==c||null===(r=c[s])||void 0===r||null===(r=r[o])||void 0===r?void 0:r.find((({address:e,tokenId:t})=>(0,ne.isEqualCaseInsensitive)(e,n)&&t===a));l&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(l,!1,{userAddress:s,chainId:o})}const i=this.getState();var n;if(o&&"0x0"===o.status)this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:ee.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(n=t.simulationFails)||void 0===n?void 0:n.reason,numberOfTokens:i.tokens.length,numberOfAccounts:Object.keys(i.accounts).length}},{matomoEvent:!0})}})),o.subscribe("NetworkController:networkDidChange",(async()=>{const{ticker:e}=this.networkController.state.providerConfig;try{await this.currencyRateController.setNativeCurrency(e)}catch(e){console.error(e)}})),this.networkController.lookupNetwork(),this.decryptMessageController=new Ne.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`]}),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyController=new Be.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.signatureController=new F.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`]}),isEthSignEnabled:()=>{var e;return null===(e=this.preferencesController.store.getState())||void 0===e||null===(e=e.disabledRpcMethodPreferences)||void 0===e?void 0:e.eth_sign},getAllState:this.getState.bind(this),securityProviderRequest:this.securityProviderRequest.bind(this),getCurrentChainId:()=>this.networkController.state.providerConfig.chainId}),this.signatureController.hub.on("cancelWithReason",(({message:e,reason:t})=>{this.metaMetricsController.trackEvent({event:t,category:ee.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})})),this.swapsController=new Ie.default({getBufferedGasLimit:this.txController.txGasUtil.getBufferedGasLimit.bind(this.txController.txGasUtil),networkController:this.networkController,onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),provider:this.provider,getProviderConfig:()=>this.networkController.state.providerConfig,getTokenRatesState:()=>this.tokenRatesController.state,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},n.SwapsController),this.smartTransactionsController=new j.default({onNetworkStateChange:o.subscribe.bind(o,"NetworkController:stateChange"),getNetwork:()=>this.networkController.state.networkId??"loading",getNonceLock:this.txController.nonceTracker.getNonceLock.bind(this.txController.nonceTracker),confirmExternalTransaction:this.txController.confirmExternalTransaction.bind(this.txController),provider:this.provider,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},{supportedChainIds:[V.CHAIN_IDS.MAINNET,V.CHAIN_IDS.GOERLI]},n.SmartTransactionsController),this.txController.on("newSwapApproval",(e=>{this.swapsController.setApproveTxId(e.id)})),this.txController.on("newSwap",(e=>{this.swapsController.setTradeTxId(e.id)})),o.subscribe("NetworkController:networkDidChange",(()=>{this.accountTracker._updateAccounts()})),o.subscribe("NetworkController:networkWillChange",(()=>{this.txController.txStateManager.clearUnapprovedTxs(),this.encryptionPublicKeyController.clearUnapproved(),this.decryptMessageController.clearUnapproved(),this.signatureController.clearUnapproved(),this.approvalController.clear()})),ae.isManifestV3&&globalThis.isFirstTimeProfileLoaded===undefined){const{serviceWorkerLastActiveTime:e}=this.appStateController.store.getState(),t={category:ee.MetaMetricsEventCategory.ServiceWorkers,event:ee.MetaMetricsEventName.ServiceWorkerRestarted,properties:{service_worker_restarted_time:Date.now()-e}};try{this.metaMetricsController.trackEvent(t)}catch(e){y.default.warn("Failed to track service worker restart metric:",e)}}this.metamaskMiddleware=(0,Ue.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${s}`},version:s,getAccounts:async({origin:e},{suppressUnauthorizedError:t=!0}={})=>{if(e===X.ORIGIN_METAMASK){const e=this.preferencesController.getSelectedAddress();return e?[e]:[]}return this.isUnlocked()?await this.getPermittedAccounts(e,{suppressUnauthorizedError:t}):[]},processTransaction:this.newUnapprovedTransaction.bind(this),processEthSignMessage:this.signatureController.newUnsignedMessage.bind(this.signatureController),processTypedMessage:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV3:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV4:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processPersonalMessage:this.signatureController.newUnsignedPersonalMessage.bind(this.signatureController),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.getTransactions({searchCriteria:{hash:e,status:G.TransactionStatus.submitted}})[0]}),this.on("update",(e=>this._onStateUpdate(e)));const ye={AccountTracker:this.accountTracker.store,TxController:this.txController.memStore,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController.store,EnsController:this.ensController.store,ApprovalController:this.approvalController,PPOMController:this.ppomController};this.store.updateStructure({AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,TransactionController:this.txController.store,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,NetworkController:this.networkController,CachedBalancesController:this.cachedBalancesController.store,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController.store,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,PPOMController:this.ppomController,...ye}),this.memStore=new fe.default({config:{AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,NetworkController:this.networkController,CachedBalancesController:this.cachedBalancesController.store,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController.store,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,...ye},controllerMessenger:this.controllerMessenger});const be=[this.accountTracker.resetState,this.txController.resetState,this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState,this.ensController.resetState,this.approvalController.clear.bind(this.approvalController)];ae.isManifestV3?!0===r&&(this.resetStates(be),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(be),!this.isUnlocked()&&this.onboardingController.store.getState().completedOnboarding?this._loginUser():this._startUISync(),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(pe.onMessageReceived),(0,pe.checkForMultipleVersionsRunning)()}triggerNetworkrequests(){this.accountTracker.start(),this.txController.startIncomingTransactionPolling(),this.preferencesController.store.getState().useCurrencyRateCheck&&this.currencyRateController.start(),this.preferencesController.store.getState().useTokenDetection&&this.tokenListController.start()}stopNetworkRequests(){this.accountTracker.stop(),this.txController.stopIncomingTransactionPolling(),this.preferencesController.store.getState().useCurrencyRateCheck&&this.currencyRateController.stop(),this.preferencesController.store.getState().useTokenDetection&&this.tokenListController.stop()}canUseHardwareWallets(){return!ae.isManifestV3||!1}resetStates(e){e.forEach((e=>{try{e()}catch(e){console.error(e)}}))}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(Y.KeyringType.snap);return e||(e=await this.keyringController.addNewKeyring(Y.KeyringType.snap)),e}handleSnapRequest(e){return this._trackSnapExportUsage(e.snapId,e.handler),this.controllerMessenger.call("SnapController:handleRequest",e)}getLocale(){const{currentLocale:e}=this.preferencesController.store.getState();return e}getSnapPermissionSpecifications(){return{...(0,Fe.buildSnapEndowmentSpecifications)(),...(0,Fe.buildSnapRestrictedMethodSpecifications)({encrypt:D.encrypt,decrypt:D.decrypt,getLocale:this.getLocale.bind(this),clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),showDialog:(e,t,r,n)=>this.approvalController.addAndShowApprovalRequest({origin:e,type:X.SNAP_DIALOG_TYPES[t],requestData:{content:r,placeholder:n}}),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,t.message),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),getSnapKeyring:this.getSnapKeyring.bind(this)})}}dismissNotifications(e){this.notificationController.dismiss(e)}markNotificationsAsRead(e){this.notificationController.markRead(e)}setupControllerEventSubscriptions(){let e;this.preferencesController.store.subscribe((async t=>{var r;const{selectedAddress:n,currentLocale:s}=t,{chainId:o}=this.networkController.state.providerConfig;await(0,Ge.updateCurrentLocale)(s),null!==(r=t.incomingTransactionsPreferences)&&void 0!==r&&r[o]?this.txController.startIncomingTransactionPolling():this.txController.stopIncomingTransactionPolling(),n&&n!==e&&(e=n,await this._onAccountChange(n))})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const r=(0,Fe.getChangedAccounts)(e,t);for(const[e,t]of r.entries())this._notifyAccountsChange(e,t)}),Fe.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkDidChange",(async()=>{await this.txController.updateIncomingTransactions()})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapAdded`,((e,t=null)=>{const{manifest:{proposedName:r},version:n}=e;this.subjectMetadataController.addSubjectMetadata({subjectType:I.SubjectType.Snap,name:r,origin:e.id,version:n,svgIcon:t})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,(e=>{this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.SnapInstalled,category:ee.MetaMetricsEventCategory.Snaps,properties:{snap_id:e.id,version:e.version}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,((e,t)=>{this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.SnapUpdated,category:ee.MetaMetricsEventCategory.Snaps,properties:{snap_id:e.id,old_version:t,new_version:e.version}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,(e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter((t=>t.origin===e.id&&t.type.startsWith(J.RestrictedMethods.snap_dialog)));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapRemoved`,(e=>{const t=Object.values(this.notificationController.state.notifications).reduce(((t,r)=>(r.origin===e.id&&t.push(r.id),t)),[]);this.dismissNotifications(t)})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,(e=>{this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.SnapUninstalled,category:ee.MetaMetricsEventCategory.Snaps,properties:{snap_id:e.id,version:e.version}})}))}createPublicConfigStore(){const e=new o.ObservableStore,{networkController:t}=this;function r(r){var n;const s=null===(n=r.networksMetadata[r.selectedNetworkClientId])||void 0===n?void 0:n.status,{chainId:o}=t.state.providerConfig;s===V.NetworkStatus.Available&&e.putState(function(e,{isUnlocked:t,networkId:r}){return{isUnlocked:t,chainId:e,networkVersion:r??"loading"}}(o,r))}return this.on("update",r),r(this.getState()),e}async getProviderState(e){return{isUnlocked:this.isUnlocked(),...this.getProviderNetworkState(),accounts:await this.getPermittedAccounts(e)}}getProviderNetworkState(e){const{networkId:t}=e||this.getState();return{chainId:this.networkController.state.providerConfig.chainId,networkVersion:t??"loading"}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),r=this.memStore.getFlatState();return delete r.vault,{isInitialized:t,...r,snapStates:{},snaps:Object.values(r.snaps??{}).reduce(((e,t)=>{const{sourceCode:r,...n}=t;return e[t.id]=n,e}),{})}}getApi(){const{addressBookController:e,alertController:t,appStateController:r,keyringController:n,nftController:s,nftDetectionController:o,currencyRateController:i,detectTokensController:a,ensController:c,gasFeeController:l,metaMetricsController:u,networkController:d,announcementController:h,onboardingController:p,permissionController:f,preferencesController:g,swapsController:m,tokensController:y,smartTransactionsController:b,txController:w,assetsContractController:v,backup:k,approvalController:C,phishingController:_}=this;return{getState:this.getState.bind(this),setCurrentCurrency:i.setCurrentCurrency.bind(i),setUseBlockie:g.setUseBlockie.bind(g),setUseNonceField:g.setUseNonceField.bind(g),setUsePhishDetect:g.setUsePhishDetect.bind(g),setUseMultiAccountBalanceChecker:g.setUseMultiAccountBalanceChecker.bind(g),setUseSafeChainsListValidation:g.setUseSafeChainsListValidation.bind(g),setUseTokenDetection:g.setUseTokenDetection.bind(g),setUseNftDetection:g.setUseNftDetection.bind(g),setUse4ByteResolution:g.setUse4ByteResolution.bind(g),setUseCurrencyRateCheck:g.setUseCurrencyRateCheck.bind(g),setOpenSeaEnabled:g.setOpenSeaEnabled.bind(g),setSecurityAlertsEnabled:g.setSecurityAlertsEnabled.bind(g),setAddSnapAccountEnabled:g.setAddSnapAccountEnabled.bind(g),setIpfsGateway:g.setIpfsGateway.bind(g),setUseAddressBarEnsResolution:g.setUseAddressBarEnsResolution.bind(g),setParticipateInMetaMetrics:u.setParticipateInMetaMetrics.bind(u),setCurrentLocale:g.setCurrentLocale.bind(g),setIncomingTransactionsPreferences:g.setIncomingTransactionsPreferences.bind(g),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),requestUserApproval:C.addAndShowApprovalRequest.bind(C),addNewAccount:this.addNewAccount.bind(this),verifySeedPhrase:this.verifySeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getAccountsBySnapId:e=>(0,He.getAccountsBySnapId)(this,e),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),setLedgerTransportPreference:this.setLedgerTransportPreference.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),establishLedgerTransportPreference:this.establishLedgerTransportPreference.bind(this),submitQRHardwareCryptoHDKey:n.submitQRCryptoHDKey.bind(n),submitQRHardwareCryptoAccount:n.submitQRCryptoAccount.bind(n),cancelSyncQRHardware:n.cancelQRSynchronization.bind(n),submitQRHardwareSignature:n.submitQRSignature.bind(n),cancelQRHardwareSignRequest:n.cancelQRSignRequest.bind(n),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setProviderType:d.setProviderType.bind(d),rollbackToPreviousProvider:d.rollbackToPreviousProvider.bind(d),removeNetworkConfiguration:d.removeNetworkConfiguration.bind(d),setActiveNetwork:d.setActiveNetwork.bind(d),upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),setSelectedAddress:g.setSelectedAddress.bind(g),addToken:y.addToken.bind(y),updateTokenType:y.updateTokenType.bind(y),setAccountLabel:g.setAccountLabel.bind(g),setFeatureFlag:g.setFeatureFlag.bind(g),setPreference:g.setPreference.bind(g),addKnownMethodData:g.addKnownMethodData.bind(g),setDismissSeedBackUpReminder:g.setDismissSeedBackUpReminder.bind(g),setDisabledRpcMethodPreference:g.setDisabledRpcMethodPreference.bind(g),getRpcMethodPreferences:g.getRpcMethodPreferences.bind(g),setAdvancedGasFee:g.setAdvancedGasFee.bind(g),setTheme:g.setTheme.bind(g),setTransactionSecurityCheckEnabled:g.setTransactionSecurityCheckEnabled.bind(g),setSnapsAddSnapAccountModalDismissed:g.setSnapsAddSnapAccountModalDismissed.bind(g),getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),addNft:s.addNft.bind(s),addNftVerifyOwnership:s.addNftVerifyOwnership.bind(s),removeAndIgnoreNft:s.removeAndIgnoreNft.bind(s),removeNft:s.removeNft.bind(s),checkAndUpdateAllNftsOwnershipStatus:s.checkAndUpdateAllNftsOwnershipStatus.bind(s),checkAndUpdateSingleNftOwnershipStatus:s.checkAndUpdateSingleNftOwnershipStatus.bind(s),isNftOwner:s.isNftOwner.bind(s),setAddressBook:e.set.bind(e),removeFromAddressBook:e.delete.bind(e),setLastActiveTime:r.setLastActiveTime.bind(r),setDefaultHomeActiveTabName:r.setDefaultHomeActiveTabName.bind(r),setConnectedStatusPopoverHasBeenShown:r.setConnectedStatusPopoverHasBeenShown.bind(r),setRecoveryPhraseReminderHasBeenShown:r.setRecoveryPhraseReminderHasBeenShown.bind(r),setRecoveryPhraseReminderLastShown:r.setRecoveryPhraseReminderLastShown.bind(r),setTermsOfUseLastAgreed:r.setTermsOfUseLastAgreed.bind(r),setSnapsInstallPrivacyWarningShownStatus:r.setSnapsInstallPrivacyWarningShownStatus.bind(r),setOutdatedBrowserWarningLastShown:r.setOutdatedBrowserWarningLastShown.bind(r),setShowTestnetMessageInDropdown:r.setShowTestnetMessageInDropdown.bind(r),setShowBetaHeader:r.setShowBetaHeader.bind(r),setShowProductTour:r.setShowProductTour.bind(r),updateNftDropDownState:r.updateNftDropDownState.bind(r),setFirstTimeUsedNetwork:r.setFirstTimeUsedNetwork.bind(r),tryReverseResolveAddress:c.reverseResolveAddress.bind(c),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:w.updateTransaction.bind(w),approveTransactionsWithSameNonce:w.approveTransactionsWithSameNonce.bind(w),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),getNextNonce:this.getNextNonce.bind(this),addTransaction:this.addTransaction.bind(this),addTransactionAndWaitForPublish:this.addTransactionAndWaitForPublish.bind(this),createTransactionEventFragment:w.createTransactionEventFragment.bind(w),getTransactions:w.getTransactions.bind(w),updateEditableParams:w.updateEditableParams.bind(w),updateTransactionGasFees:w.updateTransactionGasFees.bind(w),updateTransactionSendFlowHistory:w.updateTransactionSendFlowHistory.bind(w),updatePreviousGasParams:w.updatePreviousGasParams.bind(w),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setSeedPhraseBackedUp:p.setSeedPhraseBackedUp.bind(p),completeOnboarding:p.completeOnboarding.bind(p),setFirstTimeFlowType:p.setFirstTimeFlowType.bind(p),setAlertEnabledness:t.setAlertEnabledness.bind(t),setUnconnectedAccountAlertShown:t.setUnconnectedAccountAlertShown.bind(t),setWeb3ShimUsageAlertDismissed:t.setWeb3ShimUsageAlertDismissed.bind(t),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,Fe.getPermissionBackgroundApiMethods)(f),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),dismissNotifications:this.dismissNotifications.bind(this),markNotificationsAsRead:this.markNotificationsAsRead.bind(this),updateCaveat:this.updateCaveat.bind(this),getPhishingResult:async e=>(await _.maybeUpdateState(),_.test(e)),updateSnapRegistry:this.preferencesController.updateSnapRegistry.bind(g),fetchAndSetQuotes:m.fetchAndSetQuotes.bind(m),setSelectedQuoteAggId:m.setSelectedQuoteAggId.bind(m),resetSwapsState:m.resetSwapsState.bind(m),setSwapsTokens:m.setSwapsTokens.bind(m),clearSwapsQuotes:m.clearSwapsQuotes.bind(m),setApproveTxId:m.setApproveTxId.bind(m),setTradeTxId:m.setTradeTxId.bind(m),setSwapsTxGasPrice:m.setSwapsTxGasPrice.bind(m),setSwapsTxGasLimit:m.setSwapsTxGasLimit.bind(m),setSwapsTxMaxFeePerGas:m.setSwapsTxMaxFeePerGas.bind(m),setSwapsTxMaxFeePriorityPerGas:m.setSwapsTxMaxFeePriorityPerGas.bind(m),safeRefetchQuotes:m.safeRefetchQuotes.bind(m),stopPollingForQuotes:m.stopPollingForQuotes.bind(m),setBackgroundSwapRouteState:m.setBackgroundSwapRouteState.bind(m),resetPostFetchState:m.resetPostFetchState.bind(m),setSwapsErrorKey:m.setSwapsErrorKey.bind(m),setInitialGasEstimate:m.setInitialGasEstimate.bind(m),setCustomApproveTxData:m.setCustomApproveTxData.bind(m),setSwapsLiveness:m.setSwapsLiveness.bind(m),setSwapsFeatureFlags:m.setSwapsFeatureFlags.bind(m),setSwapsUserFeeLevel:m.setSwapsUserFeeLevel.bind(m),setSwapsQuotesPollingLimitEnabled:m.setSwapsQuotesPollingLimitEnabled.bind(m),setSmartTransactionsOptInStatus:b.setOptInState.bind(b),fetchSmartTransactionFees:b.getFees.bind(b),clearSmartTransactionFees:b.clearFees.bind(b),submitSignedTransactions:b.submitSignedTransactions.bind(b),cancelSmartTransaction:b.cancelSmartTransaction.bind(b),fetchSmartTransactionsLiveness:b.fetchLiveness.bind(b),updateSmartTransaction:b.updateSmartTransaction.bind(b),setStatusRefreshInterval:b.setStatusRefreshInterval.bind(b),trackMetaMetricsEvent:u.trackEvent.bind(u),trackMetaMetricsPage:u.trackPage.bind(u),createEventFragment:u.createEventFragment.bind(u),updateEventFragment:u.updateEventFragment.bind(u),finalizeEventFragment:u.finalizeEventFragment.bind(u),resolvePendingApproval:this.resolvePendingApproval,rejectPendingApproval:this.rejectPendingApproval,updateViewedNotifications:h.updateViewed.bind(h),getGasFeeEstimatesAndStartPolling:l.getGasFeeEstimatesAndStartPolling.bind(l),disconnectGasFeeEstimatePoller:l.disconnectPoller.bind(l),getGasFeeTimeEstimate:l.getTimeEstimate.bind(l),addPollingTokenToAppState:r.addPollingToken.bind(r),removePollingTokenFromAppState:r.removePollingToken.bind(r),backupUserData:k.backupUserData.bind(k),restoreUserData:k.restoreUserData.bind(k),detectNewTokens:a.detectNewTokens.bind(a),detectNfts:o.detectNfts.bind(o),addDetectedTokens:y.addDetectedTokens.bind(y),addImportedTokens:y.addTokens.bind(y),ignoreTokens:y.ignoreTokens.bind(y),getBalancesInSingleCall:v.getBalancesInSingleCall.bind(v),throwTestError:this.throwTestError.bind(this)}}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,r){var n,s;const{tokenList:o}=this.tokenListController.state,{tokens:i}=this.tokensController.state,a={...oe.STATIC_MAINNET_TOKEN_LIST[e.toLowerCase()]||{},...o[e.toLowerCase()]||{},...i.find((({address:t})=>(0,ne.isEqualCaseInsensitive)(t,e)))||{}},c=(0,ne.isEqualCaseInsensitive)(a.standard,G.TokenStandard.ERC20)||!0===a.erc20,l=!(r||(0,ne.isEqualCaseInsensitive)(a.standard,G.TokenStandard.ERC1155)||(0,ne.isEqualCaseInsensitive)(a.standard,G.TokenStandard.ERC721)||a.erc721),u=a.decimals!==undefined&&a.symbol;let d;if(c||l&&u)try{const r=await(0,re.fetchTokenBalance)(e,t,this.provider);d={address:e,balance:r,standard:G.TokenStandard.ERC20,decimals:a.decimals,symbol:a.symbol}}catch(e){y.default.warning(`Failed to get token balance. Error: ${e}`)}return d===undefined&&(d=await this.assetsContractController.getTokenStandardAndDetails(e,t,r)),{...d,decimals:null===(n=d)||void 0===n||null===(n=n.decimals)||void 0===n?void 0:n.toString(10),balance:null===(s=d)||void 0===s||null===(s=s.balance)||void 0===s?void 0:s.toString(10)}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{const t=await this.keyringController.createNewVaultAndKeychain(e),r=await this.keyringController.getAccounts();return this.preferencesController.setAddresses(r),this.selectFirstIdentity(),t}finally{t()}}async createNewVaultAndRestore(e,r){const n=await this.createVaultMutex.acquire();try{let n,s;const o=t.from(r);this.preferencesController.setAddresses([]),this.permissionController.clearState(),this.snapController.clearState(),this.notificationController.clear(),this.accountTracker.clearAccounts(),this.cachedBalancesController.clearCachedBalances(),this.txController.txStateManager.clearUnapprovedTxs();const i=await this.keyringController.createNewVaultAndRestore(e,this._convertMnemonicToWordlistIndices(o)),a=new C.default(this.provider);for(n=await this.keyringController.getAccounts(),s=await this.getBalance(n[n.length-1],a);"0x0"!==s;){const{addedAccountAddress:e}=await this.keyringController.addNewAccount(n.length);n=await this.keyringController.getAccounts(),s=await this.getBalance(e,a)}n.length>1&&"0x0"===s&&(await this.removeAccount(n[n.length-1]),n=await this.keyringController.getAccounts());const c=this.preferencesController.getLedgerTransportPreference();return this.setLedgerTransportPreference(c),this.selectFirstIdentity(),i}finally{n()}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map((e=>z.wordlist.indexOf(e)));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return t.from(Array.from(new Uint16Array(e.buffer)).map((e=>z.wordlist[e])).join(" "))}getBalance(e,t){return new Promise(((r,n)=>{const s=this.accountTracker.store.getState().accounts[e];s&&s.balance?r(s.balance):t.getBalance(e,((e,t)=>{e?(n(e),y.default.error(e)):r(t||"0x0")}))}))}async submitPassword(e){await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){y.default.error("Error while unlocking extension.",e)}const t=this.preferencesController.getLedgerTransportPreference();this.setLedgerTransportPreference(t)}async _loginUser(){try{const e=null;e?await this.submitPassword(e):ae.isManifestV3&&await this.submitEncryptionKey(),await this.accountTracker._updateAccounts()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKey(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:r}=this.keyringController.state;if(JSON.parse(r).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}selectFirstIdentity(){const{identities:e}=this.preferencesController.store.getState(),[t]=Object.keys(e);this.preferencesController.setSelectedAddress(t)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(Y.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async getKeyringForDevice(e,t=null){var r,n,s,o;const i=null===(r=this.opts.overrides)||void 0===r?void 0:r.keyrings;let a=null;if(e!==W.HardwareDeviceNames.QR&&!this.canUseHardwareWallets())throw new Error("Hardware wallets are not supported on this version.");switch(e){case W.HardwareDeviceNames.trezor:a=(null==i||null===(n=i.trezor)||void 0===n?void 0:n.type)||b.TrezorKeyring.type;break;case W.HardwareDeviceNames.ledger:a=(null==i||null===(s=i.ledger)||void 0===s?void 0:s.type)||w.default.type;break;case W.HardwareDeviceNames.qr:a=k.MetaMaskKeyring.type;break;case W.HardwareDeviceNames.lattice:a=(null==i||null===(o=i.lattice)||void 0===o?void 0:o.type)||v.default.type;break;default:throw new Error("MetamaskController:getKeyringForDevice - Unknown device")}let[c]=await this.keyringController.getKeyringsByType(a);if(c||(c=await this.keyringController.addNewKeyring(a)),t&&c.setHdPath&&c.setHdPath(t),e===W.HardwareDeviceNames.lattice&&(c.appName="MetaMask"),e===W.HardwareDeviceNames.trezor){const e=c.getModel();this.appStateController.setTrezorModel(e)}return c.network=this.networkController.state.providerConfig.type,c}async attemptLedgerTransportCreation(){const e=await this.getKeyringForDevice(W.HardwareDeviceNames.ledger);return await e.attemptMakeApp()}async establishLedgerTransportPreference(){const e=this.preferencesController.getLedgerTransportPreference();return await this.setLedgerTransportPreference(e)}async connectHardware(e,t,r){const n=await this.getKeyringForDevice(e,r);let s=[];switch(t){case-1:s=await n.getPreviousPage();break;case 1:s=await n.getNextPage();break;default:s=await n.getFirstPage()}const o=await this.keyringController.getAccounts(),i=[...new Set(o.concat(s.map((e=>e.address.toLowerCase()))))];return this.accountTracker.syncWithAddresses(i),s}async checkHardwareStatus(e,t){return(await this.getKeyringForDevice(e,t)).isUnlocked()}async forgetDevice(e){return(await this.getKeyringForDevice(e)).forgetDevice(),!0}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case Y.KeyringType.trezor:case Y.KeyringType.lattice:case Y.KeyringType.qr:case Y.KeyringType.ledger:return"hardware";case Y.KeyringType.imported:return"imported";case Y.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){const t=await this.keyringController.getKeyringForAccount(e);switch(t.type){case Y.KeyringType.trezor:return t.getModel();case Y.KeyringType.qr:return t.getName();case Y.KeyringType.ledger:return W.HardwareDeviceNames.ledger;case Y.KeyringType.lattice:return W.HardwareDeviceNames.lattice;default:return undefined}}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const s=await this.getKeyringForDevice(t,r);s.setAccountToUnlock(e);const o=await this.keyringController.getAccounts(),i=await this.keyringController.addNewAccountForKeyring(s),a=await this.keyringController.getAccounts();this.preferencesController.setAddresses(a),a.forEach((r=>{if(!o.includes(r)){const o=this.getAccountLabel(t===W.HardwareDeviceNames.qr?s.getName():t,e,n);this.preferencesController.setAccountLabel(r,o),this.preferencesController.setSelectedAddress(r)}}));const{identities:c}=this.preferencesController.store.getState();return{...i,identities:c}}async addNewAccount(e){this.appStateController.store.getState()[le.ACTION_QUEUE_METRICS_E2E_TEST];const t=await this.keyringController.getAccounts(),{addedAccountAddress:r}=await this.keyringController.addNewAccount(e);return t.includes(r)||this.preferencesController.setSelectedAddress(r),r}async verifySeedPhrase(){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.verifySeedPhrase())}async resetAccount(){const e=this.preferencesController.getSelectedAddress();return this.txController.wipeTransactions(e),this.networkController.resetConnection(),e}async getPermittedAccounts(e,{suppressUnauthorizedError:t=!0}={}){try{return await this.permissionController.executeRestrictedMethod(e,J.RestrictedMethods.eth_accounts)}catch(e){if(t&&e.code===g.errorCodes.provider.unauthorized)return[];throw e}}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(J.CaveatTypes.restrictReturnedAccounts,(t=>Fe.CaveatMutatorFactories[J.CaveatTypes.restrictReturnedAccounts].removeAccount(e,t)))}async removeAccount(e){this.removeAllAccountPermissions(e);const t=await this.keyringController.getKeyringForAccount(e);await this.keyringController.removeAccount(e);const r=t?await t.getAccounts():{};var n;0===(null==r?void 0:r.length)&&(null===(n=t.destroy)||void 0===n||n.call(t));return e}async importAccountWithStrategy(e,t){const{importedAccountAddress:r}=await this.keyringController.importAccountWithStrategy(e,t);this.preferencesController.setSelectedAddress(r)}async newUnapprovedTransaction(e,t){const{result:r}=await this.txController.addTransaction(e,{actionId:t.id,method:t.method,origin:t.origin,requireApproval:!0,securityAlertResponse:t.securityAlertResponse});return await r}async addTransactionAndWaitForPublish(e,t){const{transactionMeta:r,result:n}=await this.txController.addTransaction(e,t);return await n,r}async addTransaction(e,t){const{transactionMeta:r,result:n}=await this.txController.addTransaction(e,t);return n.catch((()=>{})),r}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.createCancelTransaction(e,t,r);return this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.createSpeedUpTransaction(e,t,r);return this.getState()}estimateGas(e){return new Promise(((t,r)=>this.txController.txGasUtil.query.estimateGas(e,((e,n)=>e?r(e):t(n.toString(16))))))}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setupUntrustedCommunication({connectionStream:e,sender:t,subjectType:r}){const{usePhishDetect:n}=this.preferencesController.store.getState();let s;if(s=r||(t.id&&t.id!==this.extension.runtime.id?I.SubjectType.Extension:I.SubjectType.Website),t.url){const{hostname:r}=new URL(t.url);this.phishingController.maybeUpdateState();const s=this.phishingController.test(r);if(n&&null!=s&&s.result)return this.sendPhishingWarning(e,r),void this.metaMetricsController.trackEvent({event:ee.MetaMetricsEventName.PhishingPageDisplayed,category:ee.MetaMetricsEventCategory.Phishing,properties:{url:r}})}const o=(0,Ce.setupMultiplex)(e);this.setupProviderConnection(o.createStream("metamask-provider"),t,s),t.url&&this.setupPublicConfig(o.createStream("publicConfig"))}setupTrustedCommunication(e,t){const r=(0,Ce.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnection(r.createStream("provider"),t,I.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.store.getState();if(!t)return;const r=(0,Ce.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,Le.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},r))}sendPhishingWarning(e,t){(0,Ce.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,Le.default)(t,e,this.store,this.localStoreApiWrapper));const r=t=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"sendUpdate",params:[t]})};this.on("update",r);const n=()=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?n():this.once("startUISync",n),e.on("end",(()=>{this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),this.removeListener("update",r)}))}setupProviderConnection(e,t,r){let n,o;n=r===I.SubjectType.Internal?X.ORIGIN_METAMASK:r===I.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:I.SubjectType.Extension}),t.tab&&t.tab.id&&(o=t.tab.id);const i=this.setupProviderEngine({origin:n,sender:t,subjectType:r,tabId:o}),a=(0,c.createEngineStream)({engine:i}),l=this.addConnection(n,{engine:i});(0,s.default)(e,a,e,(e=>{i._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),l&&this.removeConnection(n,l),e&&y.default.error(e)}))}setupSnapProvider(e,t){this.setupUntrustedCommunication({connectionStream:t,sender:{snapId:e},subjectType:I.SubjectType.Snap})}setupProviderEngine({origin:e,subjectType:t,sender:r,tabId:n}){const s=new a.JsonRpcEngine,{blockTracker:o,provider:i}=this;s.push((0,we.default)({origin:e})),s.push((0,x.createSelectedNetworkMiddleware)(this.controllerMessenger));const c=(0,p.default)({provider:i,blockTracker:o}),u=(0,f.default)({provider:i,blockTracker:o});return u.events.on("notification",(e=>s.emit("notification",e))),ae.isManifestV3&&s.push((0,me.default)()),n&&s.push((0,ve.default)({tabId:n})),s.push((0,ye.default)({origin:e})),s.push(this.permissionLogController.createMiddleware()),s.push((0,de.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController)),s.push((0,qe.default)({trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getMetricsState:this.metaMetricsController.store.getState.bind(this.metaMetricsController.store),securityProviderRequest:this.securityProviderRequest.bind(this),...this.snapAndHardwareMetricsParams})),t===I.SubjectType.Website&&s.push((0,ke.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),s.push((0,be.createMethodMiddleware)({origin:e,subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),startApprovalFlow:this.approvalController.startFlow.bind(this.approvalController),endApprovalFlow:this.approvalController.endFlow.bind(this.approvalController),setApprovalFlowLoadingText:this.approvalController.setFlowLoadingText.bind(this.approvalController),showApprovalSuccess:this.approvalController.success.bind(this.approvalController),showApprovalError:this.approvalController.error.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),requestAccountsPermission:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e},{eth_accounts:{}}),requestPermissionsForOrigin:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e}),getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getCurrentRpcUrl:()=>this.networkController.state.providerConfig.rpcUrl,getNetworkConfigurations:()=>this.networkController.state.networkConfigurations,upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),setActiveNetwork:this.networkController.setActiveNetwork.bind(this.networkController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController),findNetworkConfigurationBy:this.findNetworkConfigurationBy.bind(this),setNetworkClientIdForDomain:this.selectedNetworkController.setNetworkClientIdForDomain.bind(this.selectedNetworkController),setProviderType:this.networkController.setProviderType.bind(this.networkController),getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController)})),s.push((0,be.createSnapMethodMiddleware)(t===I.SubjectType.Snap,{getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getAccounts:this.getPermittedAccounts.bind(this,e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:handleRequest"),getAllowedKeyringMethods:(0,ue.keyringSnapPermissionsBuilder)(this.subjectMetadataController)})),s.push(c),s.push(u.middleware),t!==I.SubjectType.Internal&&s.push(this.permissionController.createPermissionMiddleware({origin:e})),s.push(this.metamaskMiddleware),s.push((0,l.providerAsMiddleware)(i)),s}setupPublicConfig(e){const t=(0,i.storeAsStream)(this.publicConfigStore);(0,s.default)(t,e,(e=>{t.destroy(),e&&y.default.error(e)}))}addConnection(e,{engine:t}){if(e===X.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const r=(0,_.default)();return this.connections[e][r]={engine:t},r}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t){const r=this.connections[e];r&&Object.values(r).forEach((e=>{e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e){const t="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async r=>{r.engine&&r.engine.emit("notification",await t(e))}))}))}async _onKeyringControllerUpdate(e){const{keyrings:t,encryptionKey:r,encryptionSalt:n}=e,s=t.reduce(((e,{accounts:t})=>e.concat(t)),[]);ae.isManifestV3&&await this.extension.storage.session.set({loginToken:r,loginSalt:n}),s.length&&(this.preferencesController.syncAddresses(s),this.accountTracker.syncWithAddresses(s))}_onUnlock(){this.notifyAllConnections((async e=>({method:Fe.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!0,accounts:await this.getPermittedAccounts(e)}}))),this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.notifyAllConnections({method:Fe.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!1}}),this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this.notifyAllConnections({method:Fe.NOTIFICATION_NAMES.chainChanged,params:this.getProviderNetworkState(e)})}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async getPendingNonce(e){const{nonceDetails:t,releaseLock:r}=await this.txController.nonceTracker.getNonceLock(e),n=t.params.highestSuggested;return r(),n}async getNextNonce(e){const t=await this.txController.nonceTracker.getNonceLock(e);return t.releaseLock(),t.nextNonce}throwTestError(e){setTimeout((()=>{const t=new Error(e);throw t.name="TestError",t}))}findNetworkConfigurationBy(e){const{networkConfigurations:t}=this.networkController.state;return Object.values(t).find((t=>Object.keys(e).some((r=>t[r]===e[r]))))||null}async setLedgerTransportPreference(e){if(!this.canUseHardwareWallets())return undefined;const t=this.preferencesController.getLedgerTransportPreference(),r=this.preferencesController.setLedgerTransportPreference(e),n=await this.getKeyringForDevice(W.HardwareDeviceNames.ledger);return null!=n&&n.updateTransportMethod?n.updateTransportMethod(r).catch((e=>{throw this.preferencesController.setLedgerTransportPreference(t),e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e,this.detectTokensController.isOpen=e}onClientClosed(){try{this.gasFeeController.stopPolling(),this.appStateController.clearPollingTokens()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=X.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.store.getState()[t].forEach((e=>{this.gasFeeController.disconnectPoller(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){const e=this.platform.getExtensionURL();await this.platform.switchToAnotherURL(undefined,e)}setLocked(){const[e]=this.keyringController.getKeyringsByType(Y.KeyringType.trezor);return e&&e.dispose(),ae.isManifestV3&&this.clearLoginArtifacts(),this.keyringController.setLocked()}async securityProviderRequest(e,t){const{currentLocale:r,transactionSecurityCheckEnabled:n}=this.preferencesController.store.getState();if(n){const n=Number((0,ce.hexToDecimal)(this.networkController.state.providerConfig.chainId));try{return await(0,Ke.securityProviderCheck)(e,t,n,r)}catch(e){throw y.default.error(e.message),e}}return null}async _onAccountChange(e){const t=(0,Fe.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[r,n]of t.entries())n.includes(e)&&this._notifyAccountsChange(r,n);await this.txController.updateIncomingTransactions()}async _notifyAccountsChange(e,t){this.isUnlocked()&&this.notifyConnections(e,{method:Fe.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:await this.getPermittedAccounts(e)}),this.permissionLogController.updateAccountsHistory(e,t)}}r.default=Je}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[92,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[93,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[94,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[95,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:5,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}],[96,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:6,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r={...e,PreferencesController:{selectedAddress:t.selectedAccount}};return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/006.js"}],[97,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:7,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t={...e,TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}};return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/007.js"}],[98,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:8,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=8;try{const e=function(e){const t={...e,NoticeController:{noticesList:e.noticesList||[]}};return delete t.noticesList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #8${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/008.js"}],[99,{lodash:3975},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:9,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=9;try{const e=function(e){const t=(0,n.merge)({},e,{CurrencyController:{currentCurrency:e.currentFiat||e.fiatCurrency||"USD",conversionRate:e.conversionRate,conversionDate:e.conversionDate}});return delete t.currentFiat,delete t.fiatCurrency,delete t.conversionRate,delete t.conversionDate,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #9${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/009.js"}],[4,{"../../shared/constants/app":4665,"../../shared/constants/metametrics":4673,"../../shared/modules/browser-runtime.utils":4697,"../../shared/modules/mv3.utils":4706,"../../shared/modules/object.utils":4708,"./first-time-state":37,"./lib/createStreamSink":49,"./lib/ens-ipfs/setup":54,"./lib/get-first-preferred-lang-code":56,"./lib/getObjStructure":57,"./lib/local-store":59,"./lib/migrator":62,"./lib/network-store":63,"./lib/notification-manager":64,"./lib/setup-initial-state-hooks":83,"./lib/setupSentry":84,"./lib/util":90,"./metamask-controller":91,"./migrations":199,"./platforms/extension":200,"@metamask/controller-utils":1144,"@metamask/obs-store":1632,"@metamask/utils":1974,"debounce-stream":3035,"end-of-stream":3075,"eth-rpc-errors":3132,events:3237,"extension-port-stream":3240,loglevel:3987,pump:4181,"webextension-polyfill":4649},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.loadStateFromPersistence=ce,r.setupController=le,r.statePersistenceEvents=void 0,e("./lib/setup-initial-state-hooks");var n=j(e("events")),s=j(e("end-of-stream")),o=j(e("pump")),i=j(e("debounce-stream")),a=j(e("loglevel")),c=j(e("webextension-polyfill")),l=e("@metamask/obs-store"),u=e("@metamask/utils"),d=e("@metamask/controller-utils"),h=j(e("extension-port-stream")),p=e("eth-rpc-errors"),f=e("../../shared/constants/app"),g=e("../../shared/constants/metametrics"),m=e("../../shared/modules/browser-runtime.utils"),y=e("../../shared/modules/mv3.utils"),b=e("../../shared/modules/object.utils"),w=j(e("./migrations")),v=j(e("./lib/migrator")),k=j(e("./platforms/extension")),C=j(e("./lib/local-store")),_=(j(e("./lib/network-store")),e("./lib/setupSentry")),S=j(e("./lib/createStreamSink")),A=I(e("./lib/notification-manager")),T=I(e("./metamask-controller")),E=j(e("./first-time-state")),M=j(e("./lib/get-first-preferred-lang-code")),P=j(e("./lib/getObjStructure")),N=j(e("./lib/ens-ipfs/setup")),O=e("./lib/util");function R(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(R=function(e){return e?r:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=R(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function j(e){return e&&e.__esModule?e:{default:e}}const x=new C.default;global.stateHooks.getMostRecentPersistedState=()=>x.mostRecentRetrievedState;const{sentry:L}=global,D={...E.default},U={[f.ENVIRONMENT_TYPE_POPUP]:!0,[f.ENVIRONMENT_TYPE_NOTIFICATION]:!0,[f.ENVIRONMENT_TYPE_FULLSCREEN]:!0},B=["trezor-connect"];a.default.setLevel("info",!1);const $=new k.default,F=new A.default;let q=!1,K=!1,z=!1;const G={},H={};let V,W;const Y=new URL("https://metamask.github.io/phishing-warning/v2.1.0/"),J=1e3,Q="ACK_KEEP_ALIVE_MESSAGE",Z="WORKER_KEEP_ALIVE_MESSAGE",X=r.statePersistenceEvents=new n.default,{promise:ee,resolve:te,reject:re}=(0,O.deferredPromise)(),ne=async()=>{const e=await c.default.tabs.query({url:"<all_urls>",windowType:"normal"}).then((e=>((0,m.checkForLastErrorAndLog)(),e))).catch((()=>{(0,m.checkForLastErrorAndLog)()}));for(const t of e)c.default.tabs.sendMessage(t.id,{name:f.EXTENSION_MESSAGES.READY}).then((()=>{(0,m.checkForLastErrorAndLog)()})).catch((()=>{(0,m.checkForLastErrorAndLog)()}))};let se,oe;async function ie(){try{const e=await ce(),t=e.data,r=await(0,M.default)();let n;if(y.isManifestV3){const e=await c.default.storage.session.get(["isFirstMetaMaskControllerSetup"]);n=(null==e?void 0:e.isFirstMetaMaskControllerSetup)===undefined,await c.default.storage.session.set({isFirstMetaMaskControllerSetup:n})}le(t,r,{},n,e.meta),y.isManifestV3||await async function(){let e;try{const t=new URL("https://metamask.github.io/phishing-warning/v2.1.0/");let r,n;t.hash="#extensionStartup",e=window.document.createElement("iframe"),e.setAttribute("src",t.href),e.setAttribute("sandbox","allow-scripts allow-same-origin");const s=new Promise(((e,t)=>{r=e,n=t}));e.addEventListener("load",r),window.document.body.appendChild(e),setTimeout((()=>n(new ae)),J),await s}catch(e){e instanceof ae?console.warn("Phishing warning page timeout; page not guaranteed to work offline."):console.error("Failed to initialize phishing warning page",e)}finally{e&&e.remove()}}(),await ne(),a.default.info("MetaMask initialization complete."),te()}catch(e){re(e)}}c.default.runtime.onConnect.addListener((async(...e)=>{await ee,se(...e)})),c.default.runtime.onConnectExternal.addListener((async(...e)=>{await ee,oe(...e)}));class ae extends Error{constructor(){super("Timeout failed")}}async function ce(){const e=new v.default({migrations:w.default});if(e.on("error",console.warn),W=await x.get()||e.generateInitialState(D),W&&!W.data&&(W=e.generateInitialState(D),L.captureMessage("MetaMask - Empty vault found - unable to recover")),e.on("error",(e=>{const t=(0,P.default)(W);L.captureException(e,{extra:{vaultStructure:t}})})),W=await e.migrateData(W),!W)throw new Error("MetaMask - migrator returned undefined");if(!(0,u.isObject)(W.meta))throw new Error(`MetaMask - migrator metadata has invalid type '${typeof W.meta}'`);if("number"!=typeof W.meta.version)throw new Error(`MetaMask - migrator metadata version has invalid type '${typeof W.meta.version}'`);if(!(0,u.isObject)(W.data))throw new Error(`MetaMask - migrator data has invalid type '${typeof W.data}'`);return x.setMetadata(W.meta),x.set(W.data),W}function le(e,t,r,n,u){var m;V=new T.default({infuraProjectId:"b6bf7d3508c941499b10025c0776eaf8",showUserConfirmation:ue,initState:e,initLangCode:t,platform:$,notificationManager:F,browser:c.default,getRequestAccountTabIds:()=>H,getOpenMetamaskTabsIds:()=>G,localStore:x,overrides:r,isFirstMetaMaskControllerSetup:n,currentMigrationVersion:u.version}),(0,N.default)({getCurrentChainId:()=>V.networkController.state.providerConfig.chainId,getIpfsGateway:V.preferencesController.getIpfsGateway.bind(V.preferencesController),getUseAddressBarEnsResolution:()=>V.preferencesController.store.getState().useAddressBarEnsResolution,provider:V.provider}),(0,o.default)((0,l.storeAsStream)(V.store),(0,i.default)(1e3),(0,S.default)((async e=>{await x.set(e),X.emit("state-persisted",e)})),(e=>{a.default.error("MetaMask - Persistence pipeline failed",e)})),m=V,global.stateHooks.getSentryAppState=function(){const e=m.memStore.getState();return(0,b.maskObject)(e,_.SENTRY_BACKGROUND_STATE)};const w=()=>q||Boolean(Object.keys(G).length)||K,v=(e,t)=>{if(!1===e)V.onClientClosed();else{if(t===f.ENVIRONMENT_TYPE_FULLSCREEN&&Boolean(Object.keys(G).length))return;V.onEnvironmentTypeClosed(t)}};function k(){let e="";const t=C();t&&(e=String(t)),y.isManifestV3?(c.default.action.setBadgeText({text:e}),c.default.action.setBadgeBackgroundColor({color:"#037DD6"})):(c.default.browserAction.setBadgeText({text:e}),c.default.browserAction.setBadgeBackgroundColor({color:"#037DD6"}))}function C(){return V.approvalController.getTotalApprovalCount()+V.appStateController.waitingForUnlock.length}se=async e=>{var t;const n=e.name;if(B.includes(e.name))return;let o=!1;const i=(0,O.getPlatform)(),a=null!==(t=e.sender)&&void 0!==t&&t.url?new URL(e.sender.url):null;if(o=i===f.PLATFORM_FIREFOX?U[n]:(null==a?void 0:a.origin)===`chrome-extension://${c.default.runtime.id}`,o){var l;const t=(null==r||null===(l=r.getPortStream)||void 0===l?void 0:l.call(r,e))||new h.default(e);if(V.isClientOpen=!0,V.setupTrustedCommunication(t,e.sender),y.isManifestV3&&e.onMessage.addListener((t=>{t.name===Z&&(e.postMessage({name:Q}),V.appStateController.setServiceWorkerLastActiveTime(Date.now()))})),n===f.ENVIRONMENT_TYPE_POPUP&&(q=!0,(0,s.default)(t,(()=>{q=!1;const e=w();V.isClientOpen=e,v(e,f.ENVIRONMENT_TYPE_POPUP)}))),n===f.ENVIRONMENT_TYPE_NOTIFICATION&&(K=!0,(0,s.default)(t,(()=>{K=!1;const e=w();V.isClientOpen=e,v(e,f.ENVIRONMENT_TYPE_NOTIFICATION)}))),n===f.ENVIRONMENT_TYPE_FULLSCREEN){const r=e.sender.tab.id;G[r]=!0,(0,s.default)(t,(()=>{delete G[r];const e=w();V.isClientOpen=e,v(e,f.ENVIRONMENT_TYPE_FULLSCREEN)}))}}else if(a&&a.origin===Y.origin&&a.pathname===Y.pathname){var u;const t=(null==r||null===(u=r.getPortStream)||void 0===u?void 0:u.call(r,e))||new h.default(e);V.setupPhishingCommunication({connectionStream:t})}else{if(e.sender&&e.sender.tab&&e.sender.url){const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;e.onMessage.addListener((e=>{e.data&&"eth_requestAccounts"===e.data.method&&(H[n]=t)}))}oe(e)}},oe=e=>{var t;const n=(null==r||null===(t=r.getPortStream)||void 0===t?void 0:t.call(r,e))||new h.default(e);V.setupUntrustedCommunication({connectionStream:n,sender:e.sender})},null!=r&&r.registerConnectListeners&&r.registerConnectListeners(se,oe),k(),V.txController.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,k),V.decryptMessageController.hub.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,k),V.encryptionPublicKeyController.hub.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,k),V.signatureController.hub.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,k),V.appStateController.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,k),V.controllerMessenger.subscribe(T.METAMASK_CONTROLLER_EVENTS.APPROVAL_STATE_CHANGE,k),V.txController.initApprovals(),F.on(A.NOTIFICATION_MANAGER_EVENTS.POPUP_CLOSED,(({automaticallyClosed:e})=>{e?C()>0&&ue():(Object.keys(V.txController.txStateManager.getUnapprovedTxList()).forEach((e=>V.txController.txStateManager.setTxStatusRejected(e))),V.signatureController.rejectUnapproved(g.REJECT_NOTIFICATION_CLOSE_SIG),V.decryptMessageController.rejectUnapproved(g.REJECT_NOTIFICATION_CLOSE),V.encryptionPublicKeyController.rejectUnapproved(g.REJECT_NOTIFICATION_CLOSE),Object.values(V.approvalController.state.pendingApprovals).forEach((({id:e,type:t})=>{switch(t){case d.ApprovalType.SnapDialogAlert:case d.ApprovalType.SnapDialogPrompt:V.approvalController.accept(e,null);break;case d.ApprovalType.SnapDialogConfirmation:case f.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation:case f.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval:case f.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect:V.approvalController.accept(e,!1);break;default:V.approvalController.reject(e,p.ethErrors.provider.userRejectedRequest())}})),k())})),Object.keys(V.snapController.state.snaps).length>0&&V.snapController.updateBlockedSnaps()}async function ue(){const e=await $.getActiveTabs(),t=Boolean(e.find((e=>G[e.id]))),r=e.length>0&&e[0].extData&&e[0].extData.indexOf("vivaldi_tab")>-1;if(!z&&(r||!q)&&!t){z=!0;try{const e=V.appStateController.getCurrentPopupId();await F.showPopup((e=>V.appStateController.setCurrentPopupId(e)),e)}finally{z=!1}}}const de=()=>{if(V)return V.metaMetricsController.updateTraits({[g.MetaMetricsUserTrait.InstallDateExt]:(new Date).toISOString().split("T")[0]}),void V.metaMetricsController.addEventBeforeMetricsOptIn({category:g.MetaMetricsEventCategory.App,event:g.MetaMetricsEventName.AppInstalled,properties:{}});setTimeout((()=>{de()}),1e3)};(async function(){await async function(){Boolean(await x.get())||(de(),$.openExtensionInBrowser())}(),ie().catch(a.default.error)})()}}},{package:"$root$",file:"app/scripts/background.js"}]],[4],{});